<!-- build time:Sat Sep 24 2022 00:08:10 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><script data-ad-client="ca-pub-7534416172769714" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css"><link rel="stylesheet" href="/css/main.css?v=7.1.2"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.2"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2"><link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.2",sidebar:{position:"left",display:"post",offset:12,onmobile:!1,dimmer:!0},back2top:!0,back2top_sidebar:!0,fancybox:!0,fastclick:!0,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="description" content="JUnitMaven 依赖12345&amp;lt;dependency&amp;gt;    &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;    &amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;    &amp;lt;version&amp;gt;4.12&amp;lt;/version&amp;gt;&amp;lt;/dependency&amp;gt;测试代码的要求测试方法必须使用 @Tes"><meta name="keywords" content="JAVA"><meta property="og:type" content="article"><meta property="og:title" content="JAVA 进阶"><meta property="og:url" content="https://zero3737.gitee.io/posts/49154/index.html"><meta property="og:site_name" content="im乐"><meta property="og:description" content="JUnitMaven 依赖12345&amp;lt;dependency&amp;gt;    &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;    &amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;    &amp;lt;version&amp;gt;4.12&amp;lt;/version&amp;gt;&amp;lt;/dependency&amp;gt;测试代码的要求测试方法必须使用 @Tes"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/180.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/181.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/182.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/183.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/185.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/184.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/45.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/44.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/46.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/47.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/80.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/82.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/81.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/83.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/84.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/25.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/26.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/27.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/39.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/40.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/30.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/31.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/41.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/42.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/43.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/86.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/38.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/37.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/33.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/35.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/48.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/49.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/50.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/52.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/51.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/53.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/54.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/55.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/56.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/57.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/58.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/61.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/59.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/60.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/62.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/63.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/64.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/69.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/71.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/72.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/73.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/74.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/68.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/65.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/66.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/97.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/98.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/79.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/88.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/89.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/206.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/207.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/1.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/20.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/188.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/200.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/201.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/24.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/178.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/177.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/189.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/190.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/191.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/5.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/4.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/6.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/8.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/9.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/10.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/17.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/12.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/11.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/13.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/14.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/15.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/16.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/18.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/19.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/101.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/100.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/103.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/102.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/104.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/105.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/106.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/142.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/143.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/131.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/132.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/130.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/108.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/110.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/109.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/129.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/107.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/111.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/112.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/113.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/114.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/117.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/118.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/119.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/120.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/121.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/115.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/116.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/170.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/171.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/128.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/122.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/123.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/124.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/126.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/125.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/127.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/134.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/133.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/138.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/140.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/141.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/144.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/145.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/146.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/160.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/158.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/159.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/165.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/166.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/167.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/168.jpg"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/168.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/1.webp"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/175.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/203.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/202.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/204.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/205.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/199.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/197.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/196.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/198.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/195.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/151.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/147.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/148.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/149.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/150.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/152.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/153.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/154.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/155.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/156.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/157.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/99.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/172.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/173.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/186.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/187.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/176.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/192.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/194.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/49154/193.png"><meta property="og:updated_time" content="2020-04-07T09:37:30.251Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JAVA 进阶"><meta name="twitter:description" content="JUnitMaven 依赖12345&amp;lt;dependency&amp;gt;    &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;    &amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;    &amp;lt;version&amp;gt;4.12&amp;lt;/version&amp;gt;&amp;lt;/dependency&amp;gt;测试代码的要求测试方法必须使用 @Tes"><meta name="twitter:image" content="https://zero3737.gitee.io/posts/49154/180.png"><link rel="alternate" href="/atom.xml" title="im乐" type="application/atom+xml"><link rel="canonical" href="https://zero3737.gitee.io/posts/49154/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>JAVA 进阶 | im乐</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?4082c5f4a737e261906898d7d41f122b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">im乐</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Efforts may not lead to success, but please don't be discouraged</p></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div><link rel="stylesheet" href="/live2d/css/live2d.css"></header><a href="https://github.com/zero3737" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><div class="reading-progress-bar"></div><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://zero3737.gitee.io/posts/49154/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="im乐"><meta itemprop="description" content="一个专注分享互联网知识的网站，希望你会喜欢它。"><meta itemprop="image" content="/static/user_images/头像/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="im乐"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">JAVA 进阶</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-06-01 23:32:17" itemprop="dateCreated datePublished" datetime="2019-06-01T23:32:17+08:00">2019-06-01</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-04-07 17:37:30" itemprop="dateModified" datetime="2020-04-07T17:37:30+08:00">2020-04-07</time> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><span class="post-meta-item-text">评论数：</span> <a href="/posts/49154/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/posts/49154/" itemprop="commentCount"></span> </a></span><span id="/posts/49154/" class="leancloud_visitors" data-flag-title="JAVA 进阶"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span title="本文字数">76k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">1:09</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="JUnit"><a href="#JUnit" class="headerlink" title="JUnit"></a>JUnit</h1><h2 id="Maven-依赖"><a href="#Maven-依赖" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="测试代码的要求"><a href="#测试代码的要求" class="headerlink" title="测试代码的要求"></a>测试代码的要求</h2><ol><li>测试方法必须使用 @Test 进行修饰。</li><li>测试方法必须使用 public void 进行修饰，<strong>不能带任何的参数（方法不能有形参）</strong>。</li><li>测试单元的每个方法必须可以独立测试，测试方法之间不能有任何的依赖。</li></ol><a id="more"></a><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><ol><li><p>被测试类 -&gt; 新建 -&gt; 其他</p><img src="180.png" width="40%"></li><li><p>选择 JUnit 测试用例。</p><img src="181.png" width="40%"></li><li><p>选择 JUnit4 -&gt; 下一步</p><img src="182.png" width="40%"></li><li><p>选择测试方法。</p><img src="183.png" width="40%"></li><li><p>在 test 目录自动生成测试类。</p><img src="185.png" width="30%"></li><li><p>测试类直接实例化一个被测试类，然后调用被测试类的方法即可，方法名右键运行方式 -&gt; JUnit 测试。</p><img src="184.png" width="80%"></li></ol><h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h1><h2 id="入门案例"><a href="#入门案例" class="headerlink" title="入门案例"></a>入门案例</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ol><li>MyBatis 现在由 Google 维护。</li><li>ORM：数据库表和对象的关系一一映射（数据库中的字段和对象属性一一对应）。</li><li>持久化：将数据保存在数据库中。</li></ol><h3 id="Maven-依赖-1"><a href="#Maven-依赖-1" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="MyBatis-配置文件"><a href="#MyBatis-配置文件" class="headerlink" title="MyBatis 配置文件"></a>MyBatis 配置文件</h3><p>mybatis-config.xml 配置文件：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">	PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">	"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"driver"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"url"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"username"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"password"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"org/mybatis/example/BlogMapper.xml"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>environments 标签中可以存在多个 environment 标签，default 属性指定对应 environment 标签的 id，表示使用对应 environment 标签配置环境。</li><li>transactionManager 标签表示事务管理器，type 属性指定事务类型。</li><li>dataSource 标签为配置数据源。</li><li>mapper 标签为加载 mapper.xml 配置文件。</li></ul><h3 id="mapper"><a href="#mapper" class="headerlink" title="mapper"></a>mapper</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"org.mybatis.example.BlogMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectBlog"</span> <span class="attr">resultType</span>=<span class="string">"类限定名"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">		select * from Blog where id = #&#123;id&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>namespace 的值为 mapper.xml 的类路径。</li><li>resultType 返回类型。</li><li>parameterType 动态输入类型。</li><li>resultType 和 parameterType 的值只能有一个。</li><li><code>#{id}</code> 为占位符，表示动态传 id 值。</li></ul><h3 id="基础-API"><a href="#基础-API" class="headerlink" title="基础 API"></a>基础 API</h3><ol><li><p>返回 SqlSession 对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> SqlSessionFactoryBuilder().build(Resources.getResourceAsReader(<span class="string">"mybatis-config.xml"</span>)).openSession(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure><ul><li>SqlSession 相当于 Connection 对象。</li><li><code>openSession(true)</code> 开启事务自动提交，默认不开启事务自动提交。</li><li>不开启事务自动提交，涉及增删改需要手动提交事务（手动执行 commit 方法）。</li></ul></li><li><p>根据返回 SqlSession 对象进行数据库操作。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlSession.selectOne(<span class="string">"mapper[namespace].select[id]"</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><ul><li><code>mapper[namespace]</code> 根据命名空间找到对应 mapper.xml 文件，<code>select[id]</code> 根据 id 获取对应 SQL 语句。</li><li>1 为传入参数。</li></ul></li></ol><h2 id="引用-properties"><a href="#引用-properties" class="headerlink" title="引用 properties"></a>引用 properties</h2><h3 id="properties-文件"><a href="#properties-文件" class="headerlink" title="properties 文件"></a>properties 文件</h3><p>db.properties 配置文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver=driver</span><br><span class="line">url=url</span><br><span class="line">username=username</span><br><span class="line">password=password</span><br></pre></td></tr></table></figure><h3 id="MyBatis-配置文件-1"><a href="#MyBatis-配置文件-1" class="headerlink" title="MyBatis 配置文件"></a>MyBatis 配置文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">	PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">	"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载 db.properties 配置文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 设置事务类型为 JDBC --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 配置数据源 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;driver&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;url&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;username&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;password&#125;"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载 mapper 文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"org/mybatis/example/BlogMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="数据源"><a href="#数据源" class="headerlink" title="数据源"></a>数据源</h3><p>dataSource 标签为配置数据源。</p><ul><li>POOLED 使用数据库连接池。</li><li>UNPOOLED 不使用数据库连接池。</li></ul><p>数据库 URL：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql://localhost:3306/db?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;serverTimezone=UTC</span><br></pre></td></tr></table></figure><ul><li>db 为连接的数据库名。</li><li>如果连接本地数据库，并且数据库端口为 3306，可以简写成 <code>jdbc:mysql:///db</code> 的形式。</li><li>XML 不识别 &amp; 符号，必须转义 <code>&amp;amp;</code>。</li></ul><h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>Transaction 接口定义了获取 Connetction 连接、提交、回滚和关闭的功能。</p><p>JdbcTransaction 和 ManagedTransaction 为 Transaction 接口不同的实现。</p><p>MyBatis的事务管理分为两种形式：</p><ol><li>使用 JDBC 的事务管理机制：即利用 java.sql.Connection 对象完成对事务的提交（commit()）、回滚（rollback()）、关闭（close()）等。</li><li>使用 MANAGED 的事务管理机制：这种机制 MyBatis 自身不会去实现事务管理，而是让程序的 EJB 容器（JBOSS，Weblogic）来实现对事务的管理。</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br></pre></td></tr></table></figure><ul><li>transactionManager 的 type 属性决定用什么类型的事务管理机制。<ol><li>Transaction 的事务管理都是通过 java.sql.Connection 实现的。</li><li>JDBC: 创建一个 JdbcTransactionFactory 工厂，涉及增删改操作需要手动提交事务（手动调用 SqlSession 对象的 commit 方法）。<ul><li>JdbcTransaction 依赖与从 dataSource 中取得的连接 connection 来管理 transaction 的作用域。</li><li>JdbcTransaction 是使用的 java.sql.Connection 上的 commit 和 rollback 功能。</li><li>JdbcTransaction 只是相当于对 java.sql.Connection 事务处理进行了一次包装（wrapper）。</li></ul></li><li>MANAGED: 创建一个 MangedTransactionFactory 工厂。<ul><li>ManagedTransaction 让 EJB 容器来管理事务 Transaction 的整个生命周期。</li><li>使用 ManagedTransaction 的 commit 和 rollback 功能不会对事务有任何的影响（ManagedTransaction 的 commit 和 rollback 方法为空方法，没有任何逻辑操作）。</li><li>让容器管理事务前提是该容器支持事务管理，Tomcat 不支持管理事务。</li></ul></li></ol></li></ul><h2 id="mapper-1"><a href="#mapper-1" class="headerlink" title="mapper"></a>mapper</h2><h3 id="基本标签"><a href="#基本标签" class="headerlink" title="基本标签"></a>基本标签</h3><table><thead><tr><th align="left">标签</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">select</td><td align="left">查询标签</td></tr><tr><td align="left">insert</td><td align="left">插入标签</td></tr><tr><td align="left">delete</td><td align="left">删除标签</td></tr><tr><td align="left">update</td><td align="left">更新标签</td></tr></tbody></table><h3 id="约定"><a href="#约定" class="headerlink" title="约定"></a>约定</h3><p>resultType 中指定的 pojo 类属性名必须和数据库字段名一一对应，mybatis 执行 SQL 语句根据 bean 对象名字和数据库字段自动赋值，名字不一样需要通过 resultMap 指定。</p><h3 id="定义别名"><a href="#定义别名" class="headerlink" title="定义别名"></a>定义别名</h3><ol><li><p>将 <code>org.langiao.entity.Student</code> 定义别名为 <code>student</code>。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"org.langiao.entity.Student"</span> <span class="attr">alias</span>=<span class="string">"student"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>别名忽略大小写。</li></ul></li><li><p>批量定义别名。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"org.lanqiao.entity"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>会将该包下的所有类定义别名（别名就是类名，不用写类限定名）。</li><li>除了自定义别名外，MyBatis 还内置了一些常见的别名。</li></ul></li></ol><h3 id="全局参数配置"><a href="#全局参数配置" class="headerlink" title="全局参数配置"></a>全局参数配置</h3><p>mybatis 配置文件中关闭缓存。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="SqlSeesion-对象"><a href="#SqlSeesion-对象" class="headerlink" title="SqlSeesion 对象"></a>SqlSeesion 对象</h2><p>SqlSession 对象可对数据库操作，执行查询可以返回结果集。</p><ul><li><p>selectOne(“mapper[namespace].select[id]”, 1);</p><ul><li>mapper[namespace] 为 mapper.xml 文件中的 mapper 标签 namespace 的值。</li><li>select[id] 为 mapper.xml 文件中的 select 标签 id 的值。</li><li>示例说明：<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"org.mybatis.example.BlogMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- mapper[namespace].select[id] 的值为 org.mybatis.example.BlogMapper.selectBlog。 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- parameterType 输入类型。 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- resultType 返回类型。 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1 为动态出入的值（select * from Blog where id = 1）。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectBlog"</span> <span class="attr">resultType</span>=<span class="string">"bean 对象类限定名"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        select * from Blog where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>close() 关闭数据库连接。</p></li><li><p>selectList(“mapper[namespace].select[id]”, parameterType);</p><ul><li>以 List 集合形式返回对象。</li><li>parameterType 为 sql 语句中需要传入的参数（占位符或拼接符）。</li></ul></li><li><p>insert(“mapper[namespace].select[id]”, parameterType);</p><ul><li>插入数据，对应 insert 标签。</li></ul></li><li><p>delete(“mapper[namespace].select[id]”, parameterType);</p><ul><li>删除数据，对应 delete 标签。</li></ul></li><li><p>update(“mapper[namespace].select[id]”, parameterType);</p><ul><li>更新数据，对应 update 标签。</li></ul></li><li><p>commit() 事务提交方式为 JDBC，需要手动提交事务。</p><ul><li>增删改操作需要手动提交事务。</li></ul></li></ul><h2 id="基于动态代理方式-CRUD"><a href="#基于动态代理方式-CRUD" class="headerlink" title="基于动态代理方式 CRUD"></a>基于动态代理方式 CRUD</h2><h3 id="约定-1"><a href="#约定-1" class="headerlink" title="约定"></a>约定</h3><ol><li>namespace 的值就是接口的全类名（接口和 mapper.xml 文件映射）。</li><li>方法名和 mapper.xml 文件中标签的 id 值相同。</li><li>方法的形参和 mapper.xml 文件中标签的 parameterType 类型一致。</li><li>方法的返回值和 mapper.xml 文件中标签的 resultType 类型一致（没有 resultType 返回值为 void）。</li><li>习惯把 mapper.xml 和 约定接口放在一起。</li></ol><h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><p>SqlSession 实例对象中的 getMapper(指定接口.class)。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// StudentMapper 为指定接口。</span></span><br><span class="line">StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);</span><br><span class="line"><span class="comment">// queryStudentByStuno 为 StudentMapper 接口中的自定义方法。</span></span><br><span class="line">studentMapper.queryStudentByStuno(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><h2 id="resultMap"><a href="#resultMap" class="headerlink" title="resultMap"></a>resultMap</h2><ol><li>解决 javaBean 对象属性和数据库字段不一致导致不能识别的问题，例如 javaBean 中的 id 属性和数据库中的 Number 字段不对应。</li><li>解决 javaBean 对象和数据库字段类型不一致的问题，例如 javaBean 中的 id 属性为 int，数据库中的 id 字段为 varchar。</li></ol><h3 id="属性名和数据库字段名不一致"><a href="#属性名和数据库字段名不一致" class="headerlink" title="属性名和数据库字段名不一致"></a>属性名和数据库字段名不一致</h3><ol><li><p>数组库字段：</p><img src="45.png" width="80%"></li><li><p>javaBean 对象：</p><img src="44.png" width="50%"></li><li><p>mapper 文件：</p><img src="46.png" width="80%"><ul><li>type 属性为返回类型。</li><li>id <strong>标签</strong>为数据库主键，result 标签为数据库非主键。</li><li>property 属性为 javabean 属性名。</li><li>column 数据库字段。</li></ul></li><li><p>接口对应方法：</p><img src="47.png" width="50%"></li></ol><h3 id="自定义类型转换器"><a href="#自定义类型转换器" class="headerlink" title="自定义类型转换器"></a>自定义类型转换器</h3><ol><li><p>继承 BaseTypeHandler 类，重写 set 和 get 相关方法， set 方法是从 javaType 到 jdbcType，get 方法是从 jdbcType 到 javaType。</p></li><li><p>将 java 的 true 值转换为数据库的 1，将 false 转换为 0。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNonNullParameter</span><span class="params">(PreparedStatement ps, <span class="keyword">int</span> i, Boolean parameter, JdbcType jdbcType)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (parameter) &#123;</span><br><span class="line">        </span><br><span class="line">        ps.setInt(i, <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        </span><br><span class="line">        ps.setInt(i, <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>PreparedStatement 为原生 JDBC 增删改操作对象。</li><li>i 为 PreparedStatement 对象操作参数的位置。</li><li>parameter 为插入数据库的值。</li></ul></li><li><p>将数据库的 1 转换为 java 类型的 true，0 为 false。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Boolean <span class="title">getNullableResult</span><span class="params">(ResultSet rs, String columnName)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> rs.getInt(columnName) == <span class="number">1</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Boolean <span class="title">getNullableResult</span><span class="params">(ResultSet rs, <span class="keyword">int</span> columnIndex)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rs.getInt(columnIndex) == <span class="number">1</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Boolean <span class="title">getNullableResult</span><span class="params">(CallableStatement cs, <span class="keyword">int</span> columnIndex)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> cs.getInt(columnIndex) == <span class="number">1</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>columnName 根据列名获取。</li><li>columnIndex 根据下标获取。</li><li>CallableStatement 对象为查询储存过程相关对象。</li></ul></li><li><p>在 Mybatis 配置文件中注册类型转换器。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeHandlers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeHandler</span> <span class="attr">handler</span>=<span class="string">"top.zero3737.Servlet.TypeHandler"</span> <span class="attr">javaType</span>=<span class="string">"Boolean"</span> <span class="attr">jdbcType</span>=<span class="string">"Integer"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeHandlers</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>mapper.xml 配置如下:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"_id"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"_resultMap"</span>&gt;</span></span><br><span class="line">    select * from Blog where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"类限定名"</span> <span class="attr">id</span>=<span class="string">"_resultMap"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"stuSex"</span> <span class="attr">column</span>=<span class="string">"stusex"</span> <span class="attr">javaType</span>=<span class="string">"boolean"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>声明 javaType 和 jdbcType 类型自动寻找对应转换器。</li><li>INTEGER 类型必需大写。</li></ul></li><li><p>对数据库进行插入操作。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"_id-1"</span> <span class="attr">parameterType</span>=<span class="string">"类限定名"</span>&gt;</span></span><br><span class="line">    insert into student(id, sex) values(#&#123;id&#125;, #&#123;sex, javaType=boolean, jdbcType=INTEGER&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>声明 javaType 和 jdbcType 自动寻找对应转换器。</li></ul></li></ol><h2 id="拼接符和占位符"><a href="#拼接符和占位符" class="headerlink" title="拼接符和占位符"></a>拼接符和占位符</h2><h3 id="占位符"><a href="#占位符" class="headerlink" title="#{} 占位符"></a>#{} 占位符</h3><ol><li>如果传进来的是基本类型，那么 #{} 里面的变量名任意，因为 MyBatis 会把实际参数直接传入这个位置，不管参数名称和类型。</li><li>如果传进来的是对象类型，MyBatis 会把对象中的属性名和属性值以键值对形式保存到一个类似 Map 的结构中，当我们用 #{属性名} 来取值时，其实就相当于根据键查找值。</li><li>如果有多个参数，使用 @Param 注解来指定参数名称。</li><li>#{} 占位符自动给 String 类型自动加上引号（自动类型转换）。</li></ol><h3 id="拼接符"><a href="#拼接符" class="headerlink" title="${} 拼接符"></a>${} 拼接符</h3><ol><li>如果传进来的是基本类型，那么 #{} 里面的变量名必须写 value。</li><li>如果传进来的是对象类型，通过 #{属性名} 方式获取值，和 ${} 占位符一样。</li><li>当有多个参数时，可以使用 ${param1}、${param2} 方式或者 @Param 注解方式来获取参数。</li><li>${} 拼接符会原样输出，不会给 String 类型自动加上引号。</li></ol><h2 id="输入和输出参数"><a href="#输入和输出参数" class="headerlink" title="输入和输出参数"></a>输入和输出参数</h2><h3 id="输入多个参数"><a href="#输入多个参数" class="headerlink" title="输入多个参数"></a>输入多个参数</h3><img src="80.png" width="80%"><h4 id="不指定别名"><a href="#不指定别名" class="headerlink" title="不指定别名"></a>不指定别名</h4><p>接口方法：</p><img src="82.png" width="80%"><p>mapper 文件：</p><img src="81.png" width="50%"><h4 id="Param-指定别名"><a href="#Param-指定别名" class="headerlink" title="@Param 指定别名"></a>@Param 指定别名</h4><p>接口方法：</p><img src="83.png" width="80%"><p>mapper 文件：</p><img src="84.png" width="50%"><h4 id="嵌套对象"><a href="#嵌套对象" class="headerlink" title="嵌套对象"></a>嵌套对象</h4><p>Student 类中包含 Address 对象：</p><img src="25.png" width="40%"><p>Address 对象：</p><img src="26.png" width="50%"><p>mapper 文件：</p><img src="27.png" width="80%"><h3 id="返回-List"><a href="#返回-List" class="headerlink" title="返回 List"></a>返回 List</h3><p>mapper 文件：</p><img src="39.png" width="50%"><ul><li>resultType 属性不区分大小写，sTuDenT（student） 为 javabean 对象。</li></ul><p>对应接口方法：</p><img src="40.png" width="50%"><h3 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h3><h4 id="输入参数"><a href="#输入参数" class="headerlink" title="输入参数"></a>输入参数</h4><p>JAVA 主程序：</p><img src="30.png" width="80%"><p>mapper 文件：</p><img src="31.png" width="80%"><ul><li>map 的 key 值必须和占位符中的值一样。</li></ul><h4 id="输出参数"><a href="#输出参数" class="headerlink" title="输出参数"></a>输出参数</h4><p>mapper 文件：</p><img src="41.png" width="60%"><p>对应接口方法：</p><img src="42.png" width="60%"><ul><li>该方法只能返回一个 Map 对象。</li><li>如果想返回多个 Map 对象，可以将方法的返回类型直接改成 <code>List&lt;Map&lt;String, Object&gt;&gt;</code></li></ul><h5 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h5><img src="43.png" width="80%"> <img src="86.png" width="80%"><h4 id="MapKey"><a href="#MapKey" class="headerlink" title="@MapKey"></a>@MapKey</h4><p>JAVA 代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapKey</span>(<span class="string">"id"</span>)  </span><br><span class="line"><span class="keyword">public</span> Map&lt;Integer, Map&lt;String, Object&gt;&gt;getUsers(Map&lt;String, Object&gt;param);</span><br></pre></td></tr></table></figure><ul><li>id 为数据库主键，类型为 Integer 类型。</li></ul><p>mapper 文件：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsers"</span> <span class="attr">resultType</span>=<span class="string">"java.util.Map"</span>  <span class="attr">parameterType</span>=<span class="string">"java.util.Map"</span>&gt;</span>  </span><br><span class="line">    select id, name, sex from t_user  </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>返回的结果是：</p><p><code>{1={name:jasion, sex:1}, 2={name:jack, sex=1}}</code></p><h2 id="javaType、jdbcType-和-MySQL-之间对应关系"><a href="#javaType、jdbcType-和-MySQL-之间对应关系" class="headerlink" title="javaType、jdbcType 和 MySQL 之间对应关系"></a>javaType、jdbcType 和 MySQL 之间对应关系</h2><h3 id="javaType-与-jdbcType"><a href="#javaType-与-jdbcType" class="headerlink" title="javaType 与 jdbcType"></a>javaType 与 jdbcType</h3><img src="38.png" width="40%"><ul><li>jdbcType 为 MyBatis 内置类型。</li></ul><h3 id="jdbcType-与-MySQL"><a href="#jdbcType-与-MySQL" class="headerlink" title="jdbcType 与 MySQL"></a>jdbcType 与 MySQL</h3><img src="37.png" width="40%"><h2 id="调用存储过程"><a href="#调用存储过程" class="headerlink" title="调用存储过程"></a>调用存储过程</h2><ol><li><p>编写存储过程：</p><img src="33.png" width="80%"></li><li><p>mapper 文件：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryCountByGradeWithProcedure"</span> <span class="attr">statementType</span>=<span class="string">"CALLABLE"</span> <span class="attr">parameterType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        CALL queryCountByGradeWithProcedure(&#123;</span><br><span class="line"></span><br><span class="line">            #&#123;gName, jdbcType=VARCHAR, mode=IN&#125;,</span><br><span class="line">            #&#123;sCount, jdbcType=INTEGER, mode=OUT&#125;,</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>statementType=&quot;CALLABLE&quot;</code> 声明使用存储过程。</li><li>mode=IN 为输入参数。</li><li>mode=OUT 为输出参数。</li><li>通过 Map 的 put 方法传入输入参数，get 方法获取存储过程的输出参数，所以没有返回值。</li></ul></li><li><p>程序调用存储过程：</p><img src="35.png" width="70%"></li></ol><h2 id="mapper-扩展"><a href="#mapper-扩展" class="headerlink" title="mapper 扩展"></a>mapper 扩展</h2><h3 id="动态-SQL"><a href="#动态-SQL" class="headerlink" title="动态 SQL"></a>动态 SQL</h3><h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><img src="48.png" width="80%"><ul><li>stuName 为 student 对象中的属性。</li></ul><h4 id="where"><a href="#where" class="headerlink" title="where"></a>where</h4><p>where 标签自动处理第一个 and 关键字（第一个 and 关键字自动省略，这样就不会造成拼接 SQL 语句错误）。</p><img src="49.png" width="80%"><h4 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h4><img src="50.png" width="80%"><h5 id="遍历对象中-List-集合"><a href="#遍历对象中-List-集合" class="headerlink" title="遍历对象中 List 集合"></a>遍历对象中 List 集合</h5><ol><li><p>JavaBean：</p><img src="52.png" width="50%"></li><li><p>mapper 文件：</p><img src="51.png" width="80%"><ul><li>collection 为遍历集合。</li><li>open 开始拼接。</li><li>item 迭代元素。</li><li>separator 分隔符。</li><li>close 关闭。</li></ul></li></ol><h5 id="遍历数组"><a href="#遍历数组" class="headerlink" title="遍历数组"></a>遍历数组</h5><ol><li><p>接口方法：</p><img src="53.png" width="50%"></li><li><p>mapper 文件：</p><img src="54.png" width="80%"><ul><li>在 mapper 中用 array 代替输入数组。</li></ul></li></ol><h5 id="遍历-List-集合"><a href="#遍历-List-集合" class="headerlink" title="遍历 List 集合"></a>遍历 List 集合</h5><img src="55.png" width="80%"><ul><li>用 list 代替传入 list 集合，与变量名无关。</li></ul><h5 id="遍历对象数组"><a href="#遍历对象数组" class="headerlink" title="遍历对象数组"></a>遍历对象数组</h5><img src="56.png" width="80%"><ul><li>输入参数用 <code>Object[]</code> 表示对象数组，collection 属性用 array 表示数组，与变量名无关。</li></ul><h3 id="SQL-片段"><a href="#SQL-片段" class="headerlink" title="SQL 片段"></a>SQL 片段</h3><ol><li><p>定义 sql 片段：</p><img src="57.png" width="80%"></li><li><p>引用：</p><img src="58.png" width="80%"><ul><li>如果跨文件引用 sql 片段，refid 的值为 namespace.id（id 为定义 sql 片段的 id 值）。</li></ul></li></ol><h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><h3 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h3><h4 id="关系图"><a href="#关系图" class="headerlink" title="关系图"></a>关系图</h4><img src="61.png" width="50%"><h4 id="新建扩展类"><a href="#新建扩展类" class="headerlink" title="新建扩展类"></a>新建扩展类</h4><p>新建扩展类接收一对一查询返回的结果集。</p><h4 id="association"><a href="#association" class="headerlink" title="association"></a>association</h4><p>通过 bean 对象接受查询结果集。</p><img src="59.png" width="30%"><p>association 标签指定内部对象。</p><img src="60.png" width="80%"><ul><li>JavaType 指定对象类型。</li></ul><h3 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h3><h4 id="关系图-1"><a href="#关系图-1" class="headerlink" title="关系图"></a>关系图</h4><img src="62.png" width="50%"><h4 id="collection"><a href="#collection" class="headerlink" title="collection"></a>collection</h4><p>通过 List 集合接受查询结果集。</p><img src="63.png" width="50%"><p>collection 标签指定 List 集合。</p><img src="64.png" width="60%"><ul><li>ofType 指定的是映射到 List 集合类型。</li></ul><h2 id="延迟加载"><a href="#延迟加载" class="headerlink" title="延迟加载"></a>延迟加载</h2><img src="69.png" width="80%"><h3 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 启用延迟加载特性，不配置默认关闭该特性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">setting</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- false: 关闭立即加载；true: 立即加载所有属性；--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="一对一-1"><a href="#一对一-1" class="headerlink" title="一对一"></a>一对一</h3><h4 id="新建-mapper-文件"><a href="#新建-mapper-文件" class="headerlink" title="新建 mapper 文件"></a>新建 mapper 文件</h4><img src="71.png" width="80%"><h4 id="主-mapper-文件"><a href="#主-mapper-文件" class="headerlink" title="主 mapper 文件"></a>主 mapper 文件</h4><img src="72.png" width="80%"> <img src="73.png" width="80%"> <img src="74.png" width="80%"><ul><li>select 属性为新建 mapper 文件的 namespace.id。</li><li>column 属性指定数据库字段名，为联表查询时的外键（外键一般两张表同时具备）。</li></ul><h3 id="一对多-1"><a href="#一对多-1" class="headerlink" title="一对多"></a>一对多</h3><h4 id="动态代理接口"><a href="#动态代理接口" class="headerlink" title="动态代理接口"></a>动态代理接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LazyLoadMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">Category <span class="title">lazyLoadTest</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="comment">// 改接口可要可不要</span></span><br><span class="line">    <span class="function">List&lt;Product&gt; <span class="title">selectProductsByCategoryId</span><span class="params">(<span class="keyword">int</span> cId)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="mapper-2"><a href="#mapper-2" class="headerlink" title="mapper"></a>mapper</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper </span></span><br><span class="line"><span class="meta">    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" </span></span><br><span class="line"><span class="meta">    "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.sl.mapper.LazyLoadMapper"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 分类信息查询 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"lazyLoadTest"</span>  <span class="attr">resultMap</span>=<span class="string">"lazyLoadProductsByCategoryTest"</span>&gt;</span></span><br><span class="line">            select * from category where id=#&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"lazyLoadProductsByCategoryTest"</span> <span class="attr">type</span>=<span class="string">"com.sl.po.Category"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"Id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"Name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"remark"</span> <span class="attr">property</span>=<span class="string">"Remark"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 一个分类对应多个产品，此处使用collection --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"productList"</span> <span class="attr">ofType</span>=<span class="string">"com.sl.po.Product"</span>  <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">select</span>=<span class="string">"selectProductsByCategoryId"</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 嵌套查询返回商品信息，延迟加载将要执行的sql --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectProductsByCategoryId"</span>  <span class="attr">resultType</span>=<span class="string">"com.sl.po.Product"</span>&gt;</span></span><br><span class="line">            select * from products where categoryid=#&#123;id&#125; </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">        </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="主程序"><a href="#主程序" class="headerlink" title="主程序"></a>主程序</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestLazyLoadMapperClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义会话SqlSession</span></span><br><span class="line">    SqlSession session = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 定义mabatis全局配置文件</span></span><br><span class="line">        String resource = <span class="string">"SqlMapConfig.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">        SqlSessionFactory factory = builder.build(inputStream);</span><br><span class="line">        <span class="comment">// 根据sqlSessionFactory产生会话sqlsession</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 延迟加载</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testoneToManyTestCollectionSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        LazyLoadMapper mapper = session.getMapper(LazyLoadMapper.class);</span><br><span class="line"></span><br><span class="line">        Category category = mapper.lazyLoadTest(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//System.out.println(category);</span></span><br><span class="line">        System.out.println(category.getName());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (category.getProductList().size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Product pro : category.getProductList()) &#123;</span><br><span class="line">                System.out.println(pro);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 关闭会话</span></span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="整合-log4j"><a href="#整合-log4j" class="headerlink" title="整合 log4j"></a>整合 log4j</h2><h3 id="日志级别"><a href="#日志级别" class="headerlink" title="日志级别"></a>日志级别</h3><img src="68.png" width="50%"><h3 id="Maven-依赖-2"><a href="#Maven-依赖-2" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><p>整合 log4j 主要观察 MyBatis 中的实际 SQL 语句和 SQL 中的参数和返回结果。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Mybatis-配置文件"><a href="#Mybatis-配置文件" class="headerlink" title="Mybatis 配置文件"></a>Mybatis 配置文件</h3><p>全局配置</p><img src="65.png" width="50%"> <img src="66.png" width="50%"><h3 id="log4j-properties"><a href="#log4j-properties" class="headerlink" title="log4j.properties"></a>log4j.properties</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Global logging configuration</span></span><br><span class="line"><span class="string">log4j.rootLogger=DEBUG,</span> <span class="string">stdout</span></span><br><span class="line"><span class="comment"># MyBatis logging configuration...</span></span><br><span class="line"><span class="string">log4j.logger.org.mybatis.example.BlogMapper=TRACE</span></span><br><span class="line"><span class="comment"># Console output...</span></span><br><span class="line"><span class="string">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="string">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="string">log4j.appender.stdout.layout.ConversionPattern=%5p</span> <span class="string">[%t]</span> <span class="bullet">-</span> <span class="string">%m%n</span></span><br></pre></td></tr></table></figure><ul><li>stdout 控制台输出。</li></ul><h2 id="PageHelper"><a href="#PageHelper" class="headerlink" title="PageHelper"></a>PageHelper</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>PageHelper 为国人开发的 MyBatis 分页插件，<a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/README_zh.md" target="_blank" rel="noopener">官方文档连接</a>。</p><h3 id="Maven-依赖-3"><a href="#Maven-依赖-3" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><img src="97.png" width="60%"><h3 id="MyBatis-配置"><a href="#MyBatis-配置" class="headerlink" title="MyBatis 配置"></a>MyBatis 配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- com.github.pagehelper 为 PageHelper 类所在包名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 使用下面的方式配置参数，后面会有所有的参数介绍 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"param1"</span> <span class="attr">value</span>=<span class="string">"value1"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="参数配置"><a href="#参数配置" class="headerlink" title="参数配置"></a>参数配置</h3><table><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">reasonable</td><td align="left">用户输入的页数不在合法范围时能够正确的响应到正确的结果页面， 那么你可以配置 reasonable 为 true，这时如果 pageNum&lt;=0 会查询第一页，如果 pageNum&gt;总页数 会查询最后一页。</td></tr></tbody></table><h3 id="使用-2"><a href="#使用-2" class="headerlink" title="使用"></a>使用</h3><p>PageHelper.startPage 静态方法调用。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取第1页，10条内容，默认查询总数count</span></span><br><span class="line">PageHelper.startPage(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">//紧跟着的第一个 MyBatis 查询方法会被进行分页</span></span><br><span class="line">List&lt;Country&gt; list = countryMapper.selectIf(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><ul><li><p>获取其他参数：</p><img src="98.png" width="60%"><ul><li>获取其他参数必须先查询完数据库之后才能获取。</li></ul></li></ul><p>使用 PageInfo 的用法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取第1页，10条内容，默认查询总数count</span></span><br><span class="line">PageHelper.startPage(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">List&lt;Country&gt; list = countryMapper.selectAll();</span><br><span class="line"><span class="comment">//用PageInfo对结果进行包装</span></span><br><span class="line">PageInfo page = <span class="keyword">new</span> PageInfo(list);</span><br></pre></td></tr></table></figure><ul><li>PageInfo 包含了非常全面的分页参数。</li></ul><h2 id="逆向工程"><a href="#逆向工程" class="headerlink" title="逆向工程"></a>逆向工程</h2><img src="79.png" width="80%"><h3 id="Maven-依赖-4"><a href="#Maven-依赖-4" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.generator/mybatis-generator-core --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="xml-配置文件"><a href="#xml-配置文件" class="headerlink" title="xml 配置文件"></a>xml 配置文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration </span></span><br><span class="line"><span class="meta">    PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN" </span></span><br><span class="line"><span class="meta">    "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 数据库驱动包位置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">classPathEntry</span> <span class="attr">location</span>=<span class="string">"D:\maven\Repository\mysql\mysql-connector-java\8.0.15\mysql-connector-java-8.0.15.jar"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"sqlGenerate"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressAllComments"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 数据库链接URL、用户名、密码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://localhost:3306/ssm?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;serverTimezone=UTC"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">userId</span>=<span class="string">"root"</span> <span class="attr">password</span>=<span class="string">"123456"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">         <span class="comment">&lt;!-- 默认false，把JDBC DECIMAL 和 NUMERIC 类型解析为 Integer;</span></span><br><span class="line"><span class="comment">         为 true时把JDBC DECIMAL和NUMERIC类型解析为java.math.BigDecimal --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 生成Pojo包名和位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"top.zero3737.entity"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">targetProject</span>=<span class="string">".\src\main\java"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 清理前后的空格 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 生成Mapper映射XML文件位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"top.zero3737.dao"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">targetProject</span>=<span class="string">".\src\main\java"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 生成Mapper接口文件位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">targetPackage</span>=<span class="string">"top.zero3737.dao"</span> <span class="attr">targetProject</span>=<span class="string">".\src\main\java"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"user"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>targetProject 生成路径（包所在路径）。</li><li>targetPackage 生成包名。</li><li>tableName 指定数据库表，根据指定表生成类、接口、mapper 文件。</li></ul><h3 id="主程序-1"><a href="#主程序-1" class="headerlink" title="主程序"></a>主程序</h3><p>运行该方法即可生成对应 bean 对象、mapper 和 接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Generator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">//指向逆向工程配置文件，只需要把下面这个文件改为你自己写的配置文件即可</span></span><br><span class="line">        File configFile = <span class="keyword">new</span> File(<span class="string">"src/main/java/top/zero3737/generator/generatorConfig.xml"</span>);</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(configFile);  </span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);  </span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);  </span><br><span class="line">        myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(<span class="string">"执行成功！"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用-3"><a href="#使用-3" class="headerlink" title="使用"></a>使用</h3><img src="88.png" width="70%"><ol><li>可以通过 Example 对象查询。</li><li>通过 Example 对象创建 Criteria 对象追加自定义条件。</li></ol><p>添加 or 条件：</p><img src="89.png" width="70%"><ol><li>Example 对象默认使用第一个 Criteria 对象的规则。</li><li>Example 对象通过 or 方法追加规则。</li></ol><h3 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h3><ol><li>默认不通过 Criteria 对象追加条件，即查询所有记录。</li><li>Example 对象纳入 IOC 容器只有一个对象，下次使用还是上次的 Example 对象，不会被初始化（即会不断追加条件）。</li><li>逆向工程每次运行前都要把之前生成的文件删除，每次运行不会覆盖之前的文件，而是追加内容。</li></ol><h2 id="通用-Mapper"><a href="#通用-Mapper" class="headerlink" title="通用 Mapper"></a>通用 Mapper</h2><h3 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h3><p>通用 Mapper 是由国人开发的一款 MyBatis 插件，通用 Mapper <a href="https://github.com/abel533/Mapper/wiki" target="_blank" rel="noopener">官方文档</a>。</p><h3 id="Maven-依赖-5"><a href="#Maven-依赖-5" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/tk.mybatis/mapper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h3><p>通用 mapper 依赖与 persistence-api (Java Persistence API，简称 JPA)，下列注解来自于这个依赖。</p><h4 id="Table"><a href="#Table" class="headerlink" title="@Table"></a>@Table</h4><ol><li>声明在 pojo 类的属性上。</li><li>name 属性指定表名。</li></ol><h4 id="Id"><a href="#Id" class="headerlink" title="@Id"></a>@Id</h4><ol><li>声明在 bean 对象的属性上。</li><li>声明主键。</li><li>属性不能是基本类型，必须是包装类型，如果为基本类型，则无法查出数据。</li></ol><h4 id="Column"><a href="#Column" class="headerlink" title="@Column"></a>@Column</h4><ol><li>声明在 bean 对象的属性上。</li><li>name 属性声明数据库字段与属性名想对应。</li><li>默认支持驼峰式命名对应数据库的下划线形式（myTable -&gt; my_table）。</li></ol><h4 id="Transient"><a href="#Transient" class="headerlink" title="@Transient"></a>@Transient</h4><ol><li>声明在 bean 对象的属性上。</li><li>@Transient 表示该属性并非一个到数据库表的字段的映射，ORM 框架将忽略该属性。</li><li>如果一个属性并非数据库表的字段映射，就务必将其标示为 @Transient，否则 ORM 框架默认其注解为 @Basic。</li></ol><h4 id="GeneratedValue"><a href="#GeneratedValue" class="headerlink" title="@GeneratedValue"></a>@GeneratedValue</h4><ol><li><p>必须声明在主键字段上（和 @Id 注解使用）。</p></li><li><p>声明数据库主键生成策略。</p></li><li><p>strategy 属性可选参数：</p><ul><li>GenerationType.AUTO 主键由程序控制，默认选项。</li><li>GenerationType.IDENTITY 数据库采用自增长，Oracle 不支持这种方式。</li></ul></li><li><p>插入数据的时候，pojo 类没有给主键赋值，默认不会自动将数据库主键信息写入 pojo 类主键属性中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xxxMapper.insert(pojo);</span><br><span class="line">System.out.println(pojo.getId()); <span class="comment">// 输出为 null</span></span><br></pre></td></tr></table></figure></li><li><p>设置主键生成策略为 GenerationType.IDENTITY （数据库必须采用自增的方式）时，插入时会将数据库主键写入对象中的主键属性中。</p></li></ol><h3 id="配置参数"><a href="#配置参数" class="headerlink" title="配置参数"></a>配置参数</h3><table><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">notEmpty</td><td align="left">insertSelective 和 updateByPrimaryKeySelective 中，是否判断字符串类型 !=’’。</td></tr></tbody></table><p>配置 notEmpty=false 解决空串 updateByPrimaryKeySelective 不更新的问题。</p><h3 id="编写-JAVA-程序"><a href="#编写-JAVA-程序" class="headerlink" title="编写 JAVA 程序"></a>编写 JAVA 程序</h3><ol><li><p>继承 Mapper 接口：</p><img src="206.png" width="50%"></li><li><p>bean 对象对应数据库字段：</p><img src="207.png" width="50%"></li></ol><h3 id="API-介绍"><a href="#API-介绍" class="headerlink" title="API 介绍"></a>API 介绍</h3><table><thead><tr><th align="left">API</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">xxxMapper.selectAll()</td><td align="left">查询所有。</td></tr><tr><td align="left">xxxMapper.selectByPrimaryKey(Object key)</td><td align="left">根据主键查询。</td></tr><tr><td align="left">xxxMapper.selectOne(Pojo)</td><td align="left">根据 pojo 类查询数据库。</td></tr><tr><td align="left">xxxMapper.insert(Pojo)</td><td align="left">插入数据，必须将数据包装成 Pojo 对象。</td></tr><tr><td align="left">xxxMapper.updateByPrimaryKey(Pojo)</td><td align="left">根据 pojo 类更新数据，如果 pojo 类某个属性没有赋值，则默认值为 null，并将 null 插入数据库。</td></tr><tr><td align="left">xxxMapper.updateByPrimaryKeySelective(Pojo)</td><td align="left">根据 pojo 类更新数据，如果 pojo 类某个属性没有赋值，则忽略这个属性。</td></tr></tbody></table><p>example 用法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建 example</span></span><br><span class="line">Example example = <span class="keyword">new</span> Example(UserTable.class);</span><br><span class="line"><span class="comment">// 根据 password 升序排序，如果 password 相等则根据 username 降序排序</span></span><br><span class="line">example.orderBy(<span class="string">"password"</span>).asc().orderBy(<span class="string">"username"</span>).desc();</span><br><span class="line"><span class="comment">// 去重</span></span><br><span class="line">example.setDistinct(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">// 查询指定字段</span></span><br><span class="line">example.selectProperties(<span class="string">"password"</span>);</span><br><span class="line"><span class="comment">// 创建查询条件</span></span><br><span class="line">Example.Criteria c1 = example.createCriteria();</span><br><span class="line"><span class="comment">// 查询 password 大于等于 1</span></span><br><span class="line">c1.andGreaterThanOrEqualTo(<span class="string">"password"</span>, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// 查询 password 小于等于 10</span></span><br><span class="line">c1.andLessThanOrEqualTo(<span class="string">"password"</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">// 创建第二个查询条件</span></span><br><span class="line">Example.Criteria c2 = example.createCriteria();</span><br><span class="line"><span class="comment">// 查询 username 包含 s</span></span><br><span class="line">c2.andLike(<span class="string">"username"</span>, <span class="string">"s"</span>);</span><br><span class="line"><span class="comment">// example 将 c2 条件用 or 添加到 c1 条件</span></span><br><span class="line">example.or(c2);</span><br><span class="line"><span class="comment">// 执行查询语句</span></span><br><span class="line">List&lt;UserTable&gt; userTables = userTableMapper.selectByExample(example);</span><br></pre></td></tr></table></figure><h3 id="使用-Maven-执行-MBG"><a href="#使用-Maven-执行-MBG" class="headerlink" title="使用 Maven 执行 MBG"></a>使用 Maven 执行 MBG</h3><p>使用该插件可以很方便的生成实体类、Mapper 接口以及对应的XML文件。</p><h4 id="MBG-插件环境搭建"><a href="#MBG-插件环境搭建" class="headerlink" title="MBG 插件环境搭建"></a>MBG 插件环境搭建</h4><h5 id="Maven-配置"><a href="#Maven-配置" class="headerlink" title="Maven 配置"></a>Maven 配置</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">            $&#123;basedir&#125;/src/main/resources/generator/generatorConfig.xml</span><br><span class="line">        <span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.29<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="generatorConfig-xml-文件配置"><a href="#generatorConfig-xml-文件配置" class="headerlink" title="generatorConfig.xml 文件配置"></a>generatorConfig.xml 文件配置</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"Mysql"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"beginningDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"endingDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">"tk.mybatis.mapper.generator.MapperPlugin"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappers"</span> <span class="attr">value</span>=<span class="string">"tk.mybatis.mapper.common.Mapper"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"caseSensitive"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql:///database?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;serverTimezone=UTC"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">"123456"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 生成Pojo包名和位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.coclouds.library.activity.dao.model"</span> <span class="attr">targetProject</span>=<span class="string">".\src\main\java"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 生成Mapper映射XML文件位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.coclouds.library.activity.dao"</span> <span class="attr">targetProject</span>=<span class="string">".\src\main\java"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 生成Mapper接口文件位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.coclouds.library.activity.dao"</span> <span class="attr">targetProject</span>=<span class="string">".\src\main\java"</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--tableName 指定表，catalog 指定数据库--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"t_activity"</span> <span class="attr">catalog</span>=<span class="string">"database"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--解决 catalog 属性存在后缀的问题--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"ignoreQualifiersAtRuntime"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="节点说明"><a href="#节点说明" class="headerlink" title="节点说明"></a>节点说明</h4><ul><li><p>table 节点：</p><ul><li>tableName（必要）：要生成对象的表名。</li><li>schema：数据库的schema。</li><li>catalog：数据库的catalog。</li><li>domainObjectName：生成的domain类的名字，如果不设置，直接使用表名作为domain类的名字；可以设置为somepck.domainName，那么会自动把domainName类再放到somepck包里面。</li></ul></li><li><p>generatedKey 用于生成生成主键的方法，如果设置了该元素，MBG会在生成的 <code>&lt;insert&gt;</code> 元素中生成一条正确的 <code>&lt;selectKey&gt;</code> 元素，该元素可选。</p><ul><li><p>column 属性表示主键的列名。</p></li><li><p>sqlStatement 属性设置要生成的 selectKey 语句（用于插入语句时获取主键），有以下可选项:</p><table><thead><tr><th align="left">可选参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">Cloudscape</td><td align="left">相当于selectKey的SQL为： VALUES IDENTITY_VAL_LOCAL()</td></tr><tr><td align="left">DB2</td><td align="left">相当于selectKey的SQL为： VALUES IDENTITY_VAL_LOCAL()</td></tr><tr><td align="left">DB2_MF</td><td align="left">相当于selectKey的SQL为：SELECT IDENTITY_VAL_LOCAL() FROM SYSIBM.SYSDUMMY1</td></tr><tr><td align="left">Derby</td><td align="left">相当于selectKey的SQL为：VALUES IDENTITY_VAL_LOCAL()</td></tr><tr><td align="left">HSQLDB</td><td align="left">相当于selectKey的SQL为：CALL IDENTITY()</td></tr><tr><td align="left">Informix</td><td align="left">相当于selectKey的SQL为：select dbinfo(‘sqlca.sqlerrd1’) from systables where tabid=1</td></tr><tr><td align="left">MySql</td><td align="left">相当于selectKey的SQL为：SELECT LAST_INSERT_ID()</td></tr><tr><td align="left">SqlServer</td><td align="left">相当于selectKey的SQL为：SELECT SCOPE_IDENTITY()</td></tr><tr><td align="left">SYBASE</td><td align="left">相当于selectKey的SQL为：SELECT @@IDENTITY</td></tr><tr><td align="left">JDBC</td><td align="left">相当于在生成的insert元素上添加useGeneratedKeys=”true”和keyProperty属性</td></tr></tbody></table></li><li><p>identity 属性可选参数为 true 或 false。</p><ul><li><p>identity 属性为 true 时： the generated <code>&lt;selectKey&gt;</code> element will be placed after the insert</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- identity 为 true 时，selectKey 节点 order 属性 为 AFTER --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"jobId"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">    SELECT LAST_INSERT_ID()</span><br><span class="line"><span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>order 属性 为 after 表示先执行插入语句再获取 id，适用于 mysql、oracle 这种可以自动生成 id 序列的数据库。</p></li><li><p>identity 属性为 false 时：the generated <code>&lt;selectKey&gt;</code> will be placed before the insert</p></li><li><p>order 属性 为 false 表示会先生成 id，然后再执行插入。</p></li></ul></li></ul></li></ul><h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><h2 id="入门案例-1"><a href="#入门案例-1" class="headerlink" title="入门案例"></a>入门案例</h2><h3 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h3><p>spring 在启动的时候需要验证 xml 文档，约束的作用就是来验证配置文件的 xml 文档语法的正确性。</p><p>XML 文档的 schema 约束定义了文档的结构，内容和语法，元素和属性等（规范）。</p><ol><li>XML 配置文件中所有的标签和属性都需要 schema 来定义。</li><li><a href="http://www.springframework.org/schema/" target="_blank" rel="noopener">spring 官网 schema 约束下载地址</a>。</li></ol><h3 id="Maven-依赖-6"><a href="#Maven-依赖-6" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><p>spring-context 依赖于 spring-aop、spring-beans、spring-core 和 spring-expression。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-context --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Spring-配置文件"><a href="#Spring-配置文件" class="headerlink" title="Spring 配置文件"></a>Spring 配置文件</h3><ol><li><p>spring 模板:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Spring 配置文件放在 resources 目录下。</li></ul></li><li><p>给 bean 对象赋值：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"teacher"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.Teacher"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"zs"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"course"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.Course"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"message"</span> <span class="attr">ref</span>=<span class="string">"teacher"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>bean 标签表示 bean 对象，bean 对象拥有 getter 和 setter 方法。</p></li><li><p>id 唯一标识。</p></li><li><p>class 为限定名，可通过双击类名 -&gt; 鼠标右键 -&gt; 复制限定名</p><img src="1.png" width="40%"></li><li><p>property 标签表示 bean 对象中的属性。</p></li><li><p>name 为 bean 对象中的属性（不可自定义）。</p></li><li><p>value 属性指定 bean 对象中对应的属性进行赋值（8 个基本类型 + String 使用 value 赋值）。</p></li><li><p>ref 用于给 bean 赋引用类型的值，一般指向需要引用的 id 值。</p></li><li><p>course 依赖于 teacher。</p></li></ul></li></ol><h3 id="获取-IOC-实例"><a href="#获取-IOC-实例" class="headerlink" title="获取 IOC 实例"></a>获取 IOC 实例</h3><p>读取 Spring 配置文件（Spring 配置文件名为 beans.xml）并获取 Bean 对象属性。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>).getBean(<span class="string">"helloWorld"</span>).toString());</span><br></pre></td></tr></table></figure><ul><li>ClassPathXmlApplicationContext （Spring 上下文对象）加载 Spring 配置文件，创建并初始化所有的对象。</li><li>getBean 方法根据 id 属性获得所需的 bean。</li></ul><h3 id="查看-IOC-容器中所有-bean-对象"><a href="#查看-IOC-容器中所有-bean-对象" class="headerlink" title="查看 IOC 容器中所有 bean 对象"></a>查看 IOC 容器中所有 bean 对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:applicationContext.xml"</span>);</span><br><span class="line">String[] str = context.getBeanDefinitionNames();</span><br><span class="line"><span class="keyword">for</span> (String string : str) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"..."</span> + string);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h2><h3 id="DI-与-IOC"><a href="#DI-与-IOC" class="headerlink" title="DI 与 IOC"></a>DI 与 IOC</h3><table><thead><tr><th align="left">全称</th><th align="left">简称</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">控制反转</td><td align="left">IOC</td><td align="left">将设计好的对象交给容器控制。</td></tr><tr><td align="left">依赖注入</td><td align="left">DI</td><td align="left">组件之间依赖关系由容器在运行期决定（谁依赖谁）。</td></tr></tbody></table><p>IOC 与 DI 是同一个概念的不同角度描述。</p><h3 id="通过-setter-方法注入"><a href="#通过-setter-方法注入" class="headerlink" title="通过 setter 方法注入"></a>通过 setter 方法注入</h3><h4 id="基本类型（包含封装类）"><a href="#基本类型（包含封装类）" class="headerlink" title="基本类型（包含封装类）"></a>基本类型（包含封装类）</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.HelloWorld"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"message"</span> <span class="attr">value</span>=<span class="string">"Hello World!"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="List、-Set、-数组类型"><a href="#List、-Set、-数组类型" class="headerlink" title="List、 Set、 数组类型"></a>List、 Set、 数组类型</h4><p>List、 Set、 数组类型注入方式类似。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.HelloWorld"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>233<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>666<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>biu<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>数组使用 <code>&lt;array&gt;</code> 标签。</li><li>list 使用 <code>&lt;list&gt;</code> 标签。</li><li>set 使用 <code>&lt;settings&gt;</code> 标签。</li></ul><h4 id="Map-类型"><a href="#Map-类型" class="headerlink" title="Map 类型"></a>Map 类型</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.HelloWorld"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>key<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>value<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>key-233<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>value-233<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Properties-类"><a href="#Properties-类" class="headerlink" title="Properties 类"></a>Properties 类</h4><ol><li><p>Boss 类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Boss</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Properties mails;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Properties <span class="title">getMails</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mails;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMails</span><span class="params">(Properties mails)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mails = mails;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(mails);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>注入配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"boss2"</span> <span class="attr">class</span>=<span class="string">"com.spring.model.Boss"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mails"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"jobMail"</span>&gt;</span>john-office@163.com<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"lifeMail"</span>&gt;</span>john-life@163.com<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="通过构造方法注入"><a href="#通过构造方法注入" class="headerlink" title="通过构造方法注入"></a>通过构造方法注入</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.HelloWorld"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"abcdefg"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"teacher"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>构造方法有两个参数（第一个 String 类型，第二个 Teacher 类型）。</p></li><li><p>注入参数必须和构造方法的形参一样（顺序不能跌倒）。</p></li><li><p>index 属性指定注入形参顺序。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.HelloWorld"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"teacher"</span> <span class="attr">index</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"abcdefg"</span> <span class="attr">index</span>=<span class="string">"0"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>name 属性指定注入形参名称。</p></li><li><p>type 属性指定注入类型。</p></li></ul><h3 id="通过命名空间注入"><a href="#通过命名空间注入" class="headerlink" title="通过命名空间注入"></a>通过命名空间注入</h3><p>添加 <code>xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</code> p 命名空间（通过 setter 方法注入）。</p><p>添加 <code>xmlns:c=&quot;http://www.springframework.org/schema/c&quot;</code> c 命名空间（通过构造函数注入）。</p><p>通过 p 命名空间注入示例：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.HelloWorld"</span> <span class="attr">p:</span>属性名=<span class="string">"属性值"</span> <span class="attr">p:</span>属性名<span class="attr">-ref</span>=<span class="string">"属性值"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>p:属性名</code> 适用于基本类型。</li><li><code>p:属性名-ref</code> 适用于引用类型。</li></ul><h3 id="自动装配"><a href="#自动装配" class="headerlink" title="自动装配"></a>自动装配</h3><h4 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍"></a>介绍</h4><ul><li>类中的对象属性和 IOC 容器中的 bean 对象自动赋值（通过名字 id、类型和构造函数），即自动装配。</li><li>自动装配只适用与引用类型。</li></ul><h4 id="自动装配模式"><a href="#自动装配模式" class="headerlink" title="自动装配模式"></a>自动装配模式</h4><p>通过配置 bean 标签中的 autowire 属性，配置自动装配模式。</p><table><thead><tr><th align="left">模式</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">no</td><td align="left">该模式表示默认情况下，不自动装配。</td></tr><tr><td align="left">byName</td><td align="left">根据 bean 属性名和 xml 中的 id 值自动装配。</td></tr><tr><td align="left">byType</td><td align="left">根据类型自动装配（默认）。</td></tr><tr><td align="left">constructor</td><td align="left">根据构造函数自动装配。</td></tr><tr><td align="left">default</td><td align="left">1. 表示默认采用上一级标签的自动装配的取值。<br>2. 如果存在多个配置文件的话，那么每一个配置文件的自动装配方式都是独立的。</td></tr></tbody></table><h4 id="全局自动装配"><a href="#全局自动装配" class="headerlink" title="全局自动装配"></a>全局自动装配</h4><p>可以在 beans 标签设置 default-autowire 属性配置全局自动装配。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:p</span>=<span class="string">"http://www.springframework.org/schema/p"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:util</span>=<span class="string">"http://www.springframework.org/schema/util"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx </span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/util </span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/util/spring-util.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span> <span class="attr">default-autowire</span>=<span class="string">"byName"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"cat"</span> <span class="attr">class</span>=<span class="string">"com.hdu.autowire.Cat"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dog"</span> <span class="attr">class</span>=<span class="string">"com.hdu.autowire.Dog"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.hdu.autowire.User"</span> <span class="attr">autowire</span>=<span class="string">"default"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"com.hdu.autowire.User"</span> <span class="attr">autowire</span>=<span class="string">"default"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user3"</span> <span class="attr">class</span>=<span class="string">"com.hdu.autowire.User"</span> <span class="attr">autowire</span>=<span class="string">"default"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="基于注解依赖注入"><a href="#基于注解依赖注入" class="headerlink" title="基于注解依赖注入"></a>基于注解依赖注入</h2><h3 id="注解-1"><a href="#注解-1" class="headerlink" title="注解"></a>注解</h3><table><thead><tr><th align="left">注解</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">@Controller</td><td align="left">标记 controller 层类在 IOC 容器中生成 bean 对象（纳入 IOC 容器）。</td></tr><tr><td align="left">@Service</td><td align="left">标记 service 层类在 IOC 容器中生成 bean 对象（纳入 IOC 容器）。</td></tr><tr><td align="left">@Repository</td><td align="left">标记 dao 层类在 IOC 容器中生成 bean 对象（纳入 IOC 容器）。</td></tr><tr><td align="left">@Component</td><td align="left">是一种泛指（三层之外），spring 扫描注解配置时，会标记这些类要生成 bean（纳入 IOC 容器）。</td></tr></tbody></table><h3 id="配置扫描器"><a href="#配置扫描器" class="headerlink" title="配置扫描器"></a>配置扫描器</h3><p>如果通过注解方式纳入 IOC 容器，需要在 IOC 容器中开启扫描器。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"包类路径"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>component-scan 标签 base-package 属性指定类路径下寻找标注了 @Component、@Service、@Controller、@Repository 注解的类，并把这些类纳入 IOC 容器。</li></ul><h4 id="排除"><a href="#排除" class="headerlink" title="排除"></a>排除</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 排除Controller注解的扫描 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"exampleBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 排除扫描符合正则表达式的类,此处排除com.wx.comm.util包下的所有类 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"exampleBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"regex"</span> <span class="attr">expression</span>=<span class="string">"com.wx.comm.util.*"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 排除指定包exampleBean下的CommFF类的扫描 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"exampleBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"assignable"</span> <span class="attr">expression</span>=<span class="string">"exampleBean.CommFF"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="使用-4"><a href="#使用-4" class="headerlink" title="使用"></a>使用</h3><p>默认 bean 的名称为类名首字母小写，下例中 bean 的名称为 test。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"test"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>可通过给 @Component 注解 value 参数赋值，为 bean 对象自定义名称。</li></ul><h3 id="自动装配-1"><a href="#自动装配-1" class="headerlink" title="自动装配"></a>自动装配</h3><h4 id="注解-2"><a href="#注解-2" class="headerlink" title="注解"></a>注解</h4><table><thead><tr><th align="left">注解</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">@Autowired</td><td align="left">默认按 byType 自动注入。</td></tr><tr><td align="left">@Qualifier</td><td align="left">1. 当容器中存在多个 Bean 的类型与需要注入的相同时，注入将不能执行。<br>2. 通过 @Qualifier 注解指定注入 bean 的名称。</td></tr><tr><td align="left">@Resource</td><td align="left">默认按 byName 自动装配。</td></tr></tbody></table><h5 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h5><table><thead><tr><th align="left">@Autowired 参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">required</td><td align="left">布尔类型，依赖对象是否不允许为 null，默认 true。</td></tr></tbody></table><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><img src="20.png" width="80%"><ul><li>此例可以通过 @Resource 注解替换，简写 @Qualifier 注解。</li><li>@Resource 默认按 byName 自动装配。</li></ul><h2 id="读取-properties-文件配置参数"><a href="#读取-properties-文件配置参数" class="headerlink" title="读取 properties 文件配置参数"></a>读取 properties 文件配置参数</h2><ol><li><p>Spring 容器加载 properties 配置文件。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:config.properties"</span> <span class="attr">file-encoding</span>=<span class="string">"UTF-8"</span> <span class="attr">ignore-unresolvable</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>在属性通过 @Value 注解获取配置文件参数。</p><img src="188.png" width="50%"></li></ol><h2 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h2><h3 id="注解-3"><a href="#注解-3" class="headerlink" title="注解"></a>注解</h3><table><thead><tr><th align="left">注解</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">@Configuration</td><td align="left">声明该类为配置类，并纳入 IOC 容器（因为依赖于 @Component 注解）。</td></tr><tr><td align="left">@Bean</td><td align="left">让注解的方法生成 bean 对象，并让 Spring 管理。</td></tr></tbody></table><h3 id="使用-5"><a href="#使用-5" class="headerlink" title="使用"></a>使用</h3><ol><li><p>注入对象：</p><img src="200.png" width="80%"><ul><li>方法名对应 bean 标签的 id 属性。</li><li>返回值对应 bean 标签 class 属性。</li></ul></li><li><p>通过 set 方法给 bean 对象赋值：</p><img src="201.png" width="80%"></li><li><p>通过 AnnotationConfigApplicationContext 对象获取上下文对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AnnotationConfigApplicationContext applicationContext  = <span class="keyword">new</span> AnnotationConfigApplicationContext(AppConfig.class);</span><br><span class="line">applicationContext.getBean(<span class="string">"stuService"</span>);</span><br></pre></td></tr></table></figure></li></ol><h3 id="通过注解配置扫描器"><a href="#通过注解配置扫描器" class="headerlink" title="通过注解配置扫描器"></a>通过注解配置扫描器</h3><h4 id="注解-4"><a href="#注解-4" class="headerlink" title="注解"></a>注解</h4><table><thead><tr><th align="left">注解</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">@ComponentScan</td><td align="left">扫描路径下标注了 @Component、@Service、@Controller、@Repository 的类，并把这些类纳入 IOC 容器。该注解默认会扫描该类所在的包下所有的配置类。</td></tr></tbody></table><h4 id="使用-6"><a href="#使用-6" class="headerlink" title="使用"></a>使用</h4><p>在配置类（标注 @Configuration 注解的类）上添加 @ComponentScan 注解。</p><img src="24.png" width="60%"><h4 id="注意-2"><a href="#注意-2" class="headerlink" title="注意"></a>注意</h4><ul><li>通过配置类配置的 IOC 容器和通过 XML 配置的 IOC 容器是相互独立的。</li><li>所以通过注解形式配置的扫描器扫描注解（@Component 等等）是无法纳入通过 XML 配置的 IOC 容器中，只能纳入通过配置类配置的 IOC 容器中。</li><li>要想纳入通过 XML 配置的 IOC 容器中，必须配置 XML 形式的扫描器。</li></ul><h2 id="Spring-整合-JUnit"><a href="#Spring-整合-JUnit" class="headerlink" title="Spring 整合 JUnit"></a>Spring 整合 JUnit</h2><h3 id="Maven-依赖-7"><a href="#Maven-依赖-7" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="使用-7"><a href="#使用-7" class="headerlink" title="使用"></a>使用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@ContextConfiguration</span>(locations = &#123;<span class="string">"classpath:applicationContext.xml"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataHandler</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">            ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:applicationContext.xml"</span>);</span><br><span class="line">            String[] str = context.getBeanDefinitionNames();</span><br><span class="line">            <span class="keyword">for</span> (String string : str) &#123;</span><br><span class="line"></span><br><span class="line">                System.out.println(<span class="string">"..."</span> + string);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>@RunWith 指定 junit 运行环境。</li><li>@ContextConfiguration 加载 Spring 配置文件。</li></ul><h2 id="Spring-整合-AOP"><a href="#Spring-整合-AOP" class="headerlink" title="Spring 整合 AOP"></a>Spring 整合 AOP</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><table><thead><tr><th align="left">名词</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">通知（Advice）</td><td align="left">实现的功能。</td></tr><tr><td align="left">连接点（JoinPoint）</td><td align="left">允许你使用通知的地方，基本每个方法的前后，或抛出异常时都可以是连接点。</td></tr><tr><td align="left">切入点（Pointcut）</td><td align="left">筛选出要使用通知的连接点，为切入点。</td></tr><tr><td align="left">切面（Aspect）</td><td align="left">切面是通知和切入点的结合。</td></tr></tbody></table><h3 id="Maven-依赖-8"><a href="#Maven-依赖-8" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>aopalliance<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aopalliance<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>aopalliance<ul><li>AOP 联盟的 API 包，里面包含了针对面向切面的接口。</li></ul></li><li>aspectjweaver<ul><li>AspectJ 是一个面向切面的框架，它扩展了Java语言。</li><li>AspectJ 不是 Spring 的一部分。</li></ul></li></ol><h3 id="execution-表达式"><a href="#execution-表达式" class="headerlink" title="execution 表达式"></a>execution 表达式</h3><p>execution 表达式用于匹配方法执行的连接点。</p><ul><li><code>public * *(..)</code><ul><li>第一个 * 号表示返回任意类型。</li><li>第二个 * 号表示匹配方法名。</li><li><code>..</code> 表示匹配任意形参。</li><li>该 execution 表达式意思为匹配所有公有属性的方法。</li></ul></li><li><code>* top.zero3737..*.*(..)</code><ul><li>第一个 * 号表示返回任意类型。</li><li>包名表示要匹配的包。</li><li><code>..</code> 表示匹配当前包和当前包的所有子包。</li><li>第二个 * 号表示匹配任意类名。</li><li>第三个 * 号表示匹配任意方法名。</li><li><code>..</code> 表示匹配任意形参。</li><li>该 execution 表达式意思为匹配 top.zero3737 包下的所有方法。</li></ul></li><li>可以同时使用多条 execution 表达式匹配被切入的方法。<ul><li>多条 execution 表达式用 or 分隔。</li></ul></li></ul><h3 id="基于接口实现-AOP"><a href="#基于接口实现-AOP" class="headerlink" title="基于接口实现 AOP"></a>基于接口实现 AOP</h3><h4 id="通知接口"><a href="#通知接口" class="headerlink" title="通知接口"></a>通知接口</h4><h5 id="前置通知"><a href="#前置通知" class="headerlink" title="前置通知"></a>前置通知</h5><p>实现 MethodBeforeAdvice（前置通知）接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeforeAdvice</span> <span class="keyword">implements</span> <span class="title">MethodBeforeAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 前置通知逻辑</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>method 为切入方法。</li><li>args 为切入方法的形参。</li><li>target 为目标对象（切入方法的所属对象）。</li></ul><h5 id="后置通知"><a href="#后置通知" class="headerlink" title="后置通知"></a>后置通知</h5><p>实现 AfterReturningAdvice 接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAfterReturningAdvice</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object returnValue, Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 后置通知逻辑</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>returnValue 为切入方法的返回值。</li><li>method 为切入方法。</li><li>args 为切入方法的形参。</li><li>target 为目标对象（切入方法的所属对象）。</li></ul><h5 id="异常通知"><a href="#异常通知" class="headerlink" title="异常通知"></a>异常通知</h5><p>实现 ThrowsAdvice 接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> <span class="keyword">implements</span> <span class="title">ThrowsAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Method method, Object[] args, Object target, Exception e)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 发生异常的逻辑操作。</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>该接口没有包含任何方法，但必须定义 <code>void afterThrowing([Method, args, target], ThrowableSubclass);</code> 方法（发生异常时的逻辑操作）。</li></ul><h5 id="环绕通知"><a href="#环绕通知" class="headerlink" title="环绕通知"></a>环绕通知</h5><p>实现 MethodInterceptor 接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(MethodInvocation invocation)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    </span><br><span class="line">    Object result = <span class="keyword">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 前置通知逻辑...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 前置通知逻辑...</span></span><br><span class="line">        </span><br><span class="line">        result = invocation.proceed();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 后置通知逻辑...</span></span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 异常通知逻辑...</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>invocation.proceed() 控制切入方法的执行（相当于切入方法）。</li><li>invocation.proceed() 返回值为切入方法的返回值。</li><li>invocation.getThis() 获取目标对象。</li><li>invocation.getMethod() 获取切入方法。</li><li>invocation.getArguments() 获取切入方法形参。</li></ul><h5 id="注意-3"><a href="#注意-3" class="headerlink" title="注意"></a>注意</h5><p>执行顺序：</p><ol><li>前置通知。</li><li>环绕通知模拟的前置通知。</li><li>环绕通知模拟的后置通知。</li><li>后置通知。</li></ol><p>从执行顺序看，环绕通知相当于过滤器（可以改变目标方法的返回值，后置通知接收环绕通知修改的返回值）。</p><h4 id="XML-配置"><a href="#XML-配置" class="headerlink" title="XML 配置"></a>XML 配置</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"show"</span> <span class="attr">class</span>=<span class="string">"top.zero3737.spring.Show"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"logBefore"</span> <span class="attr">class</span>=<span class="string">"top.zero3737.spring.LogBefore"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(public * *(..))"</span> <span class="attr">id</span>=<span class="string">"showName"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"logBefore"</span> <span class="attr">pointcut-ref</span>=<span class="string">"showName"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Show 为被切入类。</li><li>LogBefore 为通知类。</li><li>aop:pointcut 标签声明切入点。<ul><li>expression 属性定义 execution 表达式。</li><li>execution 表达式筛选连接点。</li><li>id 属性为 aop:pointcut 标签定义唯一标识。</li></ul></li><li>aop:advisor 标签将通知类和 execution 表达式连接起来，而 execution 表达式筛选切点。<ul><li>advice-ref 属性引用通知类。</li><li>pointcut-ref 属性引用 aop:pointcut 标签（execution 表达式）。</li></ul></li></ul><h3 id="基于注解实现-AOP"><a href="#基于注解实现-AOP" class="headerlink" title="基于注解实现 AOP"></a>基于注解实现 AOP</h3><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p>开启注解对 AOP 的支持（声明自动为 IOC 容器中那些配置 @aspectJ 切面的 bean 创建代理，织入切面）。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="注解-5"><a href="#注解-5" class="headerlink" title="注解"></a>注解</h4><p>@Aspect 声明该类是一个通知类（需要将通知类纳入 IOC 容器）。</p><p>@Before(“execution 表达式”) 声明该方法是前置通知。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogBefore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义切点</span></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"execution(* top.zero3737.spring.Show.showName(String))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 前置通知方法逻辑...</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>before 方法名字可自定义。</li></ul><p>@AfterReturning(“execution 表达式”) 声明该方法是后置通知。</p><p>@AfterThrowing(“execution 表达式”) 声明异常通知。</p><ul><li><p>可以通过 throwing 指定异常参数。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterThrowing</span>(pointcut=<span class="string">"execution(* top.zero3737.spring.Show.showName(String))"</span>, throwing=<span class="string">"exception"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(JoinPoint joinPoint, Exception exception)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 异常通知...</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>throwing 指定变量名为 exception 为异常类。</li><li>exception 会捕获相同类型的异常。</li></ul></li></ul><p>@After(“execution 表达式”) 声明最终通知。</p><p>@Around(“execution 表达式”) 声明环绕通知。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around</span>(<span class="string">"execution(* top.zero3737.spring.Show.showName(String))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 前置通知...</span></span><br><span class="line">        </span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 后置通知...</span></span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 异常通知...</span></span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 最终通知...</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="获取目标对象信息"><a href="#获取目标对象信息" class="headerlink" title="获取目标对象信息"></a>获取目标对象信息</h4><p>前置、后置、异常通知通过 JoinPoint 对象获取。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义切点</span></span><br><span class="line"><span class="meta">@AfterReturning</span>(pointcut=<span class="string">"execution(* top.zero3737.spring.Show.showName(String))"</span>, returning=<span class="string">"returningVaule"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">(JoinPoint joinPoint, Object returningVaule)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 后置通知方法逻辑...</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>returning 属性指定一个形参名，用于表示通知方法中相同形参名的参数为返回值。</li><li>joinPoint.getTarget() 获取目标对象。</li><li>joinPoint.getSignature().getName() 获取切入点的方法名。</li><li>joinPoint.getArgs().length 获取切入点的参数个数。</li></ul><p>环绕通知通过 ProceedingJoinPoint 对象获取。</p><h3 id="基于-XML-实现-AOP"><a href="#基于-XML-实现-AOP" class="headerlink" title="基于 XML 实现 AOP"></a>基于 XML 实现 AOP</h3><h4 id="通知类"><a href="#通知类" class="headerlink" title="通知类"></a>通知类</h4><p>需要通过 XML 配置将 LogAspect 类指定为通知类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showBeginLog</span><span class="params">(JoinPoint joinPoint)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"AOP日志开始"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showReturnLog</span><span class="params">(JoinPoint joinPoint, Object result)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"AOP方法返回"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showExceptionLog</span><span class="params">(JoinPoint joinPoint, NullPointerException ex)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"AOP方法异常"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showAfterLog</span><span class="params">(JoinPoint joinPoint)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"AOP方法结束"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 前置通知...</span></span><br><span class="line">            </span><br><span class="line">            proceedingJoinPoint.proceed();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 后置通知...</span></span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 异常通知...</span></span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 最终通知...</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="XML-配置-1"><a href="#XML-配置-1" class="headerlink" title="XML 配置"></a>XML 配置</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"logAspect"</span> <span class="attr">class</span>=<span class="string">"com.neuedu.aop.proxy.LogAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"calculator"</span> <span class="attr">class</span>=<span class="string">"com.neuedu.aop.target.MathCalculatorImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- 配置AOP,需要导入AOP名称空间 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 声明切入点表达式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.neuedu.aop.target.MathCalculatorImpl.*(..))"</span> <span class="attr">id</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置日志切面类,引用前面的类 ,通过order属性控制优先级--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"logAspect"</span> <span class="attr">order</span>=<span class="string">"25"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 通过method属性指定切面类的切面方法，通过pointcut-ref指定切入点表达式 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 前置通知 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"showBeginLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 最终通知 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"showAfterLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 异常通知 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"showExceptionLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span> <span class="attr">throwing</span>=<span class="string">"ex"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 后置通知 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">"showReturnLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span> <span class="attr">returning</span>=<span class="string">"result"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 环绕通知 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">"around"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>MathCalculatorImpl 类为被切入类。</li><li>logAspect 类为通知类。</li><li>pointcut-ref 属性引用 execution 表达式。</li><li>throwing 指定 showExceptionLog 方法中形参变量名为 ex 为异常。</li><li>returning 指定 showReturnLog 方法中形参变量名为 result 为返回值。</li></ul><h2 id="Spring-整合事务"><a href="#Spring-整合事务" class="headerlink" title="Spring 整合事务"></a>Spring 整合事务</h2><h3 id="Maven-依赖-9"><a href="#Maven-依赖-9" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><p>spring-jdbc 依赖与 spring-tx，所以直接引用 spring-jdbc 包。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-tx --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>spring-tx 是事务相关 jar 包。</li><li>spring-jdbc 是操作数据库相关的 jar 包。</li></ul><h3 id="XML-配置-2"><a href="#XML-配置-2" class="headerlink" title="XML 配置"></a>XML 配置</h3><ol><li><p>添加事务命名空间。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xmlns:tx="http://www.springframework.org/schema/tx"</span><br><span class="line">xsi:schemaLocation=http://www.springframework.org/schema/tx</span><br><span class="line">http://www.springframework.org/schema/tx/spring-tx.xsd</span><br></pre></td></tr></table></figure></li><li><p>配置数据源。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp2.BasicDataSource"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/database?useUnicode=true&amp;amp;characterEncoding=utf-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userName"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>配置事务管理器 transactionManager。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>DataSourceTransactionManager 类需要引用数据源。</li><li>DataSourceTransactionManager 类在 spring-jdbc 包中。</li><li>DataSourceTransactionManager 为 JDBC 事务。</li><li>org.springframework.orm.hibernate3.HibernateTransactionManager 为 Hibernate 事务。</li><li>org.springframework.orm.jpa.JpaTransactionManager 为 JPA 事务。</li></ul></li></ol><h3 id="声明式事务"><a href="#声明式事务" class="headerlink" title="声明式事务"></a>声明式事务</h3><h4 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h4><ul><li>Spring 并不直接管理事务，而是提供了多种事务管理器，他们将事务管理的职责委托给 Hibernate 或者 JTA 等持久化机制所提供的相关平台框架的事务来实现。</li><li>声明式事务管理建立在 AOP 之上。其本质是对方法前后进行拦截，然后在目标方法开始之前创建或者加入一个事务，在执行完目标方法之后根据执行情况提交或者回滚事务。</li><li>事务传播行为：<ol><li>事务传播行为是 Spring 框架独有的事务增强特性，他不属于的事务实际提供方数据库行为。</li><li>事务传播行为用来描述由某一个事务传播行为修饰的方法被嵌套进另一个方法的时事务如何传播。</li></ol></li></ul><h4 id="基于-XML"><a href="#基于-XML" class="headerlink" title="基于 XML"></a>基于 XML</h4><ol><li><p>增加对事务的支持：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通知 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">           <span class="comment">&lt;!-- 根据方法名指定事务的属性 --&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"save*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"insert*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"create*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"delete*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"find*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"select*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>引用 transactionManager 事务管理器。</li></ul></li><li><p>定义切面：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置事务切入点, 以及把事务切入点和事务属性关联起来 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.taotao.service.*.*(..))"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>service 层在方法中抛异常即可事务回滚，千万不要捕获（就算在 controller 层也直接往上抛）。</p><img src="178.png" width="50%"></li></ol><h4 id="基于注解"><a href="#基于注解" class="headerlink" title="基于注解"></a>基于注解</h4><ol><li><p>增加对事务注解（@Transactional）的支持：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span> /&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>在方法上通过注解 @Transactional 声明该方法为事务。</p><img src="177.png" width="60%"><ul><li>@Transactional 注解如果不配置 rollbackFor 属性，那么事物只会在遇到 RuntimeException 的时候才会回滚。</li><li>readonly 并不是所有数据库都支持的，不同的数据库下会有不同的结果。<ul><li>mysql 支持 readOnly，设置为 true 时，只能查询，若增删改会异常。</li><li>oracle 不支持 readOnly，readOnly 属性是 true 还是 false 均不影响 SQL 的增删改查。</li></ul></li></ul></li></ol><h2 id="Spring-整合-JDBC"><a href="#Spring-整合-JDBC" class="headerlink" title="Spring 整合 JDBC"></a>Spring 整合 JDBC</h2><h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><img src="189.png" width="60%"><h3 id="使用-8"><a href="#使用-8" class="headerlink" title="使用"></a>使用</h3><p>插入 SQL 语句：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FindData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    jdbcTemplate.update(<span class="string">"insert ssm_user SET username='姚明', password='25', id=233;"</span>);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过占位符：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UpdataData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> update = jdbcTemplate.update(<span class="string">"insert ssm_user ( username, password ) VALUES (?, ?);"</span>, <span class="string">"zs"</span>, <span class="number">123456</span>);</span><br><span class="line">    System.out.println(update);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>指定对象查询一条记录：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FindData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String sql = <span class="string">"select * from ssm_user where id = ?;"</span>;</span><br><span class="line">    Object[] objects = &#123;<span class="number">1</span>&#125;;</span><br><span class="line">    User queryForObject = jdbcTemplate.queryForObject(sql, objects, <span class="keyword">new</span> BeanPropertyRowMapper&lt;SsmUser&gt;(User.class));</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>只能返回单条记录，多条记录将报错。</li></ul><p>不指定对象查询一条记录：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FindDataWithMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String sql = <span class="string">"select * from ssm_user where id = ?;"</span>;</span><br><span class="line">    Map&lt;String, Object&gt; queryForMap = jdbcTemplate.queryForMap(sql, <span class="number">1</span>);</span><br><span class="line">    System.out.println(queryForMap);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>也只能查询一条记录，返回多条记录会报错。</li></ul><p>指定对象对象查询多条记录：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FindDataWithBeanForList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String sql = <span class="string">"select * from ssm_user where id &gt; ?;"</span>;</span><br><span class="line">    Object[] object = &#123;<span class="number">10</span>&#125;;</span><br><span class="line">    List&lt;User&gt; query = jdbcTemplate.query(sql, object, <span class="keyword">new</span> BeanPropertyRowMapper&lt;User&gt;(User.class));</span><br><span class="line">    <span class="keyword">for</span> (User user : query) &#123;</span><br><span class="line">        </span><br><span class="line">        System.out.println(user);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不指定对象对象查询多条记录：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FindDataWithMapForList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String sql = <span class="string">"select * from ssm_user where id &gt; ?;"</span>;</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; queryForList = jdbcTemplate.queryForList(sql, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; user : queryForList) &#123;</span><br><span class="line">        </span><br><span class="line">        System.out.println(user);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过 SQL 函数返回 String 类型：</p><img src="190.png" width="60%"><p>通过 SQL 函数返回 int 类型：</p><img src="191.png" width="60%"><h2 id="Spring-整合-MyBatis"><a href="#Spring-整合-MyBatis" class="headerlink" title="Spring 整合 MyBatis"></a>Spring 整合 MyBatis</h2><h3 id="Maven-依赖-10"><a href="#Maven-依赖-10" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h3><p>db.properties 配置。</p><img src="5.png" width="50%"><p>PreferencesPlaceholderConfigurer 类可以加载 db.properties 文件（applicationContext.xml）。</p><img src="4.png" width="80%"><p>配置数据库信息（applicationContext.xml）。</p><img src="6.png" width="80%"><p>mybatis 配置文件：</p><img src="8.png" width="80%"><ul><li>加载 mapper 文件。</li></ul><p>SqlSessionFactory 交给 Spring 管理并配置 SqlSessionFactory（applicationContext.xml）。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 将 sqlSessionFactory 交个 Spring 管理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载 mapper.xml 文件 --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>top/zero3737/dao/*.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 批量定义别名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"top.zero3737.entity"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载 mybatis 配置文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="使用-9"><a href="#使用-9" class="headerlink" title="使用"></a>使用</h3><p>项目结构。</p><img src="9.png" width="20%"> <img src="10.png" width="20%"><p>mapper 文件</p><img src="17.png" width="80%"><p>StudentMapper 接口。</p><img src="12.png" width="80%"><p>继承 SqlSessionDaoSupport 类和实现 StudentMapper 接口。</p><img src="11.png" width="80%"><p>Service 层调用 dao 层方法。</p><img src="13.png" width="80%"> <img src="14.png" width="80%"><p>applicationContext.xml 中将 StudentServiceImpl 和 StudentDaoImpl 注入 IOC 容器中。</p><img src="15.png" width="80%"><ul><li><p>StudentServiceImpl 是 Service 层方法，调用 dao 层方法。</p></li><li><p>SqlSessionDaoSupport 类有一个 SqlSessionFactory 属性需要注入。</p></li></ul><p>主程序读取 applicationContext.xml 文件通过 StudentService 对象操作数据库。</p><img src="16.png" width="80%"><h3 id="基于动态代理方式-CRUD-整合配置"><a href="#基于动态代理方式-CRUD-整合配置" class="headerlink" title="基于动态代理方式 CRUD 整合配置"></a>基于动态代理方式 CRUD 整合配置</h3><p>通过 mybatis-spring.jar 中的 SqlSessionFactoryBean 类生成动态代理对象。</p><img src="18.png" width="80%"><ul><li>缺点每个 mapper 都需要手动配置一次。</li></ul><p>通过 mybatis-spring.jar 中的 MapperScannerConfigurer 类将批量生成动态代理对象。</p><img src="19.png" width="80%"><ul><li>basePackage 指定 mapper 接口所在的包。</li><li>约定：Spring 动态代理对象为接口名首字母小写，例如：studentMapper 对应接口名 StudentMapper。</li></ul><h2 id="Spring-整合-Web"><a href="#Spring-整合-Web" class="headerlink" title="Spring 整合 Web"></a>Spring 整合 Web</h2><h3 id="Maven-依赖-11"><a href="#Maven-依赖-11" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>没有 Tomcat 环境，只能通过读取 IOC 配置文件获取实例。</li><li>bean 对象保存在 IOC 容器中，但是客户端发送请求 Tomcat 访问的是 Servlet 容器。</li><li>解决多个 Servlet 入口函数不统一，Spring 需要初始化配置文件（每个 Servlet 执行就初始化配置文件将消耗性能）。</li><li>Tomcat 启动首先读取配置文件，初始化 IOC 容器，该步骤通过监听器实现（Tomcat 启动自动调用监听器方法初始化配置文件）。</li></ul><h3 id="配置-2"><a href="#配置-2" class="headerlink" title="配置"></a>配置</h3><ol><li><p>在 web.xml 文件中配置 Listener。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Spring 提供 ServletContextListener 的一个实现类 ContextLoaderListener ，该类可以作为 listener 使用，它会在创建时自动加载 WEB-INF 目录下的 applicationContext.xml 文件。</li></ul></li><li><p>Spring 会读取 contextConfigLocation 参数去加载所有逗号分隔的 xml 文件。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-context.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>如果没有这个参数，Spring 默认加载 WEB-INF/applicationContext.xml 文件。</li></ul></li><li><p>读取多个 Spring 配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span></span><br><span class="line">        classpath:contextConfigLocation.xml,</span><br><span class="line">        classpath:contextConfigLocation-Dao.xml,</span><br><span class="line">        classpath:contextConfigLocation-Service.xml,</span><br><span class="line">        classpath:contextConfigLocation-Controller.xml</span><br><span class="line">    <span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 可简写 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span></span><br><span class="line">        classpath:contextConfigLocation.xml,</span><br><span class="line">        classpath:contextConfigLocation-*.xml</span><br><span class="line">    <span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="使用-10"><a href="#使用-10" class="headerlink" title="使用"></a>使用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/fist"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Servlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        ApplicationContext applicationContext = WebApplicationContextUtils.getWebApplicationContext(req.getServletContext());</span><br><span class="line">        Service service = applicationContext.getBean(<span class="string">"service"</span>, Service.class);</span><br><span class="line">        service.insert();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>WebApplicationContextUtils 类在 spring-web 包中定义。</li><li>ServletContext 对象全局唯一，而且工程内部的所有 Servlet 都共享这个对象。</li></ul><h2 id="Spring-内置工具类"><a href="#Spring-内置工具类" class="headerlink" title="Spring 内置工具类"></a>Spring 内置工具类</h2><h3 id="MD5-加密"><a href="#MD5-加密" class="headerlink" title="MD5 加密"></a>MD5 加密</h3><h4 id="MD5-介绍"><a href="#MD5-介绍" class="headerlink" title="MD5 介绍"></a>MD5 介绍</h4><p>MD5 是信息摘要算法，不可以逆向解密。</p><h4 id="DigestUtils-类-API-介绍"><a href="#DigestUtils-类-API-介绍" class="headerlink" title="DigestUtils 类 API 介绍"></a>DigestUtils 类 API 介绍</h4><table><thead><tr><th align="left">DigestUtils 类中的 API</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">byte[] md5Digest(byte[] bytes)</td><td align="left">返回 MD5 生成 128 位的 byte 数组。</td></tr><tr><td align="left">String md5DigestAsHex(byte[] bytes)</td><td align="left">返回将 MD5 生成 128 位的 byte 数组转为 32 位的 16 进制。</td></tr></tbody></table><h4 id="使用-11"><a href="#使用-11" class="headerlink" title="使用"></a>使用</h4><ol><li><p>导包：<code>import org.springframework.util.DigestUtils;</code></p></li><li><p>加密代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String md5DigestAsHex = DigestUtils.md5DigestAsHex(<span class="string">"123"</span>.getBytes());</span><br><span class="line">System.out.println(md5DigestAsHex);</span><br></pre></td></tr></table></figure></li></ol><h1 id="Spring-MVC"><a href="#Spring-MVC" class="headerlink" title="Spring MVC"></a>Spring MVC</h1><h2 id="入门案例-2"><a href="#入门案例-2" class="headerlink" title="入门案例"></a>入门案例</h2><h3 id="Maven-依赖-12"><a href="#Maven-依赖-12" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><p>spring-webmvc 依赖与 spring-context 和 spring-web。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="配置-3"><a href="#配置-3" class="headerlink" title="配置"></a>配置</h3><p>web.xml 配置：</p><img src="101.png" width="80%"> <img src="100.png" width="80%"><ul><li>此例中 <code>/WEB-INF/springDispatcherServlet-servlet.xml</code> 为 spring 配置文件的默认路径。</li><li>servlet-name 的值修改为 AAA，spring 配置文件默认路径为 <code>/WEB-INF/AAA-servlet.xml</code>。</li><li>如果不使用 Spring 配置文件默认地址，需要通过配置 contextConfigLocation 参数额外指定Spring 文件的路径。</li><li>DispatcherServlet 是前置控制器，拦截匹配的请求，Servlet 拦截匹配规则要自己定义，把拦截下来的请求，依据相应的规则分发到目标 Controller 来处理，是配置 Spring MVC 的第一步。</li></ul><h3 id="使用-12"><a href="#使用-12" class="headerlink" title="使用"></a>使用</h3><p>applicationContext.xml 中配置视图解析器：</p><img src="103.png" width="80%"><ul><li>InternalResourceViewResolver 为视图解析器。</li><li>prefix 前缀，suffix 后缀，自定拼接成 <code>/views/success.jsp</code>，实现页面跳转。</li></ul><p>跳转页面：</p><img src="102.png" width="80%"><ul><li>@RequestMapper 声明拦截指定请求接口。</li></ul><h2 id="指定请求接口-RequestMapper"><a href="#指定请求接口-RequestMapper" class="headerlink" title="指定请求接口@RequestMapper"></a>指定请求接口@RequestMapper</h2><p>声明请求类型：</p><img src="104.png" width="80%"><ul><li>@RequestMapper 嵌套，请求路径为 <code>handler/welcome</code></li><li>params 为指定请求参数。</li></ul><p>指定请求参数的值（不符合则不拦截）：</p><img src="105.png" width="80%"><ul><li><code>!height</code> 请求时候不能包含该参数。</li></ul><p>约定请求头信息：</p><img src="106.png" width="80%"><p>返回 UTF-8 字符编码数字</p><p><code>@RequestMapping(value=&quot;/cat/query&quot;,produces=&quot;text/html;charset=utf-8&quot;)</code>，前面是请求的路径，后面是编码格式。</p><h2 id="获取请求参数"><a href="#获取请求参数" class="headerlink" title="获取请求参数"></a>获取请求参数</h2><h3 id="RequestParam"><a href="#RequestParam" class="headerlink" title="@RequestParam"></a>@RequestParam</h3><h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h4><p>默认前端的请求参数和后端的接收参数名字相同，则自动赋值。</p><ul><li>前端 name=id，后端 String id 接收，前端发送请求，后端 id 自动赋值。</li></ul><p>用来处理 Content-Type: 为 application/x-www-form-urlencoded 编码的内容，提交方式 GET、POST。</p><h4 id="使用-13"><a href="#使用-13" class="headerlink" title="使用"></a>使用</h4><p>前端：</p><img src="142.png" width="80%"><p>后端：</p><img src="143.png" width="80%"><p>参数说明：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestParam</span>(value = <span class="string">"page"</span>, required = <span class="keyword">false</span>, defaultValue = <span class="string">"1"</span>)</span><br></pre></td></tr></table></figure><ul><li>required 声明前端该参数是否为必须。</li><li>defaultValue 前端没有传递参数，指定默认值。</li></ul><h3 id="RequestBody"><a href="#RequestBody" class="headerlink" title="@RequestBody"></a>@RequestBody</h3><p>该注解常用来处理 Content-Type: 不是 <code>application/x-www-form-urlencoded</code> 编码的内容，例如 application/json, application/xml 等。</p><ul><li>axios 发送 post 请求用 @RequestParam 注解后台接受不了数据，必须用 @RequestBody 才能接受数据。</li></ul><p>在参数左边直接打上参数即可使用。</p><h2 id="页面跳转（不通过-RequestMapper）"><a href="#页面跳转（不通过-RequestMapper）" class="headerlink" title="页面跳转（不通过 @RequestMapper）"></a>页面跳转（不通过 @RequestMapper）</h2><img src="131.png" width="80%"> <img src="132.png" width="80%"><h2 id="视图解析器"><a href="#视图解析器" class="headerlink" title="视图解析器"></a>视图解析器</h2><img src="130.png" width="80%"><ul><li>Spring MVC 中 Controller 层最终返回值为 ModelAndView。</li><li>经过视图解析器返回 jsp 或 html 页面。</li></ul><h2 id="RESTful-风格"><a href="#RESTful-风格" class="headerlink" title="RESTful 风格"></a>RESTful 风格</h2><img src="108.png" width="80%"> <img src="110.png" width="80%"> <img src="109.png" width="80%"><ul><li>通过过滤器增加 DELETE 和 PUT 请求。</li></ul><h3 id="获取路径中的参数-PathVariable"><a href="#获取路径中的参数-PathVariable" class="headerlink" title="获取路径中的参数@PathVariable"></a>获取路径中的参数@PathVariable</h3><p>获取参数：</p><img src="129.png" width="80%"> <img src="107.png" width="80%"><ul><li><code>name=z3</code> 自动赋值。</li></ul><h3 id="增加-DELETE-和-PUT-请求的支持"><a href="#增加-DELETE-和-PUT-请求的支持" class="headerlink" title="增加 DELETE 和 PUT 请求的支持"></a>增加 DELETE 和 PUT 请求的支持</h3><p>spring-web.jar HiddenHttpMethodFilter</p><img src="111.png" width="80%"><h3 id="Spring-MVC-约定"><a href="#Spring-MVC-约定" class="headerlink" title="Spring MVC 约定"></a>Spring MVC 约定</h3><img src="112.png" width="80%"><h3 id="使用-14"><a href="#使用-14" class="headerlink" title="使用"></a>使用</h3><p>前端：</p><img src="113.png" width="80%"><p>后端：</p><img src="114.png" width="80%"><h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><h3 id="概念-3"><a href="#概念-3" class="headerlink" title="概念"></a>概念</h3><img src="117.png" width="80%"><p>ModelAndView:</p><img src="118.png" width="80%"><p>ModelMap:</p><img src="119.png" width="80%"><p>Model:</p><img src="120.png" width="80%"><p>Map:</p><img src="121.png" width="80%"><ul><li>Map 为原生的储存键值的对象，自然的里面一大堆的方法可以使用；</li><li>​Model 只有寥寥几个方法只适合用于储存数据，简化了新手对于Model对象的操作和理解；</li><li>​ModelMap 继承了 LinkedMap ，除了实现了自身的一些方法，同样的继承 LinkedMap 的方法和特性；</li><li>​ModelAndView 可以在储存数据的同时，可以进行设置返回的逻辑视图，进行控制展示层的跳转；</li></ul><h3 id="存-Session"><a href="#存-Session" class="headerlink" title="存 Session"></a>存 Session</h3><p>后端：</p><img src="115.png" width="80%"><p>注解：</p><img src="116.png" width="80%"><ul><li>@SessionAttributes 将指定 key 存入 Session 中。</li><li>type 为指定类型存入 Session。</li></ul><h2 id="将数据存入-Request-域中"><a href="#将数据存入-Request-域中" class="headerlink" title="将数据存入 Request 域中"></a>将数据存入 Request 域中</h2><img src="170.png" width="80%"> <img src="171.png" width="80%"> - Spring MVC 规定，为了看上去和 Servlet 没有任何关系。<h2 id="ModelAttribute"><a href="#ModelAttribute" class="headerlink" title="@ModelAttribute"></a>@ModelAttribute</h2><h3 id="概念-4"><a href="#概念-4" class="headerlink" title="概念"></a>概念</h3><img src="128.png" width="80%"><h3 id="使用-15"><a href="#使用-15" class="headerlink" title="使用"></a>使用</h3><p>前端：</p><img src="122.png" width="80%"><p>bean 对象：</p><img src="123.png" width="50%"><p>Controller 层：</p><img src="124.png" width="80%"> <img src="126.png" width="80%"> <img src="125.png" width="80%"><ul><li>map 的 key 为 student 对应 testModelAttribute 方法的形参 Student 类型（首字母小写）。</li><li>匹配成功则自动赋值。</li><li>关于 testModelAttribute 形参为 Student 对象：<ul><li>如果前端的 name 属性和 bean 对象的属性名字一样，则自动赋值。</li><li>前端发送请求参数 <code>id = 1</code>，bean 对象中存在 id 属性，则 bean 对象中的 id 属性自动赋值为 1。</li></ul></li></ul><p>map 的 key 和方法参数类型名字不一致（不按照约定）：</p><img src="127.png" width="80%"><h2 id="请求转发和重定向"><a href="#请求转发和重定向" class="headerlink" title="请求转发和重定向"></a>请求转发和重定向</h2><img src="134.png" width="80%"> <img src="133.png" width="80%"><ul><li>请求转发地址栏显示请求接口。</li><li>重定向显示返回页面。</li></ul><h2 id="访问静态资源"><a href="#访问静态资源" class="headerlink" title="访问静态资源"></a>访问静态资源</h2><p>Spring MVC 不会处理静态静态资源。</p><p>在 Spring MVC 配置文件中添加配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Servlet 处理静态资源 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br></pre></td></tr></table></figure><ul><li>静态资源交个 Servlet 处理。</li></ul><p>或在 Spring MVC 中添加资源映射：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/WEB-INF/css"</span> <span class="attr">mapping</span>=<span class="string">"/css/**"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/WEB-INF/js"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="类型转换器"><a href="#类型转换器" class="headerlink" title="类型转换器"></a>类型转换器</h2><p>Spring MVC 内置类型转换器：</p><img src="138.png" width="80%"><p>实现 Converter 接口：</p><img src="140.png" width="80%"><p>Spring MVC 配置：</p><img src="141.png" width="80%"><ul><li>Spring 规定所有的类型转换器必须纳入 ConversionServiceFactoryBean 中管理。</li><li>将 ConversionServiceFactoryBean bean 对象在 Spring MVC 中注册。</li></ul><h2 id="数据格式化"><a href="#数据格式化" class="headerlink" title="数据格式化"></a>数据格式化</h2><p>将 FormattingConversionServiceFactoryBean 纳入 IOC 容器：</p><img src="144.png" width="80%"><p>使用：</p><img src="145.png" width="80%"> - 将前端传递过来的数据固定为 yy-MM-dd（前端只能发送这种日期：1999-09-31）。 <img src="146.png" width="80%"><h2 id="返回json数据-ResponseBody"><a href="#返回json数据-ResponseBody" class="headerlink" title="返回json数据@ResponseBody"></a>返回json数据@ResponseBody</h2><h3 id="jackjson"><a href="#jackjson" class="headerlink" title="jackjson"></a>jackjson</h3><p>Spring 默认 json jar 包，@ResponseBody 注解的方法返回 bean 对象或 List 集合自动返回 json 对象给前端。</p><img src="160.png" width="80%"><h3 id="使用-16"><a href="#使用-16" class="headerlink" title="使用"></a>使用</h3><img src="158.png" width="80%"> <img src="159.png" width="80%"><ul><li>必须先支持返回 json 功能，返回值必须是 List 元素为 bean 对象或 bean 对象。</li></ul><h3 id="注意-4"><a href="#注意-4" class="headerlink" title="注意"></a>注意</h3><p>@ResponseBody 声明可以返回对象，Spirng MVC 会把接收到的对象转换成 String 类型。</p><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="Maven-依赖-13"><a href="#Maven-依赖-13" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><p>commons-io.jar</p><p>commons-fileupload.jar</p><h3 id="配置多部件解析器"><a href="#配置多部件解析器" class="headerlink" title="配置多部件解析器"></a>配置多部件解析器</h3><p>Spring 配置中将 CommonsMultipartResolver 纳入 IOC 容器。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件上传配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"-1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>defaultEncoding 指定默认编码。</li><li>maxUploadSize 指定上传文件大小（值为 -1 ，表示没有限制）。</li></ul><h3 id="使用-17"><a href="#使用-17" class="headerlink" title="使用"></a>使用</h3><p>前端：</p><img src="165.png" width="80%"><p>单文件上传：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">returnPageData</span><span class="params">(MultipartFile file)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取时间</span></span><br><span class="line">        SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat();</span><br><span class="line">        <span class="comment">// 时间格式化</span></span><br><span class="line">        sdf.applyPattern(<span class="string">"/yyyy/MM/dd"</span>);</span><br><span class="line">        String format = sdf.format(<span class="keyword">new</span> Date());</span><br><span class="line">        <span class="comment">// 获取输入流</span></span><br><span class="line">        InputStream inputStream = file.getInputStream();</span><br><span class="line">        <span class="comment">// 获取文件名</span></span><br><span class="line">        String originalFilename = file.getOriginalFilename();</span><br><span class="line">        <span class="comment">// 以时间戳作为文件名</span></span><br><span class="line">        String fileName = System.currentTimeMillis() + originalFilename.substring(originalFilename.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">        <span class="comment">// 获取保存路径</span></span><br><span class="line">        String realPath = ContextLoader.getCurrentWebApplicationContext().getServletContext().getRealPath(<span class="string">"/images"</span> + format);</span><br><span class="line">        File _file = <span class="keyword">new</span> File(realPath);</span><br><span class="line">        <span class="comment">// 文件路径不存在在创建</span></span><br><span class="line">        <span class="keyword">if</span>(!_file.exists()) &#123;</span><br><span class="line">            </span><br><span class="line">            _file.mkdirs();</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 获取输出流</span></span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(realPath + <span class="string">"/"</span> + fileName);</span><br><span class="line">        <span class="comment">// 保存文件</span></span><br><span class="line">        <span class="keyword">byte</span>[] bs = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> len = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ((len = inputStream.read(bs)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            </span><br><span class="line">            fileOutputStream.write(bs, <span class="number">0</span>, len);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 关闭输入输出流</span></span><br><span class="line">        fileOutputStream.close();</span><br><span class="line">        inputStream.close();</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        </span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>多文件上传：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">returnPageData</span><span class="params">(@RequestParam(<span class="string">"file"</span>)</span>MultipartFile[] files) </span>&#123;</span><br><span class="line">    </span><br><span class="line">    HashMap&lt;String, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (MultipartFile file : files) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 获取时间</span></span><br><span class="line">            SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat();</span><br><span class="line">            sdf.applyPattern(<span class="string">"/yyyy/MM/dd"</span>);</span><br><span class="line">            String format = sdf.format(<span class="keyword">new</span> Date());</span><br><span class="line">            <span class="comment">// 获取文件名</span></span><br><span class="line">            String originalFilename = file.getOriginalFilename();</span><br><span class="line">            <span class="comment">// 以时间戳作为文件名</span></span><br><span class="line">            String fileName = System.currentTimeMillis() + originalFilename.substring(originalFilename.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">            <span class="comment">// 获取保存路径</span></span><br><span class="line">            String realPath = ContextLoader.getCurrentWebApplicationContext().getServletContext().getRealPath(<span class="string">"/images"</span> + format);</span><br><span class="line">            File _file = <span class="keyword">new</span> File(realPath + <span class="string">"/"</span> + fileName);</span><br><span class="line">            <span class="comment">// 文件路径不存在在创建</span></span><br><span class="line">            <span class="keyword">if</span>(!_file.exists()) &#123;</span><br><span class="line">                </span><br><span class="line">                _file.mkdirs();</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 保存文件</span></span><br><span class="line">            file.transferTo(_file);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        hashMap.put(<span class="string">"msg"</span>, <span class="string">"上传成功"</span>);</span><br><span class="line">        hashMap.put(<span class="string">"code"</span>, <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        </span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        hashMap.put(<span class="string">"msg"</span>, <span class="string">"上传失败"</span>);</span><br><span class="line">        hashMap.put(<span class="string">"code"</span>, <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(hashMap);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><h3 id="概念-5"><a href="#概念-5" class="headerlink" title="概念"></a>概念</h3><p>HandlerInterceptor 接口中三个方法的区别：</p><img src="166.png" width="80%"><ul><li>preHandle 方法，该方法将在请求处理之前进行调用。</li><li>postHandle 方法，也就是 Controller 方法调用之后执行，但是它会在进行视图返回渲染之前被调用，所以我们可以在这个方法中对 Controller 处理之后的 ModelAndView 对象进行操作。postHandle 方法被调用的方向跟 preHandle 是相反的，也就是说先声明的 Interceptor 的 postHandle 方法反而会后执行。</li><li>渲染完毕过滤器中 afterCompletion 方法执行，多个拦截器时，最后一个过滤器的 afterCompletion 方法执行，其他过滤器的 afterCompletion 方法不会执行。</li></ul><h3 id="使用-18"><a href="#使用-18" class="headerlink" title="使用"></a>使用</h3><p>preHandle 返回值：</p><img src="167.png" width="80%"><h3 id="配置-4"><a href="#配置-4" class="headerlink" title="配置"></a>配置</h3><p>将拦截器纳入 IOC 容器中。</p><img src="168.jpg" width="80%"><ul><li>拦截器和过滤器匹配路径是 ant 风格，和 Servlet 不同。</li><li>除了 testUpload 拦截所有请求（取交集）。</li><li>bean 实例为拦截器实例。</li></ul><h2 id="Spring-容器和-Spring-MVC-容器关系"><a href="#Spring-容器和-Spring-MVC-容器关系" class="headerlink" title="Spring 容器和 Spring MVC 容器关系"></a>Spring 容器和 Spring MVC 容器关系</h2><p>Spring 是父容器，Spring MVC 是其子容器，子容器可以访问父容器的 bean，而父容器不能访问子容器的 bean。</p><h3 id="Spring-MVC-中的-API-接口为什么要纳入-IOC-中？"><a href="#Spring-MVC-中的-API-接口为什么要纳入-IOC-中？" class="headerlink" title="Spring MVC 中的 API 接口为什么要纳入 IOC 中？"></a>Spring MVC 中的 API 接口为什么要纳入 IOC 中？</h3><p>接收请求是 Servlet 容器中的 Servlet 接收请求，web.xml 这个容器加载的 Spring MVC 容器，所以要纳入 IOC 容器才能处理请求。</p><h2 id="Spring-整合-Spring-MVC"><a href="#Spring-整合-Spring-MVC" class="headerlink" title="Spring 整合 Spring MVC"></a>Spring 整合 Spring MVC</h2><p>概念：</p><img src="168.png" width="80%"><p>web.xml 使用 Spring MVC 拦截所有请求：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 加载 Spring MVC 前端控制器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springDispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springDispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>applicationContext-servlet.xml 配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">&lt;!-- 配置注解扫描器 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"top.zero3737.servlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 配置视图解析器 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">	   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".html"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- MVC 配置返回 json 数据以 UTF-8 方式编码 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span>  </span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"supportedMediaTypes"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">value</span>&gt;</span>text/html;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">					    <span class="tag">&lt;<span class="name">value</span>&gt;</span>application/json;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Servlet 处理静态资源 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span>	</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="字符过滤器"><a href="#字符过滤器" class="headerlink" title="字符过滤器"></a>字符过滤器</h3><p>解决返回前端中文乱码的问题，而且解决不用在每个 Servlet 接口指定编码。</p><h4 id="Maven-依赖-14"><a href="#Maven-依赖-14" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h4><p>spring-web.jar</p><h4 id="配置-5"><a href="#配置-5" class="headerlink" title="配置"></a>配置</h4><p>web.xml 配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置字符过滤器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span>   </span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--是否强制设置request的编码为encoding，默认false，不建议更改--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--是否强制设置response的编码为encoding，建议设置为true，下面有关于这个参数的解释--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h2><h3 id="概念-6"><a href="#概念-6" class="headerlink" title="概念"></a>概念</h3><p>序列化：序列化是将对象的状态信息转换为可以存储或传输的形式的过程。</p><p>反序列化：就是重新创建对象的过程。</p><h3 id="Maven-依赖-15"><a href="#Maven-依赖-15" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><p>fastjson.jar</p><h3 id="使用-19"><a href="#使用-19" class="headerlink" title="使用"></a>使用</h3><h4 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h4><p>bean 对象序列化：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setId(<span class="number">11L</span>);</span><br><span class="line">user.setName(<span class="string">"西安"</span>);</span><br><span class="line">user.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">String jsonString = JSON.toJSONString(user);</span><br></pre></td></tr></table></figure><p>list 序列化：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;SsmUser&gt; list = ssmUserService.findData(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">return</span> JSON.toJSONString(list);</span><br></pre></td></tr></table></figure><p>map 序列化：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;Object, Object&gt;();</span><br><span class="line">hashMap.put(<span class="string">"pageData"</span>, ssmUserService.findPageData(<span class="number">2</span>, <span class="number">2</span>));</span><br><span class="line">hashMap.put(<span class="string">"pageNum"</span>, ssmUserService.getPageNum());</span><br><span class="line">hashMap.put(<span class="string">"everyonePageSize"</span>, ssmUserService.getEveryonePageSize());</span><br><span class="line"><span class="keyword">return</span> JSON.toJSONString(hashMap);</span><br></pre></td></tr></table></figure><p>fastjosn 可以序列化任何对象。</p><h4 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h4><p>json 转换成 bean 对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String jsonString = <span class="string">"&#123;\"createTime\":\"2018-08-17 14:38:38\",\"id\":11,\"name\":\"西安\"&#125;"</span>;</span><br><span class="line">User user = JSON.parseObject(jsonString, User.class);</span><br></pre></td></tr></table></figure><p>json 转换成 map 对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String jsonString = <span class="string">"&#123;\"createTime\":\"2018-08-17 14:38:38\",\"id\":11,\"name\":\"西安\"&#125;"</span>;</span><br><span class="line">Map map = JSON.parseObject(jsonString, Map.class);</span><br></pre></td></tr></table></figure><h4 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h4><p>格式化：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setId(<span class="number">11L</span>);</span><br><span class="line">user.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">String jsonString = JSON.toJSONString(user, SerializerFeature.PrettyFormat, </span><br><span class="line">        SerializerFeature.WriteNullStringAsEmpty, SerializerFeature.UseSingleQuotes);</span><br></pre></td></tr></table></figure><ul><li><p>效果：</p><img src="1.webp" width="80%"></li></ul><h4 id="注解-6"><a href="#注解-6" class="headerlink" title="注解"></a>注解</h4><p>@JSONField 序列化 JSON 字符串可自定义 key 的名字。</p><p>作用在 get 和 set 方法上：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bean 转 json 时会把 bean 中的 name 转换为 project_name</span></span><br><span class="line"><span class="meta">@JSONField</span>(name=<span class="string">"project_name"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// son 转 bean 时会把 json 中的 project_name 值赋值给 name</span></span><br><span class="line"><span class="meta">@JSONField</span>(name=<span class="string">"project_name"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    name= name;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>序列化过滤属性：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JSONField</span>(serialize=<span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">private</span> String name;</span><br></pre></td></tr></table></figure><ul><li>序列化的时候 name 属性不会包含进 JSON 字符串。</li></ul><h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><p>如何返回下图的 JSON 数据？</p><img src="175.png" width="80%"><ul><li>思路：创建一个含有 total 属性和 rows 属性（row 属性为 List 类型）的对象。</li></ul><h1 id="Spring-Boot"><a href="#Spring-Boot" class="headerlink" title="Spring Boot"></a>Spring Boot</h1><h2 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h2><p>微服务架构是一种将单应用程序作为一套小型服务开发的方法，每种应用程序都在其自己的进程中运行，并与轻量级机制（通常是 HTTP 资源的 API）进行通信。</p><p>这些服务是围绕业务功能构建的，可以通过全自动部署机制进行独立部署。</p><h2 id="构建-Spring-Boot-项目"><a href="#构建-Spring-Boot-项目" class="headerlink" title="构建 Spring Boot 项目"></a>构建 Spring Boot 项目</h2><p>通过 Spring Initialize 构建 Spring Boot 项目。</p><p>进入 <a href="https://start.spring.io/" target="_blank" rel="noopener">Spring Initialize 官网</a> 可快速构建 Spinrg Boot 项目。</p><h3 id="resources-目录文件说明"><a href="#resources-目录文件说明" class="headerlink" title="resources 目录文件说明"></a>resources 目录文件说明</h3><ol><li>static 目录：存放静态资源（js、css、图片、音频、视频）。</li><li>templates 目录：存放模板文件（freemark、thymeleaf 和 jsp 文件）。</li><li>application.properties 为 spring boot 配置文件。</li></ol><h3 id="application-配置文件默认存放路径"><a href="#application-配置文件默认存放路径" class="headerlink" title="application 配置文件默认存放路径"></a>application 配置文件默认存放路径</h3><ol><li>项目根目录下。</li><li>项目根目录中 config 目录下。</li><li>项目的 resources 目录下。</li><li>项目 resources 目录中 config 目录下。</li></ol><h2 id="依赖包"><a href="#依赖包" class="headerlink" title="依赖包"></a>依赖包</h2><h3 id="spring-boot-starter-web"><a href="#spring-boot-starter-web" class="headerlink" title="spring-boot-starter-web"></a>spring-boot-starter-web</h3><p>包含 web 开发经常使用的 jar 包，例如：json、 tomcat 等。</p><h3 id="spring-boot-configuration-processor"><a href="#spring-boot-configuration-processor" class="headerlink" title="spring-boot-configuration-processor"></a>spring-boot-configuration-processor</h3><p>spring 默认使用 yml 中的配置，但有时候要用传统的 xml 或 properties 配置，就需要使用 spring-boot-configuration-processor 了。</p><h3 id="mybatis-spring-boot-starter"><a href="#mybatis-spring-boot-starter" class="headerlink" title="mybatis-spring-boot-starter"></a>mybatis-spring-boot-starter</h3><p>spring boot 整合 mybatis</p><h2 id="application-properties-配置"><a href="#application-properties-配置" class="headerlink" title="application.properties 配置"></a>application.properties 配置</h2><h3 id="配置选项"><a href="#配置选项" class="headerlink" title="配置选项"></a>配置选项</h3><table><thead><tr><th align="left">选项</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">server.port</td><td align="left">修改端口号</td></tr><tr><td align="left">spring.http.encoding.charset</td><td align="left">修改请求响应编码</td></tr><tr><td align="left">debug</td><td align="left">true 开启 debug 模式</td></tr><tr><td align="left">spring.profiles.active</td><td align="left">指定开发环境</td></tr><tr><td align="left">server.servlet.context-path</td><td align="left">指定项目名字</td></tr></tbody></table><h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><p><code>server.port = 8888</code> 修改 Tomcat 端口号为 8888。</p><p><code>spring.http.encoding.charset = ISO-8859-1</code> 将默认 UTF-8 编码改成 ISO-8859-1。</p><p><code>debug = true</code> 开启 debug 模式：</p><ol><li>Positive matches 为 Spring Boot 已经开启的服务列表。</li><li>Negative matches 为 Spring Boot 自带而没有开启的服务列表。</li></ol><p><code>spring.profiles.active = dev</code> 指定 application-dev.properties 环境。</p><p><code>server.servlet.context-path = /boot</code> 访问 URL 为 <code>http://localhost:8080/boot/接口名</code></p><h2 id="application-yml-配置"><a href="#application-yml-配置" class="headerlink" title="application.yml 配置"></a>application.yml 配置</h2><p>Spring Boot 提供 yml 文件配置。</p><p>yml 文件缩写为 YAML，YAML 不是一种标记语言。</p><h3 id="语法规则"><a href="#语法规则" class="headerlink" title="语法规则"></a>语法规则</h3><ol><li>通过垂直对齐指定父子关系。</li><li>冒号后面必须留有一个空格。</li><li>双引号支持转义字符，单引号或不写引号不支持转义字符。</li><li><code>#</code> 号为注释。</li><li>Set、 List 或数组行内写法用 <code>[v1, v2]</code> 表示，其中 <code>[]</code> 可以省略。</li><li>对象、 Map 用 <code>{k1: v1, k2: v2}</code> 表示。</li><li>同一列 <code>-</code> 构成数组（Set 或 List）。</li><li>驼峰写法和松散写法可以互相转换。</li><li>通过 <code>${前缀.属性}</code> 引用变量值，通过 <code>${前缀.属性:默认值}</code> 指定默认值。</li></ol><h3 id="指定开发环境"><a href="#指定开发环境" class="headerlink" title="指定开发环境"></a>指定开发环境</h3><ol><li><p>使用 dev 开发配置：</p><img src="203.png" width="20%"><ul><li>默认配置 Tomcat 端口号为 8883，dev 配置 Tomcat 端口号为 8884。</li><li>properties 优先级高于 yml 文件。</li></ul></li></ol><h2 id="随机占位符"><a href="#随机占位符" class="headerlink" title="随机占位符"></a>随机占位符</h2><img src="202.png" width="80%"><h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><p>Spring Boot 默认选用 slf4j 和 logback 框架。</p><h3 id="日志级别-1"><a href="#日志级别-1" class="headerlink" title="日志级别"></a>日志级别</h3><p>TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; OFF</p><p>Spring Boot 会默认打印 INFO 及以上的日志信息。</p><h3 id="使用-20"><a href="#使用-20" class="headerlink" title="使用"></a>使用</h3><ol><li><p>实例化 logger 对象：</p><img src="204.png" width="80%"></li><li><p>打印日志：</p><img src="205.png" width="80%"></li></ol><h3 id="日志配置"><a href="#日志配置" class="headerlink" title="日志配置"></a>日志配置</h3><p>通过配置 properties 文件：</p><ol><li>设置日志级别：<code>loggin.level.包名 = WARN</code></li><li>保存日志文件，默认保存项目根目录（可以指定绝对路径）：<code>loggin.file = springboot.log</code></li><li>保存日志文件到文件夹（默认名字为 spring.log）：<code>loggin.path = D:/log/</code></li><li>设置控制台日志输出格式：<code>logging.pattern.console</code></li><li>设置日志文件的输出格式：<code>logging.pattern.file</code></li></ol><h2 id="Web-开发"><a href="#Web-开发" class="headerlink" title="Web 开发"></a>Web 开发</h2><ol><li>Spring Boot 默认约定类路径下的 resource、static 和 public 文件夹可以存放静态资源。</li><li>Spring Boot 内置 Tomcat 不支持 JSP 开发。</li><li>Spring Boot 使用外置 Tomcat 时，构建 Spring Boot 时选择 war 工程。<ul><li>spring-boot-starter-tomcat 打包时默认排除（内置 Tomcat）。</li><li>main 目录下创建 webapp 目录，和普通 Web 项目类似。</li><li>war 工程的 ServletInitializer 类在 Tomcat 启动时（监听器）启动主程序。</li></ul></li></ol><h2 id="集成-MyBatis"><a href="#集成-MyBatis" class="headerlink" title="集成 MyBatis"></a>集成 MyBatis</h2><h3 id="依赖包-1"><a href="#依赖包-1" class="headerlink" title="依赖包"></a>依赖包</h3><p>spring-boot-starter-web.jar</p><p>mybatis-spring-boot-starter.jar</p><p>mysql-connector-java.jar</p><p>druid.jar</p><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>mybatis 的配置为可选配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8888</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql:///test?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="string">MyNewPass4!</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="comment"># pojo 类定义别名</span></span><br><span class="line"><span class="attr">  type-aliases-package:</span> <span class="string">com.example.demo1.model</span></span><br><span class="line">  <span class="comment"># 扫描 xml 文件</span></span><br><span class="line"><span class="attr">  mapper-locations:</span></span><br><span class="line"><span class="attr">    - classpath:</span><span class="string">com/example/demo1/dao/*.xml</span></span><br></pre></td></tr></table></figure><h3 id="启动类"><a href="#启动类" class="headerlink" title="启动类"></a>启动类</h3><p>@MapperScan 注解扫描 mapper 接口批量动态生成动态代理对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"top.zero3737.mapper.dao"</span>)</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        SpringApplication.run(MapperApplication.class, args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="注解-7"><a href="#注解-7" class="headerlink" title="注解"></a>注解</h2><h3 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h3><ol><li>表示该类是一个配置类。</li><li>将该类自动注入 IOC 容器中。</li></ol><h3 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h3><ol><li>会将该包以及子包所有类纳入 IOC 容器。</li><li>自动引入第三方依赖。</li></ol><h3 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h3><ol><li>会自动扫描指定包下的全部标有 @Component 的类，并注册成 bean，当然包括 @Component 下的子注解 @Service, @Repository, @Controller。</li></ol><h3 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a>@SpringBootApplication</h3><ol><li>声明 Spirng Boot 项目程序入口。</li><li>包含 @Configuration、 @EnableAutoConfiguration 和 @ComponentScan 注解。</li><li>@SpringBootApplication 会自动扫描子包的所有 bean 对象并纳入 IOC 容器。</li></ol><h3 id="PropertySource"><a href="#PropertySource" class="headerlink" title="@PropertySource"></a>@PropertySource</h3><p>默认会加载 application.yml 和 application.properties 配置文件。</p><ol><li><p>指定配置文件：</p><img src="199.png" width="80%"></li></ol><h4 id="注意-5"><a href="#注意-5" class="headerlink" title="注意"></a>注意</h4><p>只能额外指定 properties 文件，不支持指定 yml 文件。</p><h3 id="ConfigurationProperties"><a href="#ConfigurationProperties" class="headerlink" title="@ConfigurationProperties"></a>@ConfigurationProperties</h3><p>通过 yml 或 properties 配置文件自动赋值。</p><ol><li><p>pojo 类：</p><img src="197.png" width="80%"> <img src="196.png" width="80%"></li><li><p>yml 配置文件：</p><img src="198.png" width="80%"> <img src="195.png" width="80%"></li></ol><h4 id="和-Value-的区别"><a href="#和-Value-的区别" class="headerlink" title="和 @Value 的区别"></a>和 @Value 的区别</h4><ol><li>@ConfigurationProperties 注解优先级默认比 @Value 优先级高。</li><li>@ConfigurationProperties 支持复杂类型赋值，而 @Value 不支持。</li><li>@ConfigurationProperties 支持 JSR-303 数据校验，而 @Value 不支持。</li></ol><h3 id="ImportResource"><a href="#ImportResource" class="headerlink" title="@ImportResource"></a>@ImportResource</h3><p>如果自己写 Spring 配置 Spring Boot 默认不支持，需要通过 @ImportResource 注解指定 Spring 配置文件。</p><p>Spring 不推荐 xml 文件配置，推荐注解方式配置 Spring。</p><h1 id="Hibernator-Validator"><a href="#Hibernator-Validator" class="headerlink" title="Hibernator-Validator"></a>Hibernator-Validator</h1><h2 id="JSR-303"><a href="#JSR-303" class="headerlink" title="JSR-303"></a>JSR-303</h2><p>JSR-303 是 JAVA EE 6 中的一项子规范，叫做 Bean Validation，官方参考实现是 Hibernate-Validator。</p><h2 id="Maven-依赖-16"><a href="#Maven-依赖-16" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h2><p>hibernate-validator.jar</p><img src="151.png" width="80%"><h2 id="注解-8"><a href="#注解-8" class="headerlink" title="注解"></a>注解</h2><img src="147.png" width="80%"> <img src="148.png" width="80%"> <img src="149.png" width="80%"> <img src="150.png" width="80%"><h2 id="Spring-配置"><a href="#Spring-配置" class="headerlink" title="Spring 配置"></a>Spring 配置</h2><img src="152.png" width="80%"> <img src="153.png" width="80%"><h2 id="使用-21"><a href="#使用-21" class="headerlink" title="使用"></a>使用</h2><img src="154.png" width="80%"><p>@Valid 对对象中的属性进行校验。</p><img src="155.png" width="80%"><p>@Past 声明当前时间以前为合法，当前时间以后不合法。</p><img src="156.png" width="80%"><p>@Email 声明必须为邮箱格式（<a href="mailto:XXX@XXX.com" target="_blank" rel="noopener">XXX@XXX.com</a>）。</p><img src="157.png" width="80%"><h1 id="Quartz"><a href="#Quartz" class="headerlink" title="Quartz"></a>Quartz</h1><h2 id="Maven-依赖-17"><a href="#Maven-依赖-17" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h2><p>quartz.jar</p><h2 id="使用-22"><a href="#使用-22" class="headerlink" title="使用"></a>使用</h2><p>实现 Job 接口：</p><img src="99.png" width="80%"><ul><li>MeetingService 为自定义类。</li></ul><p>正在努力编写中…</p><h1 id="HttpClient"><a href="#HttpClient" class="headerlink" title="HttpClient"></a>HttpClient</h1><h2 id="Maven-依赖-18"><a href="#Maven-依赖-18" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h2><h2 id="使用-23"><a href="#使用-23" class="headerlink" title="使用"></a>使用</h2><p>发送 Get 请求：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建 CloseableHttpClient 对象</span></span><br><span class="line">    CloseableHttpClient createDefault = HttpClients.createDefault();</span><br><span class="line">    <span class="comment">// 创建一个 GET 对象</span></span><br><span class="line">    HttpGet httpGet = <span class="keyword">new</span> HttpGet(<span class="string">"http://localhost:8080/test"</span>);</span><br><span class="line">    String string = <span class="string">"请求失败"</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// 执行请求</span></span><br><span class="line">    CloseableHttpResponse execute = createDefault.execute(httpGet);</span><br><span class="line">    <span class="comment">// 获得响应状态码</span></span><br><span class="line">    <span class="keyword">int</span> statusCode = execute.getStatusLine().getStatusCode();</span><br><span class="line">    <span class="keyword">if</span>(statusCode == <span class="number">200</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 取得响应内容</span></span><br><span class="line">        HttpEntity entity = execute.getEntity();</span><br><span class="line">        <span class="comment">// 将内容返回 String 类型</span></span><br><span class="line">        string = EntityUtils.toString(entity, <span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 关闭</span></span><br><span class="line">        execute.close();</span><br><span class="line">        createDefault.close();</span><br><span class="line">        System.out.println(string);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Get 请求附带参数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建 CloseableHttpClient 对象</span></span><br><span class="line">    CloseableHttpClient createDefault = HttpClients.createDefault();</span><br><span class="line">    <span class="comment">// 创建一个 URL 对象，URL 对象可以附带参数</span></span><br><span class="line">    URIBuilder uriBuilder = <span class="keyword">new</span> URIBuilder(<span class="string">"http://localhost:8080/test"</span>);</span><br><span class="line">    uriBuilder.addParameter(<span class="string">"id"</span>, <span class="string">"1"</span>);</span><br><span class="line">    <span class="comment">// 创建一个 GET 对象</span></span><br><span class="line">    HttpGet httpGet = <span class="keyword">new</span> HttpGet(uriBuilder.build());</span><br><span class="line">    String string = <span class="string">"请求失败"</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// 执行请求</span></span><br><span class="line">    CloseableHttpResponse execute = createDefault.execute(httpGet);</span><br><span class="line">    <span class="comment">// 获得响应状态码</span></span><br><span class="line">    <span class="keyword">int</span> statusCode = execute.getStatusLine().getStatusCode();</span><br><span class="line">    <span class="keyword">if</span>(statusCode == <span class="number">200</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 取得响应内容</span></span><br><span class="line">        HttpEntity entity = execute.getEntity();</span><br><span class="line">        <span class="comment">// 将内容返回 String 类型</span></span><br><span class="line">        string = EntityUtils.toString(entity, <span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 关闭</span></span><br><span class="line">        execute.close();</span><br><span class="line">        createDefault.close();</span><br><span class="line">        System.out.println(string);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发送 POST 请求：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建 CloseableHttpClient 对象</span></span><br><span class="line">    CloseableHttpClient createDefault = HttpClients.createDefault();</span><br><span class="line">    <span class="comment">// 设置 POST 请求参数</span></span><br><span class="line">    ArrayList&lt;BasicNameValuePair&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;BasicNameValuePair&gt;();</span><br><span class="line">    arrayList.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"username"</span>, <span class="string">"zs"</span>));</span><br><span class="line">    arrayList.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"password"</span>, <span class="string">"123456"</span>));</span><br><span class="line">    UrlEncodedFormEntity urlEncodedFormEntity = <span class="keyword">new</span> UrlEncodedFormEntity(arrayList, <span class="string">"UTF-8"</span>);</span><br><span class="line">    <span class="comment">// 创建一个 POST 对象</span></span><br><span class="line">    HttpPost httpPost = <span class="keyword">new</span> HttpPost(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">    <span class="comment">// 将请求参数放入 POST 请求的请求体中</span></span><br><span class="line">    httpPost.setEntity(urlEncodedFormEntity);</span><br><span class="line">    String string = <span class="string">"false"</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// 执行请求</span></span><br><span class="line">    CloseableHttpResponse execute = createDefault.execute(httpPost);</span><br><span class="line">    <span class="comment">// 获得响应状态码</span></span><br><span class="line">    <span class="keyword">int</span> statusCode = execute.getStatusLine().getStatusCode();</span><br><span class="line">    <span class="keyword">if</span>(statusCode == <span class="number">302</span> || statusCode == <span class="number">200</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 取得响应内容</span></span><br><span class="line">        HttpEntity entity = execute.getEntity();</span><br><span class="line">        <span class="comment">// 将内容返回 String 类型</span></span><br><span class="line">        string = EntityUtils.toString(entity, <span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 关闭</span></span><br><span class="line">        execute.close();</span><br><span class="line">        createDefault.close();</span><br><span class="line">        System.out.println(string);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配合-jsoup"><a href="#配合-jsoup" class="headerlink" title="配合 jsoup"></a>配合 jsoup</h2><h3 id="介绍-3"><a href="#介绍-3" class="headerlink" title="介绍"></a>介绍</h3><p>做爬虫时，主要负责解析 html 文本。</p><h3 id="Maven-依赖-19"><a href="#Maven-依赖-19" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><h3 id="使用-24"><a href="#使用-24" class="headerlink" title="使用"></a>使用</h3><h1 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h1><h2 id="Maven-依赖-20"><a href="#Maven-依赖-20" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h2><p>jedis.jar</p><h2 id="使用-25"><a href="#使用-25" class="headerlink" title="使用"></a>使用</h2><p>redis.conf 中解除绑定主机（其他 IP 主机就能连接）：</p><img src="172.png" width="80%"><p>解除保护模式：</p><img src="173.png" width="80%"><p>java 代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 连接数据库</span></span><br><span class="line">    Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置 key 值</span></span><br><span class="line">    jedis.set(<span class="string">"key1"</span>, <span class="string">"haha"</span>);</span><br><span class="line">    <span class="comment">// 获取 key 值</span></span><br><span class="line">    String string = jedis.get(<span class="string">"key1"</span>);</span><br><span class="line">    <span class="comment">// 关闭连接</span></span><br><span class="line">    jedis.close();</span><br><span class="line">    System.out.println(string);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用连接池：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findDataWithPool</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 新建连接池对象</span></span><br><span class="line">    JedisPool jedisPool = <span class="keyword">new</span> JedisPool(<span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 从连接池中获取 Jedis 对象</span></span><br><span class="line">    Jedis resource = jedisPool.getResource();</span><br><span class="line">    <span class="comment">// 获取 key2 的值</span></span><br><span class="line">    String string = resource.get(<span class="string">"key2"</span>);</span><br><span class="line">    <span class="comment">// jedis 对象放入连接池</span></span><br><span class="line">    resource.close();</span><br><span class="line">    <span class="comment">// 关闭连接池</span></span><br><span class="line">    jedisPool.close();</span><br><span class="line">    System.out.println(string);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>集群：</p><img src="186.png" width="80%"><h2 id="Spring-整合-Jedis"><a href="#Spring-整合-Jedis" class="headerlink" title="Spring 整合 Jedis"></a>Spring 整合 Jedis</h2><p>applicationContext.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 连接池配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jedisPoolConfig"</span> <span class="attr">class</span>=<span class="string">"redis.clients.jedis.JedisPoolConfig"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 最大连接数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxTotal"</span> <span class="attr">value</span>=<span class="string">"30"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 最大空闲连接数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 每次释放连接的最大数目 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"numTestsPerEvictionRun"</span> <span class="attr">value</span>=<span class="string">"1024"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 释放连接的扫描间隔（毫秒） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeBetweenEvictionRunsMillis"</span> <span class="attr">value</span>=<span class="string">"30000"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 连接最小空闲时间 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minEvictableIdleTimeMillis"</span> <span class="attr">value</span>=<span class="string">"1800000"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 连接空闲多久后释放, 当空闲时间&gt;该值 且 空闲连接&gt;最大空闲连接数 时直接释放 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"softMinEvictableIdleTimeMillis"</span> <span class="attr">value</span>=<span class="string">"10000"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 获取连接时的最大等待毫秒数,小于零:阻塞不确定的时间,默认-1 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxWaitMillis"</span> <span class="attr">value</span>=<span class="string">"1500"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 在获取连接的时候检查有效性, 默认false --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnBorrow"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 在空闲时检查有效性, 默认false --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testWhileIdle"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"blockWhenExhausted"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>	</span><br><span class="line"><span class="comment">&lt;!-- jedis客户端单机版 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisClient"</span> <span class="attr">class</span>=<span class="string">"redis.clients.jedis.JedisPool"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"host"</span> <span class="attr">value</span>=<span class="string">"192.168.25.153"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"port"</span> <span class="attr">value</span>=<span class="string">"6379"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"poolConfig"</span> <span class="attr">ref</span>=<span class="string">"jedisPoolConfig"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><img src="187.png" width="80%"><ul><li>incr 自增长。</li><li>expire 设置生命周期。</li><li>ttl 获取生命周期。</li></ul><h2 id="注意-6"><a href="#注意-6" class="headerlink" title="注意"></a>注意</h2><p>Redis 一般使用 hash 对象数据进行分类。</p><h1 id="commons-net"><a href="#commons-net" class="headerlink" title="commons-net"></a>commons-net</h1><h2 id="概念-7"><a href="#概念-7" class="headerlink" title="概念"></a>概念</h2><p>commons-net.jar 为 FTP 工具包，可实现文件的上传、下载和删除。</p><h2 id="使用-26"><a href="#使用-26" class="headerlink" title="使用"></a>使用</h2><p>文件上传：</p><img src="176.png" width="80%"><h1 id="Shiro"><a href="#Shiro" class="headerlink" title="Shiro"></a>Shiro</h1><h2 id="概念-8"><a href="#概念-8" class="headerlink" title="概念"></a>概念</h2><p>Apache Shiro 是一个强大且易用的 Java 安全框架,执行身份验证（登录）、授权（权限）、密码（加密）和会话管理（Session 管理）。</p><p>Shiro 中的 Session 也会运用在 JAVA SE 环境下，非 Web 环境也可使用。</p><h3 id="Shiro-三大核心组件"><a href="#Shiro-三大核心组件" class="headerlink" title="Shiro 三大核心组件"></a>Shiro 三大核心组件</h3><img src="192.png" width="80%"><ul><li>subject 即当前用户，与系统发生交互。</li><li>SecurityManager 即 subject 管理者。</li><li>Realm 即数据源（定义的用户和权限），可以从配置文件读取和数据库中读取。</li></ul><h2 id="使用-27"><a href="#使用-27" class="headerlink" title="使用"></a>使用</h2><h3 id="ini-文件数据源"><a href="#ini-文件数据源" class="headerlink" title="ini 文件数据源"></a>ini 文件数据源</h3><p>shiro.ini 配置文件：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[users]</span></span><br><span class="line"><span class="comment"># 用户名为 root，密码为 123456，拥有 admin 角色。</span></span><br><span class="line"><span class="attr">root</span> = <span class="number">123456</span>, admin</span><br><span class="line"><span class="attr">test</span> = <span class="number">123456</span>, test</span><br><span class="line"><span class="attr">guest</span> = <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="section">[roles]</span></span><br><span class="line"><span class="comment"># admin 角色拥有任何权限</span></span><br><span class="line"><span class="attr">admin</span> = *</span><br><span class="line"><span class="comment"># test 角色拥有 menu:list, menu:add 权限</span></span><br><span class="line"><span class="attr">test</span> = menu:list, menu:add</span><br><span class="line"></span><br><span class="line"><span class="section">[urls]</span></span><br><span class="line"><span class="comment"># 不需要验证</span></span><br><span class="line">/login.html = anon</span><br><span class="line"><span class="comment"># 必须登录才能访问</span></span><br><span class="line">/index.html = authc</span><br><span class="line"><span class="comment"># 只有 admin 用户才能看得到</span></span><br><span class="line">/role = authc, roles[admin]</span><br><span class="line"><span class="comment"># 只有 admin 并且拥有 menu 权限才能看到</span></span><br><span class="line">/menu/** = authc, roles[admin], perms[menu:*]</span><br></pre></td></tr></table></figure><p>JAVA 代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建工程</span></span><br><span class="line">    IniSecurityManagerFactory iniSecurityManagerFactory = <span class="keyword">new</span> IniSecurityManagerFactory(<span class="string">"classpath:shiro.ini"</span>);</span><br><span class="line">    <span class="comment">// 从工厂中获取配置实例</span></span><br><span class="line">    SecurityManager instance = iniSecurityManagerFactory.getInstance();</span><br><span class="line">    <span class="comment">// 加载 shiro.ini 配置</span></span><br><span class="line">    SecurityUtils.setSecurityManager(instance);</span><br><span class="line">    <span class="comment">// 获取当前 subject 对象</span></span><br><span class="line">    Subject subject = SecurityUtils.getSubject();</span><br><span class="line">    <span class="comment">// 和 Realm（Shiro 数据源）进行比较的数据</span></span><br><span class="line">    UsernamePasswordToken usernamePasswordToken = <span class="keyword">new</span> UsernamePasswordToken(<span class="string">"test"</span>, <span class="string">"123456"</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 开始比较，比较不通过会抛出异常</span></span><br><span class="line">        subject.login(usernamePasswordToken);</span><br><span class="line">        <span class="comment">// isAuthenticated 方法判断是否验证通过，通过返回 true，否则返回 false</span></span><br><span class="line">        <span class="keyword">if</span>(subject.isAuthenticated()) &#123;	</span><br><span class="line">            </span><br><span class="line">            System.out.println(<span class="string">"登录成功"</span>);</span><br><span class="line">            <span class="comment">// 判断是否为 admin 角色</span></span><br><span class="line">            <span class="keyword">if</span>(subject.hasRole(<span class="string">"admin"</span>)) &#123;</span><br><span class="line">                </span><br><span class="line">                System.out.println(<span class="string">"为 admin 角色"</span>);</span><br><span class="line">                </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                System.out.println(<span class="string">"其他角色"</span>);</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 判断是否有 find 权限</span></span><br><span class="line">            <span class="keyword">if</span>(subject.isPermitted(<span class="string">"find"</span>)) &#123;</span><br><span class="line">                </span><br><span class="line">                System.out.println(<span class="string">"有 find 权限"</span>);</span><br><span class="line">                </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                System.out.println(<span class="string">"没有 find 权限"</span>);</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        </span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        System.out.println(<span class="string">"登录失败"</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="jdbcRealm"><a href="#jdbcRealm" class="headerlink" title="jdbcRealm"></a>jdbcRealm</h3><p>shiro.ini 配置文件：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[main]</span></span><br><span class="line"><span class="attr">dataSource</span>=org.springframework.jdbc.datasource.DriverManagerDataSource</span><br><span class="line"><span class="attr">dataSource.driverClassName</span>=com.mysql.cj.jdbc.Driver</span><br><span class="line"><span class="attr">dataSource.url</span>=jdbc:mysql://localhost:<span class="number">3306</span>/ssm?useUnicode=<span class="literal">true</span>&amp;characterEncoding=UTF-<span class="number">8</span>&amp;serverTimezone=UTC</span><br><span class="line"><span class="attr">dataSource.username</span>=root</span><br><span class="line"><span class="attr">dataSource.password</span>=<span class="number">123456</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">jdbcRealm</span>=org.apache.shiro.realm.jdbc.JdbcRealm</span><br><span class="line"><span class="attr">jdbcRealm.permissionsLookupEnabled</span> = <span class="literal">true</span>  </span><br><span class="line"><span class="attr">jdbcRealm.dataSource</span>=<span class="variable">$dataSource</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jdbcRealm.authenticationQuery</span> = SELECT password FROM ssm_user WHERE username = ?</span><br><span class="line"><span class="attr">jdbcRealm.userRolesQuery</span> = SELECT role from ssm_role WHERE username = ?</span><br><span class="line"><span class="attr">jdbcRealm.permissionsQuery</span> = SELECT permission_name FROM ssm_permission WHERE role_name = ?</span><br></pre></td></tr></table></figure><p>MySQL 数据库：</p><img src="194.png" width="40%"><ul><li>同个角色拥有多个权限时添加多一条记录即可，例如 test 角色拥有 perm1 和 perm2 权限。<table><thead><tr><th align="left">role</th><th align="left">perm</th></tr></thead><tbody><tr><td align="left">test</td><td align="left">perm1</td></tr><tr><td align="left">test</td><td align="left">perm2</td></tr></tbody></table></li></ul><h3 id="Realm-接口"><a href="#Realm-接口" class="headerlink" title="Realm 接口"></a>Realm 接口</h3><h4 id="Shiro-认证策略"><a href="#Shiro-认证策略" class="headerlink" title="Shiro 认证策略"></a>Shiro 认证策略</h4><img src="193.png" width="80%"><h4 id="JAVA-代码"><a href="#JAVA-代码" class="headerlink" title="JAVA 代码"></a>JAVA 代码</h4><p>自定义数据源：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRealml</span> <span class="keyword">implements</span> <span class="title">Realm</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"myrealml"</span>;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(AuthenticationToken token)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 限制数据源只支持 UsernamePasswordToken</span></span><br><span class="line">		<span class="keyword">return</span> token <span class="keyword">instanceof</span> UsernamePasswordToken;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> AuthenticationInfo <span class="title">getAuthenticationInfo</span><span class="params">(AuthenticationToken token)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 获取用户名</span></span><br><span class="line">		String principal = (String)token.getPrincipal();</span><br><span class="line">		<span class="comment">// 获取密码</span></span><br><span class="line">		String credentials = <span class="keyword">new</span> String((<span class="keyword">char</span> [])token.getCredentials());</span><br><span class="line">		<span class="comment">// 判断用户名是否正确，不正确抛出 UnknownAccountException 异常</span></span><br><span class="line">		<span class="keyword">if</span>(!<span class="string">"test"</span>.equals(principal)) &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> UnknownAccountException();</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 判断密码是否正确，不争取抛出 IncorrectCredentialsException 异常</span></span><br><span class="line">		<span class="keyword">if</span>(!<span class="string">"123456"</span>.equals(credentials)) &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IncorrectCredentialsException();</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 返回用户名、密码和数据源名字</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(principal, credentials, getName());</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置和验证用户：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    DefaultSecurityManager defaultSecurityManager = <span class="keyword">new</span> DefaultSecurityManager();</span><br><span class="line">    <span class="comment">// 设置身份验证策略</span></span><br><span class="line">    ModularRealmAuthenticator modularRealmAuthenticator = <span class="keyword">new</span> ModularRealmAuthenticator();</span><br><span class="line">    modularRealmAuthenticator.setAuthenticationStrategy(<span class="keyword">new</span> AtLeastOneSuccessfulStrategy());</span><br><span class="line">    <span class="comment">// 加载身份验证策略</span></span><br><span class="line">    defaultSecurityManager.setAuthenticator(modularRealmAuthenticator);</span><br><span class="line">    <span class="comment">// 设置授权</span></span><br><span class="line">    ModularRealmAuthorizer modularRealmAuthorizer = <span class="keyword">new</span> ModularRealmAuthorizer();</span><br><span class="line">    modularRealmAuthorizer.setPermissionResolver(<span class="keyword">new</span> WildcardPermissionResolver());</span><br><span class="line">    <span class="comment">// 加载授权方式</span></span><br><span class="line">    defaultSecurityManager.setAuthorizer(modularRealmAuthorizer);</span><br><span class="line">    <span class="comment">// 加载自定义数据源</span></span><br><span class="line">    defaultSecurityManager.setRealm(<span class="keyword">new</span> MyRealml());</span><br><span class="line">    SecurityUtils.setSecurityManager(defaultSecurityManager);</span><br><span class="line">    <span class="comment">// 获取当前 subject 对象</span></span><br><span class="line">    Subject subject = SecurityUtils.getSubject();</span><br><span class="line">    <span class="comment">// 和 Realm（Shiro 数据源）进行比较的数据</span></span><br><span class="line">    UsernamePasswordToken usernamePasswordToken = <span class="keyword">new</span> UsernamePasswordToken(<span class="string">"test"</span>, <span class="string">"123456"</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 开始比较，比较不通过会抛出异常</span></span><br><span class="line">        subject.login(usernamePasswordToken);</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        </span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AuthorizingRealm"><a href="#AuthorizingRealm" class="headerlink" title="AuthorizingRealm"></a>AuthorizingRealm</h3><p>设置数据源为 MyRealm2, Subject 对象调用 login 方法根据 MyRealm2 进行验证：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRealm2</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	JdbcTemplate JdbcTemplate;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 权限验证调用的方法，验证该用户是否拥有对应角色。</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principals)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String sql = <span class="string">"select role from shiro_user_role where username = ?"</span>;</span><br><span class="line">		<span class="comment">// 获取用户</span></span><br><span class="line">		String primaryPrincipal = (String)principals.getPrimaryPrincipal();</span><br><span class="line">		<span class="comment">// 根据用户查询角色</span></span><br><span class="line">		List&lt;String&gt; queryForList = JdbcTemplate.queryForList(sql, String.class, primaryPrincipal);</span><br><span class="line">		<span class="comment">// 封装对象</span></span><br><span class="line">		SimpleAuthorizationInfo simpleAuthorizationInfo = <span class="keyword">new</span> SimpleAuthorizationInfo();</span><br><span class="line">		simpleAuthorizationInfo.addRoles(queryForList);</span><br><span class="line">		<span class="comment">// 把封装对象返回给 Shiro 自动验证</span></span><br><span class="line">		<span class="keyword">return</span> simpleAuthorizationInfo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 登录的时候调用，比较用户名和密码</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken token)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		String sql = <span class="string">"select password from user where username = ?"</span>;</span><br><span class="line">		String principal = (String)token.getPrincipal();</span><br><span class="line">		String queryForObject = JdbcTemplate.queryForObject(sql, String.class, principal);</span><br><span class="line">		<span class="comment">// 封装对象，参数分别为用户名、密码、加密的盐值、Realm的名字</span></span><br><span class="line">		SimpleAuthenticationInfo simpleAuthenticationInfo = <span class="keyword">new</span> SimpleAuthenticationInfo(principal, queryForObject, <span class="keyword">null</span>, getName());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 返回给 Shiro 会自动缓存和验证</span></span><br><span class="line">		<span class="keyword">return</span> simpleAuthenticationInfo;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="对象常用方法"><a href="#对象常用方法" class="headerlink" title="对象常用方法"></a>对象常用方法</h2><p>Subject 对象：</p><ul><li><code>boolean isPermitted(Permission permission);</code> 判断是否拥有单个权限。</li><li><code>boolean[] isPermitted(String... permissions);</code> 判断是否拥有多个权限。</li><li><code>boolean isPermittedAll(String... permissions);</code> 判断同时是否拥有多个权限（没有任何一个权限，返回 false）。</li><li><code>boolean hasRole(String roleIdentifier);</code> 判断是否拥有该角色。</li><li><code>boolean[] hasRoles(List&lt;String&gt; roleIdentifiers);</code> 判断是否拥有多个角色。</li><li><code>boolean hasAllRoles(Collection&lt;String&gt; roleIdentifiers);</code> 判断是否同时拥有多个角色。</li><li><code>void logout();</code> 退出登录。</li></ul><h2 id="集成-Spring-MVC-环境"><a href="#集成-Spring-MVC-环境" class="headerlink" title="集成 Spring MVC 环境"></a>集成 Spring MVC 环境</h2><h3 id="Maven-依赖-21"><a href="#Maven-依赖-21" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h3><p>shiro-core.jar</p><p>shiro-web.jar</p><p>shiro-spring.jar</p><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><p>spring 配置文件：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 读取 ini 数据源 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"IniRealm"</span> <span class="attr">class</span>=<span class="string">"org.apache.shiro.realm.text.IniRealm"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"resourcePath"</span> <span class="attr">value</span>=<span class="string">"classpath:shiro.ini"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 加载 ini 数据源 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"securityManager"</span> <span class="attr">class</span>=<span class="string">"org.apache.shiro.web.mgt.DefaultWebSecurityManager"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    加载 ini 数据源；</span></span><br><span class="line"><span class="comment">            也可以加载 AuthorizingRealm 数据源，要将继承的 AuthorizingRealm 数据源纳入 IOC 容器；</span></span><br><span class="line"><span class="comment">            将 ref 指向 纳入 IOC 的 AuthorizingRealm 数据源；</span></span><br><span class="line"><span class="comment">            这样就可以根据数据库验证用户信息。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"realm"</span> <span class="attr">ref</span>=<span class="string">"IniRealm"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 加载配置，定义规则 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"shiroFilter"</span> <span class="attr">class</span>=<span class="string">"org.apache.shiro.spring.web.ShiroFilterFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"securityManager"</span> <span class="attr">ref</span>=<span class="string">"securityManager"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义没有通过验证的跳转页面，即登陆页面。默认的是webroot下的login.jsp页面 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"loginUrl"</span> <span class="attr">value</span>=<span class="string">"/demo/login/login.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义验证通过的跳转页面 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"successUrl"</span> <span class="attr">value</span>=<span class="string">"/demo/login/index.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 经过认证但是没有相应的权限时跳转的页面（权限不足） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"unauthorizedUrl"</span> <span class="attr">value</span>=<span class="string">"/demo/login/error.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义资源访问规则 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"filterChainDefinitions"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">            /demo/login/login.html = anon</span><br><span class="line">            /demo/** = authc</span><br><span class="line">            /role = authc, roles[admin]</span><br><span class="line">            /menu/** = authc, roles[admin], perms[menu:*]</span><br><span class="line">        <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>web.xml 配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Shiro 核心拦截器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>shiroFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        org.springframework.web.filter.DelegatingFilterProxy</span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>shiroFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="JAVA-代码-1"><a href="#JAVA-代码-1" class="headerlink" title="JAVA 代码"></a>JAVA 代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">returnPageData</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    Subject subject = SecurityUtils.getSubject();</span><br><span class="line">    UsernamePasswordToken usernamePasswordToken = <span class="keyword">new</span> UsernamePasswordToken(username, password);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">    </span><br><span class="line">        subject.login(usernamePasswordToken);</span><br><span class="line">        <span class="keyword">if</span>(subject.isAuthenticated()) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="string">"redirect:/demo/login/index.html"</span>;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        </span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/demo/login/login.html"</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"redirect:/demo/login/login.html"</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="常用注解"><a href="#常用注解" class="headerlink" title="常用注解"></a>常用注解</h1><h2 id="注解大全"><a href="#注解大全" class="headerlink" title="注解大全"></a>注解大全</h2><table><thead><tr><th align="left">注解</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">@MapKey</td><td align="left"><a href="#返回HashMap中的key为bean对象的id属性">指定 Map 中的 Key 值</a></td></tr><tr><td align="left">@Param</td><td align="left"><a href="#通过注解命名参数">通过 @Param 指定传入参数的名字</a></td></tr><tr><td align="left">@RequestMapper</td><td align="left"><a href="#指定请求接口-RequestMapper">拦截指定请求</a></td></tr><tr><td align="left">@RequestParam</td><td align="left"><a href="#-RequestParam">获取请求参数</a></td></tr><tr><td align="left">@RequestBody</td><td align="left"><a href="#RequestBody">获取请求参数</a></td></tr><tr><td align="left">@PathVariable</td><td align="left"><a href="#获取路径中的参数-PathVariable">获取路径中的参数</a></td></tr><tr><td align="left">@SessionAttributes</td><td align="left"><a href="#Session">将指定 key 存入 Session 中</a></td></tr><tr><td align="left">@ResponseBody</td><td align="left"><a href="#返回json数据-ResponseBody">返回数据给前端</a>，必须和 @RequestMapper 一起使用。</td></tr></tbody></table></div><div><div><div style="text-align:center;color:#ccc;font-size:22px;letter-spacing:12px">本文结束<i class="fa fa-paw"></i>感谢您的阅读</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>im乐</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://zero3737.gitee.io/posts/49154/" title="JAVA 进阶">https://zero3737.gitee.io/posts/49154/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/JAVA/" rel="tag"><i class="fa fa-tag"></i> JAVA</a></div><div class="post-widgets"><div class="social_share"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/38008/" rel="next" title="Maven"><i class="fa fa-chevron-left"></i> Maven</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/posts/59812/" rel="prev" title="IDEA">IDEA <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/static/user_images/头像/avatar.gif" alt="im乐"><p class="site-author-name" itemprop="name">im乐</p><div class="site-description motion-element" itemprop="description">一个专注分享互联网知识的网站，希望你会喜欢它。</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">89</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">17</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/zero3737" title="GitHub &rarr; https://github.com/zero3737" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://gitee.com/zero3737/" title="Gitee &rarr; https://gitee.com/zero3737/" rel="noopener" target="_blank"><i class="fa fa-fw fa-git"></i>Gitee</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li><a href="/posts/12fc1c4b/" title="JSP 教程" target="_blank">JSP 教程</a></li><li><a href="/posts/8dc1959/" title="JavaScript进阶之事件" target="_blank">JavaScript进阶之事件</a></li><li><a href="/posts/514ba138/" title="实例化对象（new）的过程" target="_blank">实例化对象（new）的过程</a></li><li><a href="/posts/77987eec/" title="JavaScript 中的原型链和函数原型" target="_blank">JavaScript 中的原型链和函数原型</a></li><li><a href="/posts/fed4be0c/" title="for…in 遍历对象中的属性" target="_blank">for…in 遍历对象中的属性</a></li></ul></div><script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script><script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script><div class="widget-wrap"><h3 class="widget-title" style="text-align:center;color:#fc6423">Tag Cloud</h3><div id="myCanvasContainer" class="widget tagcloud"><canvas width="250" height="250" id="resCanvas" style="width:100%"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">30</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/">HTML</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVA/">JAVA</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a><span class="tag-list-count">42</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发工具/">开发工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/教程/">教程</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务搭建/">服务搭建</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/未完待续/">未完待续</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/概念/">概念</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/科学上网/">科学上网</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网站推荐/">网站推荐</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件推荐/">软件推荐</a><span class="tag-list-count">2</span></li></ul></canvas></div></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#JUnit"><span class="nav-number">1.</span> <span class="nav-text">JUnit</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Maven-依赖"><span class="nav-number">1.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试代码的要求"><span class="nav-number">1.2.</span> <span class="nav-text">测试代码的要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用"><span class="nav-number">1.3.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MyBatis"><span class="nav-number">2.</span> <span class="nav-text">MyBatis</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#入门案例"><span class="nav-number">2.1.</span> <span class="nav-text">入门案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念"><span class="nav-number">2.1.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-1"><span class="nav-number">2.1.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MyBatis-配置文件"><span class="nav-number">2.1.3.</span> <span class="nav-text">MyBatis 配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mapper"><span class="nav-number">2.1.4.</span> <span class="nav-text">mapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基础-API"><span class="nav-number">2.1.5.</span> <span class="nav-text">基础 API</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#引用-properties"><span class="nav-number">2.2.</span> <span class="nav-text">引用 properties</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#properties-文件"><span class="nav-number">2.2.1.</span> <span class="nav-text">properties 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MyBatis-配置文件-1"><span class="nav-number">2.2.2.</span> <span class="nav-text">MyBatis 配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据源"><span class="nav-number">2.2.3.</span> <span class="nav-text">数据源</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事务"><span class="nav-number">2.3.</span> <span class="nav-text">事务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mapper-1"><span class="nav-number">2.4.</span> <span class="nav-text">mapper</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本标签"><span class="nav-number">2.4.1.</span> <span class="nav-text">基本标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#约定"><span class="nav-number">2.4.2.</span> <span class="nav-text">约定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义别名"><span class="nav-number">2.4.3.</span> <span class="nav-text">定义别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#全局参数配置"><span class="nav-number">2.4.4.</span> <span class="nav-text">全局参数配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SqlSeesion-对象"><span class="nav-number">2.5.</span> <span class="nav-text">SqlSeesion 对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于动态代理方式-CRUD"><span class="nav-number">2.6.</span> <span class="nav-text">基于动态代理方式 CRUD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#约定-1"><span class="nav-number">2.6.1.</span> <span class="nav-text">约定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-1"><span class="nav-number">2.6.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#resultMap"><span class="nav-number">2.7.</span> <span class="nav-text">resultMap</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#属性名和数据库字段名不一致"><span class="nav-number">2.7.1.</span> <span class="nav-text">属性名和数据库字段名不一致</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义类型转换器"><span class="nav-number">2.7.2.</span> <span class="nav-text">自定义类型转换器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拼接符和占位符"><span class="nav-number">2.8.</span> <span class="nav-text">拼接符和占位符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#占位符"><span class="nav-number">2.8.1.</span> <span class="nav-text">#{} 占位符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拼接符"><span class="nav-number">2.8.2.</span> <span class="nav-text">${} 拼接符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输入和输出参数"><span class="nav-number">2.9.</span> <span class="nav-text">输入和输出参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#输入多个参数"><span class="nav-number">2.9.1.</span> <span class="nav-text">输入多个参数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#不指定别名"><span class="nav-number">2.9.1.1.</span> <span class="nav-text">不指定别名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Param-指定别名"><span class="nav-number">2.9.1.2.</span> <span class="nav-text">@Param 指定别名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#嵌套对象"><span class="nav-number">2.9.1.3.</span> <span class="nav-text">嵌套对象</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#返回-List"><span class="nav-number">2.9.2.</span> <span class="nav-text">返回 List</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HashMap"><span class="nav-number">2.9.3.</span> <span class="nav-text">HashMap</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#输入参数"><span class="nav-number">2.9.3.1.</span> <span class="nav-text">输入参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输出参数"><span class="nav-number">2.9.3.2.</span> <span class="nav-text">输出参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#注意"><span class="nav-number">2.9.3.2.1.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MapKey"><span class="nav-number">2.9.3.3.</span> <span class="nav-text">@MapKey</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#javaType、jdbcType-和-MySQL-之间对应关系"><span class="nav-number">2.10.</span> <span class="nav-text">javaType、jdbcType 和 MySQL 之间对应关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#javaType-与-jdbcType"><span class="nav-number">2.10.1.</span> <span class="nav-text">javaType 与 jdbcType</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jdbcType-与-MySQL"><span class="nav-number">2.10.2.</span> <span class="nav-text">jdbcType 与 MySQL</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#调用存储过程"><span class="nav-number">2.11.</span> <span class="nav-text">调用存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mapper-扩展"><span class="nav-number">2.12.</span> <span class="nav-text">mapper 扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#动态-SQL"><span class="nav-number">2.12.1.</span> <span class="nav-text">动态 SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#if"><span class="nav-number">2.12.1.1.</span> <span class="nav-text">if</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#where"><span class="nav-number">2.12.1.2.</span> <span class="nav-text">where</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#foreach"><span class="nav-number">2.12.1.3.</span> <span class="nav-text">foreach</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#遍历对象中-List-集合"><span class="nav-number">2.12.1.3.1.</span> <span class="nav-text">遍历对象中 List 集合</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#遍历数组"><span class="nav-number">2.12.1.3.2.</span> <span class="nav-text">遍历数组</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#遍历-List-集合"><span class="nav-number">2.12.1.3.3.</span> <span class="nav-text">遍历 List 集合</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#遍历对象数组"><span class="nav-number">2.12.1.3.4.</span> <span class="nav-text">遍历对象数组</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-片段"><span class="nav-number">2.12.2.</span> <span class="nav-text">SQL 片段</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多表查询"><span class="nav-number">2.13.</span> <span class="nav-text">多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一对一"><span class="nav-number">2.13.1.</span> <span class="nav-text">一对一</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#关系图"><span class="nav-number">2.13.1.1.</span> <span class="nav-text">关系图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#新建扩展类"><span class="nav-number">2.13.1.2.</span> <span class="nav-text">新建扩展类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#association"><span class="nav-number">2.13.1.3.</span> <span class="nav-text">association</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一对多"><span class="nav-number">2.13.2.</span> <span class="nav-text">一对多</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#关系图-1"><span class="nav-number">2.13.2.1.</span> <span class="nav-text">关系图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#collection"><span class="nav-number">2.13.2.2.</span> <span class="nav-text">collection</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#延迟加载"><span class="nav-number">2.14.</span> <span class="nav-text">延迟加载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#全局配置"><span class="nav-number">2.14.1.</span> <span class="nav-text">全局配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一对一-1"><span class="nav-number">2.14.2.</span> <span class="nav-text">一对一</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#新建-mapper-文件"><span class="nav-number">2.14.2.1.</span> <span class="nav-text">新建 mapper 文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#主-mapper-文件"><span class="nav-number">2.14.2.2.</span> <span class="nav-text">主 mapper 文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一对多-1"><span class="nav-number">2.14.3.</span> <span class="nav-text">一对多</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#动态代理接口"><span class="nav-number">2.14.3.1.</span> <span class="nav-text">动态代理接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mapper-2"><span class="nav-number">2.14.3.2.</span> <span class="nav-text">mapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#主程序"><span class="nav-number">2.14.3.3.</span> <span class="nav-text">主程序</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#整合-log4j"><span class="nav-number">2.15.</span> <span class="nav-text">整合 log4j</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#日志级别"><span class="nav-number">2.15.1.</span> <span class="nav-text">日志级别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-2"><span class="nav-number">2.15.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mybatis-配置文件"><span class="nav-number">2.15.3.</span> <span class="nav-text">Mybatis 配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j-properties"><span class="nav-number">2.15.4.</span> <span class="nav-text">log4j.properties</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PageHelper"><span class="nav-number">2.16.</span> <span class="nav-text">PageHelper</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍"><span class="nav-number">2.16.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-3"><span class="nav-number">2.16.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MyBatis-配置"><span class="nav-number">2.16.3.</span> <span class="nav-text">MyBatis 配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参数配置"><span class="nav-number">2.16.4.</span> <span class="nav-text">参数配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-2"><span class="nav-number">2.16.5.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#逆向工程"><span class="nav-number">2.17.</span> <span class="nav-text">逆向工程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-4"><span class="nav-number">2.17.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xml-配置文件"><span class="nav-number">2.17.2.</span> <span class="nav-text">xml 配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#主程序-1"><span class="nav-number">2.17.3.</span> <span class="nav-text">主程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-3"><span class="nav-number">2.17.4.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意-1"><span class="nav-number">2.17.5.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通用-Mapper"><span class="nav-number">2.18.</span> <span class="nav-text">通用 Mapper</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍-1"><span class="nav-number">2.18.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-5"><span class="nav-number">2.18.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注解"><span class="nav-number">2.18.3.</span> <span class="nav-text">注解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Table"><span class="nav-number">2.18.3.1.</span> <span class="nav-text">@Table</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Id"><span class="nav-number">2.18.3.2.</span> <span class="nav-text">@Id</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Column"><span class="nav-number">2.18.3.3.</span> <span class="nav-text">@Column</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Transient"><span class="nav-number">2.18.3.4.</span> <span class="nav-text">@Transient</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GeneratedValue"><span class="nav-number">2.18.3.5.</span> <span class="nav-text">@GeneratedValue</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置参数"><span class="nav-number">2.18.4.</span> <span class="nav-text">配置参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编写-JAVA-程序"><span class="nav-number">2.18.5.</span> <span class="nav-text">编写 JAVA 程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API-介绍"><span class="nav-number">2.18.6.</span> <span class="nav-text">API 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-Maven-执行-MBG"><span class="nav-number">2.18.7.</span> <span class="nav-text">使用 Maven 执行 MBG</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MBG-插件环境搭建"><span class="nav-number">2.18.7.1.</span> <span class="nav-text">MBG 插件环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Maven-配置"><span class="nav-number">2.18.7.1.1.</span> <span class="nav-text">Maven 配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#generatorConfig-xml-文件配置"><span class="nav-number">2.18.7.1.2.</span> <span class="nav-text">generatorConfig.xml 文件配置</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#节点说明"><span class="nav-number">2.18.7.2.</span> <span class="nav-text">节点说明</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring"><span class="nav-number">3.</span> <span class="nav-text">Spring</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#入门案例-1"><span class="nav-number">3.1.</span> <span class="nav-text">入门案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Schema"><span class="nav-number">3.1.1.</span> <span class="nav-text">Schema</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-6"><span class="nav-number">3.1.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-配置文件"><span class="nav-number">3.1.3.</span> <span class="nav-text">Spring 配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取-IOC-实例"><span class="nav-number">3.1.4.</span> <span class="nav-text">获取 IOC 实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看-IOC-容器中所有-bean-对象"><span class="nav-number">3.1.5.</span> <span class="nav-text">查看 IOC 容器中所有 bean 对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#依赖注入"><span class="nav-number">3.2.</span> <span class="nav-text">依赖注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DI-与-IOC"><span class="nav-number">3.2.1.</span> <span class="nav-text">DI 与 IOC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过-setter-方法注入"><span class="nav-number">3.2.2.</span> <span class="nav-text">通过 setter 方法注入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本类型（包含封装类）"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">基本类型（包含封装类）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#List、-Set、-数组类型"><span class="nav-number">3.2.2.2.</span> <span class="nav-text">List、 Set、 数组类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Map-类型"><span class="nav-number">3.2.2.3.</span> <span class="nav-text">Map 类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Properties-类"><span class="nav-number">3.2.2.4.</span> <span class="nav-text">Properties 类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过构造方法注入"><span class="nav-number">3.2.3.</span> <span class="nav-text">通过构造方法注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过命名空间注入"><span class="nav-number">3.2.4.</span> <span class="nav-text">通过命名空间注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自动装配"><span class="nav-number">3.2.5.</span> <span class="nav-text">自动装配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#介绍-2"><span class="nav-number">3.2.5.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自动装配模式"><span class="nav-number">3.2.5.2.</span> <span class="nav-text">自动装配模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#全局自动装配"><span class="nav-number">3.2.5.3.</span> <span class="nav-text">全局自动装配</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于注解依赖注入"><span class="nav-number">3.3.</span> <span class="nav-text">基于注解依赖注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注解-1"><span class="nav-number">3.3.1.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置扫描器"><span class="nav-number">3.3.2.</span> <span class="nav-text">配置扫描器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#排除"><span class="nav-number">3.3.2.1.</span> <span class="nav-text">排除</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-4"><span class="nav-number">3.3.3.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自动装配-1"><span class="nav-number">3.3.4.</span> <span class="nav-text">自动装配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注解-2"><span class="nav-number">3.3.4.1.</span> <span class="nav-text">注解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Autowired"><span class="nav-number">3.3.4.1.1.</span> <span class="nav-text">@Autowired</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例"><span class="nav-number">3.3.4.2.</span> <span class="nav-text">示例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#读取-properties-文件配置参数"><span class="nav-number">3.4.</span> <span class="nav-text">读取 properties 文件配置参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置类"><span class="nav-number">3.5.</span> <span class="nav-text">配置类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注解-3"><span class="nav-number">3.5.1.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-5"><span class="nav-number">3.5.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过注解配置扫描器"><span class="nav-number">3.5.3.</span> <span class="nav-text">通过注解配置扫描器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注解-4"><span class="nav-number">3.5.3.1.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-6"><span class="nav-number">3.5.3.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注意-2"><span class="nav-number">3.5.3.3.</span> <span class="nav-text">注意</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合-JUnit"><span class="nav-number">3.6.</span> <span class="nav-text">Spring 整合 JUnit</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-7"><span class="nav-number">3.6.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-7"><span class="nav-number">3.6.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合-AOP"><span class="nav-number">3.7.</span> <span class="nav-text">Spring 整合 AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-1"><span class="nav-number">3.7.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-8"><span class="nav-number">3.7.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#execution-表达式"><span class="nav-number">3.7.3.</span> <span class="nav-text">execution 表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基于接口实现-AOP"><span class="nav-number">3.7.4.</span> <span class="nav-text">基于接口实现 AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通知接口"><span class="nav-number">3.7.4.1.</span> <span class="nav-text">通知接口</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#前置通知"><span class="nav-number">3.7.4.1.1.</span> <span class="nav-text">前置通知</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#后置通知"><span class="nav-number">3.7.4.1.2.</span> <span class="nav-text">后置通知</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#异常通知"><span class="nav-number">3.7.4.1.3.</span> <span class="nav-text">异常通知</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#环绕通知"><span class="nav-number">3.7.4.1.4.</span> <span class="nav-text">环绕通知</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#注意-3"><span class="nav-number">3.7.4.1.5.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XML-配置"><span class="nav-number">3.7.4.2.</span> <span class="nav-text">XML 配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基于注解实现-AOP"><span class="nav-number">3.7.5.</span> <span class="nav-text">基于注解实现 AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置"><span class="nav-number">3.7.5.1.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注解-5"><span class="nav-number">3.7.5.2.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取目标对象信息"><span class="nav-number">3.7.5.3.</span> <span class="nav-text">获取目标对象信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基于-XML-实现-AOP"><span class="nav-number">3.7.6.</span> <span class="nav-text">基于 XML 实现 AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通知类"><span class="nav-number">3.7.6.1.</span> <span class="nav-text">通知类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XML-配置-1"><span class="nav-number">3.7.6.2.</span> <span class="nav-text">XML 配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合事务"><span class="nav-number">3.8.</span> <span class="nav-text">Spring 整合事务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-9"><span class="nav-number">3.8.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML-配置-2"><span class="nav-number">3.8.2.</span> <span class="nav-text">XML 配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#声明式事务"><span class="nav-number">3.8.3.</span> <span class="nav-text">声明式事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基础概念"><span class="nav-number">3.8.3.1.</span> <span class="nav-text">基础概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#基于-XML"><span class="nav-number">3.8.3.2.</span> <span class="nav-text">基于 XML</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#基于注解"><span class="nav-number">3.8.3.3.</span> <span class="nav-text">基于注解</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合-JDBC"><span class="nav-number">3.9.</span> <span class="nav-text">Spring 整合 JDBC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#环境配置"><span class="nav-number">3.9.1.</span> <span class="nav-text">环境配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-8"><span class="nav-number">3.9.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合-MyBatis"><span class="nav-number">3.10.</span> <span class="nav-text">Spring 整合 MyBatis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-10"><span class="nav-number">3.10.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置-1"><span class="nav-number">3.10.2.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-9"><span class="nav-number">3.10.3.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基于动态代理方式-CRUD-整合配置"><span class="nav-number">3.10.4.</span> <span class="nav-text">基于动态代理方式 CRUD 整合配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合-Web"><span class="nav-number">3.11.</span> <span class="nav-text">Spring 整合 Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-11"><span class="nav-number">3.11.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置-2"><span class="nav-number">3.11.2.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-10"><span class="nav-number">3.11.3.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-内置工具类"><span class="nav-number">3.12.</span> <span class="nav-text">Spring 内置工具类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MD5-加密"><span class="nav-number">3.12.1.</span> <span class="nav-text">MD5 加密</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MD5-介绍"><span class="nav-number">3.12.1.1.</span> <span class="nav-text">MD5 介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DigestUtils-类-API-介绍"><span class="nav-number">3.12.1.2.</span> <span class="nav-text">DigestUtils 类 API 介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-11"><span class="nav-number">3.12.1.3.</span> <span class="nav-text">使用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring-MVC"><span class="nav-number">4.</span> <span class="nav-text">Spring MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#入门案例-2"><span class="nav-number">4.1.</span> <span class="nav-text">入门案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-12"><span class="nav-number">4.1.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置-3"><span class="nav-number">4.1.2.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-12"><span class="nav-number">4.1.3.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#指定请求接口-RequestMapper"><span class="nav-number">4.2.</span> <span class="nav-text">指定请求接口@RequestMapper</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取请求参数"><span class="nav-number">4.3.</span> <span class="nav-text">获取请求参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RequestParam"><span class="nav-number">4.3.1.</span> <span class="nav-text">@RequestParam</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#概念-2"><span class="nav-number">4.3.1.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-13"><span class="nav-number">4.3.1.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RequestBody"><span class="nav-number">4.3.2.</span> <span class="nav-text">@RequestBody</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#页面跳转（不通过-RequestMapper）"><span class="nav-number">4.4.</span> <span class="nav-text">页面跳转（不通过 @RequestMapper）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#视图解析器"><span class="nav-number">4.5.</span> <span class="nav-text">视图解析器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RESTful-风格"><span class="nav-number">4.6.</span> <span class="nav-text">RESTful 风格</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#获取路径中的参数-PathVariable"><span class="nav-number">4.6.1.</span> <span class="nav-text">获取路径中的参数@PathVariable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#增加-DELETE-和-PUT-请求的支持"><span class="nav-number">4.6.2.</span> <span class="nav-text">增加 DELETE 和 PUT 请求的支持</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-MVC-约定"><span class="nav-number">4.6.3.</span> <span class="nav-text">Spring MVC 约定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-14"><span class="nav-number">4.6.4.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session"><span class="nav-number">4.7.</span> <span class="nav-text">Session</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-3"><span class="nav-number">4.7.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存-Session"><span class="nav-number">4.7.2.</span> <span class="nav-text">存 Session</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将数据存入-Request-域中"><span class="nav-number">4.8.</span> <span class="nav-text">将数据存入 Request 域中</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ModelAttribute"><span class="nav-number">4.9.</span> <span class="nav-text">@ModelAttribute</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-4"><span class="nav-number">4.9.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-15"><span class="nav-number">4.9.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#请求转发和重定向"><span class="nav-number">4.10.</span> <span class="nav-text">请求转发和重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#访问静态资源"><span class="nav-number">4.11.</span> <span class="nav-text">访问静态资源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类型转换器"><span class="nav-number">4.12.</span> <span class="nav-text">类型转换器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据格式化"><span class="nav-number">4.13.</span> <span class="nav-text">数据格式化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#返回json数据-ResponseBody"><span class="nav-number">4.14.</span> <span class="nav-text">返回json数据@ResponseBody</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#jackjson"><span class="nav-number">4.14.1.</span> <span class="nav-text">jackjson</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-16"><span class="nav-number">4.14.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意-4"><span class="nav-number">4.14.3.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件上传"><span class="nav-number">4.15.</span> <span class="nav-text">文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-13"><span class="nav-number">4.15.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置多部件解析器"><span class="nav-number">4.15.2.</span> <span class="nav-text">配置多部件解析器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-17"><span class="nav-number">4.15.3.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拦截器"><span class="nav-number">4.16.</span> <span class="nav-text">拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-5"><span class="nav-number">4.16.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-18"><span class="nav-number">4.16.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置-4"><span class="nav-number">4.16.3.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-容器和-Spring-MVC-容器关系"><span class="nav-number">4.17.</span> <span class="nav-text">Spring 容器和 Spring MVC 容器关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-MVC-中的-API-接口为什么要纳入-IOC-中？"><span class="nav-number">4.17.1.</span> <span class="nav-text">Spring MVC 中的 API 接口为什么要纳入 IOC 中？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合-Spring-MVC"><span class="nav-number">4.18.</span> <span class="nav-text">Spring 整合 Spring MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#字符过滤器"><span class="nav-number">4.18.1.</span> <span class="nav-text">字符过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Maven-依赖-14"><span class="nav-number">4.18.1.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-5"><span class="nav-number">4.18.1.2.</span> <span class="nav-text">配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fastjson"><span class="nav-number">4.19.</span> <span class="nav-text">fastjson</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-6"><span class="nav-number">4.19.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-15"><span class="nav-number">4.19.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-19"><span class="nav-number">4.19.3.</span> <span class="nav-text">使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#序列化"><span class="nav-number">4.19.3.1.</span> <span class="nav-text">序列化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#反序列化"><span class="nav-number">4.19.3.2.</span> <span class="nav-text">反序列化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#功能"><span class="nav-number">4.19.3.3.</span> <span class="nav-text">功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注解-6"><span class="nav-number">4.19.3.4.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实例"><span class="nav-number">4.19.3.5.</span> <span class="nav-text">实例</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring-Boot"><span class="nav-number">5.</span> <span class="nav-text">Spring Boot</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#微服务"><span class="nav-number">5.1.</span> <span class="nav-text">微服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#构建-Spring-Boot-项目"><span class="nav-number">5.2.</span> <span class="nav-text">构建 Spring Boot 项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#resources-目录文件说明"><span class="nav-number">5.2.1.</span> <span class="nav-text">resources 目录文件说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#application-配置文件默认存放路径"><span class="nav-number">5.2.2.</span> <span class="nav-text">application 配置文件默认存放路径</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#依赖包"><span class="nav-number">5.3.</span> <span class="nav-text">依赖包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#spring-boot-starter-web"><span class="nav-number">5.3.1.</span> <span class="nav-text">spring-boot-starter-web</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#spring-boot-configuration-processor"><span class="nav-number">5.3.2.</span> <span class="nav-text">spring-boot-configuration-processor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mybatis-spring-boot-starter"><span class="nav-number">5.3.3.</span> <span class="nav-text">mybatis-spring-boot-starter</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#application-properties-配置"><span class="nav-number">5.4.</span> <span class="nav-text">application.properties 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置选项"><span class="nav-number">5.4.1.</span> <span class="nav-text">配置选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#示例-1"><span class="nav-number">5.4.2.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#application-yml-配置"><span class="nav-number">5.5.</span> <span class="nav-text">application.yml 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#语法规则"><span class="nav-number">5.5.1.</span> <span class="nav-text">语法规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#指定开发环境"><span class="nav-number">5.5.2.</span> <span class="nav-text">指定开发环境</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#随机占位符"><span class="nav-number">5.6.</span> <span class="nav-text">随机占位符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#日志"><span class="nav-number">5.7.</span> <span class="nav-text">日志</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#日志级别-1"><span class="nav-number">5.7.1.</span> <span class="nav-text">日志级别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-20"><span class="nav-number">5.7.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#日志配置"><span class="nav-number">5.7.3.</span> <span class="nav-text">日志配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-开发"><span class="nav-number">5.8.</span> <span class="nav-text">Web 开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#集成-MyBatis"><span class="nav-number">5.9.</span> <span class="nav-text">集成 MyBatis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#依赖包-1"><span class="nav-number">5.9.1.</span> <span class="nav-text">依赖包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置文件"><span class="nav-number">5.9.2.</span> <span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动类"><span class="nav-number">5.9.3.</span> <span class="nav-text">启动类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注解-7"><span class="nav-number">5.10.</span> <span class="nav-text">注解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration"><span class="nav-number">5.10.1.</span> <span class="nav-text">@Configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EnableAutoConfiguration"><span class="nav-number">5.10.2.</span> <span class="nav-text">@EnableAutoConfiguration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ComponentScan"><span class="nav-number">5.10.3.</span> <span class="nav-text">@ComponentScan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBootApplication"><span class="nav-number">5.10.4.</span> <span class="nav-text">@SpringBootApplication</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PropertySource"><span class="nav-number">5.10.5.</span> <span class="nav-text">@PropertySource</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注意-5"><span class="nav-number">5.10.5.1.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ConfigurationProperties"><span class="nav-number">5.10.6.</span> <span class="nav-text">@ConfigurationProperties</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#和-Value-的区别"><span class="nav-number">5.10.6.1.</span> <span class="nav-text">和 @Value 的区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ImportResource"><span class="nav-number">5.10.7.</span> <span class="nav-text">@ImportResource</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hibernator-Validator"><span class="nav-number">6.</span> <span class="nav-text">Hibernator-Validator</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#JSR-303"><span class="nav-number">6.1.</span> <span class="nav-text">JSR-303</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Maven-依赖-16"><span class="nav-number">6.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注解-8"><span class="nav-number">6.3.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-配置"><span class="nav-number">6.4.</span> <span class="nav-text">Spring 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-21"><span class="nav-number">6.5.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Quartz"><span class="nav-number">7.</span> <span class="nav-text">Quartz</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Maven-依赖-17"><span class="nav-number">7.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-22"><span class="nav-number">7.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HttpClient"><span class="nav-number">8.</span> <span class="nav-text">HttpClient</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Maven-依赖-18"><span class="nav-number">8.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-23"><span class="nav-number">8.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配合-jsoup"><span class="nav-number">8.3.</span> <span class="nav-text">配合 jsoup</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍-3"><span class="nav-number">8.3.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-19"><span class="nav-number">8.3.2.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-24"><span class="nav-number">8.3.3.</span> <span class="nav-text">使用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Jedis"><span class="nav-number">9.</span> <span class="nav-text">Jedis</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Maven-依赖-20"><span class="nav-number">9.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-25"><span class="nav-number">9.2.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-整合-Jedis"><span class="nav-number">9.3.</span> <span class="nav-text">Spring 整合 Jedis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#接口"><span class="nav-number">9.4.</span> <span class="nav-text">接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注意-6"><span class="nav-number">9.5.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#commons-net"><span class="nav-number">10.</span> <span class="nav-text">commons-net</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念-7"><span class="nav-number">10.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-26"><span class="nav-number">10.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Shiro"><span class="nav-number">11.</span> <span class="nav-text">Shiro</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念-8"><span class="nav-number">11.1.</span> <span class="nav-text">概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Shiro-三大核心组件"><span class="nav-number">11.1.1.</span> <span class="nav-text">Shiro 三大核心组件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-27"><span class="nav-number">11.2.</span> <span class="nav-text">使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ini-文件数据源"><span class="nav-number">11.2.1.</span> <span class="nav-text">ini 文件数据源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jdbcRealm"><span class="nav-number">11.2.2.</span> <span class="nav-text">jdbcRealm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Realm-接口"><span class="nav-number">11.2.3.</span> <span class="nav-text">Realm 接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Shiro-认证策略"><span class="nav-number">11.2.3.1.</span> <span class="nav-text">Shiro 认证策略</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JAVA-代码"><span class="nav-number">11.2.3.2.</span> <span class="nav-text">JAVA 代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AuthorizingRealm"><span class="nav-number">11.2.4.</span> <span class="nav-text">AuthorizingRealm</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#对象常用方法"><span class="nav-number">11.3.</span> <span class="nav-text">对象常用方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#集成-Spring-MVC-环境"><span class="nav-number">11.4.</span> <span class="nav-text">集成 Spring MVC 环境</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-依赖-21"><span class="nav-number">11.4.1.</span> <span class="nav-text">Maven 依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置环境"><span class="nav-number">11.4.2.</span> <span class="nav-text">配置环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JAVA-代码-1"><span class="nav-number">11.4.3.</span> <span class="nav-text">JAVA 代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#常用注解"><span class="nav-number">12.</span> <span class="nav-text">常用注解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#注解大全"><span class="nav-number">12.1.</span> <span class="nav-text">注解大全</span></a></li></ol></li></ol></div></div></div><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><div id="landlord"><div class="message" style="opacity:0"></div><canvas id="live2d" width="300" height="380" class="live2d"></canvas></div><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2022</span> <span class="with-love" id="animate"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">im乐</span> <span class="post-meta-divider footer-ages-icon">|</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">292k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">4:25</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span>访问人数</span> <span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span>总访问量</span> <span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div><div><script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278758248'%3E%3C/span%3E%3Cscript src='https://s9.cnzz.com/z_stat.php%3Fid%3D1278758248%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"))</script></div></div></footer></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/npm/fastclick@1/lib/fastclick.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery-lazyload@1/jquery.lazyload.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/reading_progress/reading_progress.js"></script><script src="/js/utils.js?v=7.1.2"></script><script src="/js/motion.js?v=7.1.2"></script><script src="/js/affix.js?v=7.1.2"></script><script src="/js/schemes/pisces.js?v=7.1.2"></script><script src="/js/scrollspy.js?v=7.1.2"></script><script src="/js/post-details.js?v=7.1.2"></script><script src="/js/next-boot.js?v=7.1.2"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var GUEST=["nick","mail","link"],guest="nick,mail";guest=guest.split(",").filter(function(e){return GUEST.indexOf(e)>-1}),new Valine({el:"#comments",verify:!1,notify:!1,appId:"G2263okNhhWmY54fzXVhqqXV-MdYXbMMI",appKey:"c3Mz0H4v2spiQybEgul3ScwD",placeholder:"请输入你的内容",avatar:"mm",meta:guest,pageSize:"10",visitor:!0,lang:"zh-cn"})</script><script>function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var e=$("#local-search-input");e.attr("autocapitalize","none"),e.attr("autocorrect","off"),e.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(e){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(e,t,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:e,dataType:isXml?"xml":"json",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():e,r=document.getElementById(t),s=document.getElementById(o),a=function(){var e=r.value.trim().toLowerCase(),t=e.split(/[\s\-]+/);t.length>1&&t.push(e);var o=[];if(e.length>0&&n.forEach(function(n){function r(t,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===e&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(e,t){var o="",n=t.start;return t.hits.forEach(function(t){o+=e.substring(n,t.position);var r=t.position+t.length;o+='<b class="search-keyword">'+e.substring(t.position,r)+"</b>",n=r}),o+=e.substring(n,t.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url).replace(/\/{2,}/g,"/"),d=[],g=[];if(""!=l&&(t.forEach(function(e){function t(e,t,o){var n=e.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(t=t.toLowerCase(),e=e.toLowerCase());(s=t.indexOf(e,r))>-1;)a.push({position:s,word:e}),r=s+n;return a}d=d.concat(t(e,h,!1)),g=g.concat(t(e,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(e){e.sort(function(e,t){return t.position!==e.position?t.position-e.position:e.word.length-t.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hits.length!==t.hits.length?t.hits.length-e.hits.length:e.start-t.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(e){b+="<a href='"+f+'\'><p class="search-result">'+s(p,e)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===t.length&&""===t[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x"></i></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>';else{o.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id});var a='<ul class="search-result-list">';o.forEach(function(e){a+=e.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(e){e.stopPropagation()}),$(document).on("keyup",function(e){var t=27===e.which&&$(".search-popup").is(":visible");t&&onPopupClose()})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script><script>pbOptions={},pbOptions.iconStyle="default",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Wechat,QQZone,Weibo,Douban,Mailto",new needShareButton("#needsharebutton-postbottom",pbOptions)</script><script>$(".highlight").not(".gist .highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=e,document.body.appendChild(n);const a=document.getSelection(),i=a.rangeCount>0?a.getRangeAt(0):!1;n.select(),n.setSelectionRange(0,e.length),n.readOnly=!1;var l=document.execCommand("copy");l?$(this).text("复制成功"):$(this).text("复制失败"),n.blur(),$(this).blur(),i&&(a.removeAllRanges(),a.addRange(i))})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})</script><canvas class="fireworks" width="2500" height="856" style="width:1250px;height:428px"></canvas><script src="https://cdn.jsdelivr.net/npm/animejs@2.2.0/anime.min.js"></script><script src="/static/js/cursor/fireworks2.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.min.js"></script><script>function timer() {
      var ages = moment.preciseDiff(moment(),moment(20190601,"YYYYMMDD"));
      //去除时分秒信息
      ages = ages.replace(/\s?\d{0,2}\s+hours?/, "");
      ages = ages.replace(/\s?\d{0,2}\s+minutes?/, "");
      ages = ages.replace(/\s?\d{0,2}\s+seconds?/, "");
      //将年月日转换为中文
      ages = ages.replace(/years?/, "年");
      ages = ages.replace(/months?/, "月");
      ages = ages.replace(/days?/, "天");
      ages = ages.replace(/\d+/g, '<span style="color:#1094e8">$&</span>');
      span.innerHTML = `网站已经运行 ${ages}`;
    }
    var span = document.createElement("span");
    //插入到agesicon之后
    var agesicon = document.querySelector(".footer-ages-icon");
    console.log(agesicon);
    document.querySelector(".copyright").insertBefore(span, agesicon.nextSibling);
    timer();</script><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement(o),n=t.getElementsByTagName(o)[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/bf66604c.js","daovoice"),daovoice("init",{app_id:"bf66604c"}),daovoice("update")</script><script type="text/javascript">var message_Path="/live2d/",home_Path="https://zero3737.gitee.io/"</script><script type="text/javascript" defer src="/live2d/js/message.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/z16.model.json"},display:{position:"right",width:300,height:400},mobile:{show:!1},react:{opacity:.7},log:!1})</script></body></html><!-- rebuild by neat -->