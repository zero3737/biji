<!-- build time:Sat Sep 24 2022 00:08:10 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><script data-ad-client="ca-pub-7534416172769714" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css"><link rel="stylesheet" href="/css/main.css?v=7.1.2"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.2"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2"><link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.2",sidebar:{position:"left",display:"post",offset:12,onmobile:!1,dimmer:!0},back2top:!0,back2top_sidebar:!0,fancybox:!0,fastclick:!0,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="description" content="计算机网络TCP 协议介绍TCP 属于传输层协议，是一种面相连接的可靠的协议。面向连接是指用户首先必须先建立一个连接（三次握手）,然后用这个连接传输数据,再释放或关闭连接（四次挥手）。三次握手第一次握手：建立连接时，客户端发送syn包（syn=x）到服务器，并进入 SYN_SENT 状态，等待服务器确认。第二次握手：服务器收到 syn 包，必须确认客户的 SYN（ack=x+1），同时自己也发送一"><meta property="og:type" content="article"><meta property="og:title" content="服务器配置"><meta property="og:url" content="https://zero3737.gitee.io/posts/15841/index.html"><meta property="og:site_name" content="im乐"><meta property="og:description" content="计算机网络TCP 协议介绍TCP 属于传输层协议，是一种面相连接的可靠的协议。面向连接是指用户首先必须先建立一个连接（三次握手）,然后用这个连接传输数据,再释放或关闭连接（四次挥手）。三次握手第一次握手：建立连接时，客户端发送syn包（syn=x）到服务器，并进入 SYN_SENT 状态，等待服务器确认。第二次握手：服务器收到 syn 包，必须确认客户的 SYN（ack=x+1），同时自己也发送一"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/30.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/1.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/2.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/3.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/4.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/5.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/6.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/7.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/8.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/9.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/12.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/11.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/13.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/14.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/16.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/15.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/25.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/22.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/23.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/24.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/27.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/28.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/18.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/19.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/20.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/21.png"><meta property="og:image" content="https://zero3737.gitee.io/posts/15841/29.png"><meta property="og:updated_time" content="2020-04-06T17:18:51.858Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="服务器配置"><meta name="twitter:description" content="计算机网络TCP 协议介绍TCP 属于传输层协议，是一种面相连接的可靠的协议。面向连接是指用户首先必须先建立一个连接（三次握手）,然后用这个连接传输数据,再释放或关闭连接（四次挥手）。三次握手第一次握手：建立连接时，客户端发送syn包（syn=x）到服务器，并进入 SYN_SENT 状态，等待服务器确认。第二次握手：服务器收到 syn 包，必须确认客户的 SYN（ack=x+1），同时自己也发送一"><meta name="twitter:image" content="https://zero3737.gitee.io/posts/15841/30.png"><link rel="alternate" href="/atom.xml" title="im乐" type="application/atom+xml"><link rel="canonical" href="https://zero3737.gitee.io/posts/15841/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>服务器配置 | im乐</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?4082c5f4a737e261906898d7d41f122b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">im乐</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Efforts may not lead to success, but please don't be discouraged</p></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div><link rel="stylesheet" href="/live2d/css/live2d.css"></header><a href="https://github.com/zero3737" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><div class="reading-progress-bar"></div><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://zero3737.gitee.io/posts/15841/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="im乐"><meta itemprop="description" content="一个专注分享互联网知识的网站，希望你会喜欢它。"><meta itemprop="image" content="/static/user_images/头像/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="im乐"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">服务器配置</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-08-01 00:38:48" itemprop="dateCreated datePublished" datetime="2019-08-01T00:38:48+08:00">2019-08-01</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-04-07 01:18:51" itemprop="dateModified" datetime="2020-04-07T01:18:51+08:00">2020-04-07</time> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><span class="post-meta-item-text">评论数：</span> <a href="/posts/15841/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/posts/15841/" itemprop="commentCount"></span> </a></span><span id="/posts/15841/" class="leancloud_visitors" data-flag-title="服务器配置"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span title="本文字数">12k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">11 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h1><h2 id="TCP-协议"><a href="#TCP-协议" class="headerlink" title="TCP 协议"></a>TCP 协议</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul><li>TCP 属于传输层协议，是一种面相连接的可靠的协议。</li><li>面向连接是指用户首先必须先建立一个连接（三次握手）,然后用这个连接传输数据,再释放或关闭连接（四次挥手）。</li></ul><h3 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h3><ol><li>第一次握手：建立连接时，客户端发送syn包（syn=x）到服务器，并进入 SYN_SENT 状态，等待服务器确认。</li><li>第二次握手：服务器收到 syn 包，必须确认客户的 SYN（ack=x+1），同时自己也发送一个 SYN 包（syn=y），即 SYN+ACK 包，此时服务器进入 SYN_RECV 状态；</li><li>第三次握手：客户端收到服务器的 SYN+ACK 包，向服务器发送确认包 ACK(ack=y+1），此包发送完毕，客户端和服务器进入 ESTABLISHED（TCP连接成功）状态，完成三次握手。</li></ol><h3 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h3><ol><li>客户端进程发出连接释放报文，并且停止发送数据。</li><li>服务器收到连接释放报文，发出确认报文，ACK=1，ack=u+1，并且带上自己的序列号 seq=v，此时，服务端就进入了 CLOSE-WAIT（关闭等待）状态。</li><li>客户端收到服务器的确认请求后，此时，客户端就进入 FIN-WAIT-2 （终止等待 2）状态，等待服务器发送连接释放报文（在这之前还需要接受服务器发送的最后的数据）。</li><li>服务器将最后的数据发送完毕后，就向客户端发送连接释放报文，FIN=1，ack=u+1，由于在半关闭状态，服务器很可能又发送了一些数据，假定此时的序列号为 seq=w，此时，服务器就进入了 LAST-ACK（最后确认）状态，等待客户端的确认。</li><li>客户端收到服务器的连接释放报文后，必须发出确认，ACK=1，ack=w+1，而自己的序列号是 seq=u+1，此时，客户端就进入了 TIME-WAIT（时间等待）状态。</li><li>服务器只要收到了客户端发出的确认，立即进入 CLOSED 状态。同样，撤销 TCB 后，就结束了这次的 TCP 连接。</li></ol><a id="more"></a><h3 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h3><ul><li>在计算机网络里，有两种常见的参考模型即：OSI 参考模型和 TCP/IP 参考模型。</li><li>由此可见 TCP 本身是传输层的协议， 而 TCP/IP 是一种网络参考模型。</li></ul><h2 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h2><h3 id="域名组成"><a href="#域名组成" class="headerlink" title="域名组成"></a>域名组成</h3><p>域名由主机头（www）+域名名称（baidu）+服务机构（com）组成。</p><h3 id="记录类型"><a href="#记录类型" class="headerlink" title="记录类型"></a>记录类型</h3><table><thead><tr><th align="left">参数</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left"><strong>A</strong></td><td align="left">将域名指向一个IP地址，就需要添加A记录。</td></tr><tr><td align="left"><strong>CNAME</strong></td><td align="left">将域名指向另一个域名，再由另一个域名提供ip地址。</td></tr><tr><td align="left">AAAA</td><td align="left">指定主机名（域名）对应的IPv6地址（例如：ff06:0:0:0:0:0:0:c3）记录。</td></tr><tr><td align="left">MX</td><td align="left">如果需要设置邮箱，让邮箱能收到邮件，就需要添加MX记录。</td></tr><tr><td align="left">NS</td><td align="left">域名服务器记录，如果需要把子域名交给其他DNS服务商解析，就需要添加NS记录。</td></tr><tr><td align="left">TXT</td><td align="left">可以填写任何东西，长度限制255。绝大多数的TXT记录是用来做SPF记录（反垃圾邮件）。</td></tr><tr><td align="left">显性URL</td><td align="left">从一个地址301重定向到另一个地址的时候，就需要添加显性URL记录（注：DNSPod目前只支持301重定向）。</td></tr><tr><td align="left">隐性URL</td><td align="left">类似于显性URL，区别在于隐性URL不会改变地址栏中的域名。</td></tr><tr><td align="left">SRV</td><td align="left">记录了哪台计算机提供了哪个服务。格式为：<code>服务的名字 + 点 + 协议的类型</code>，例如：_xmpp-server._tcp。</td></tr></tbody></table><h3 id="主机记录"><a href="#主机记录" class="headerlink" title="主机记录"></a>主机记录</h3><table><thead><tr><th align="left">参数</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">www</td><td align="left">解析后的域名为：<a href="http://www.xxx.com" target="_blank" rel="noopener">www.xxx.com</a></td></tr><tr><td align="left">@</td><td align="left">直接解析主域名：xxx.com</td></tr><tr><td align="left">*</td><td align="left">泛解析，匹配其他所有域名：*.1756260160.com</td></tr></tbody></table><h3 id="CNAME"><a href="#CNAME" class="headerlink" title="CNAME"></a>CNAME</h3><ul><li>CNAME 被称为规范名字，这种记录允许您将多个域名映射到同一台计算机。</li><li>默认情况下，服务器是允许CNAME访问的。</li><li>一般网站都做了 CNAME 访问策略。</li></ul><h3 id="线路"><a href="#线路" class="headerlink" title="线路"></a>线路</h3><p>让指定线路的用户访问这个IP。</p><table><thead><tr><th align="left">参数</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">默认</td><td align="left">必须添加，否则只有单独指定的线路才能访问您的网站（如果双线解析，建议「默认」线路填写「电信IP」）。</td></tr><tr><td align="left">联通</td><td align="left">单独为「联通用户」指定服务器 IP，其他用户依然访问「默认」。</td></tr><tr><td align="left">搜索引擎</td><td align="left">指定一个服务器 IP 让蜘蛛抓取。</td></tr></tbody></table><h3 id="记录值"><a href="#记录值" class="headerlink" title="记录值"></a>记录值</h3><table><thead><tr><th align="left">记录类型</th><th align="left">记录值</th></tr></thead><tbody><tr><td align="left">A</td><td align="left">填写您服务器 IP。</td></tr><tr><td align="left">CNAME</td><td align="left">填写域名。</td></tr><tr><td align="left">MX</td><td align="left">填写邮件服务器提供的 IP 和 域名。</td></tr><tr><td align="left">TXT</td><td align="left">一般用于 Google、QQ等企业邮箱的反垃圾邮件设置。</td></tr><tr><td align="left">显性URL</td><td align="left">填写要跳转到的网址。</td></tr><tr><td align="left">隐性URL</td><td align="left">填写要引用内容的网址。</td></tr><tr><td align="left">AAAA</td><td align="left">填写 IPv6 地址。</td></tr><tr><td align="left">NS</td><td align="left">系统默认添加的两个NS记录请不要修改。NS向下授权，填写dns域名。</td></tr><tr><td align="left">SRV</td><td align="left">格式为：<code>优先级 空格 权重 空格 端口 空格 主机名</code>，记录生成后会自动在域名后面补一个<code>.</code>。</td></tr></tbody></table><h3 id="MX优先级"><a href="#MX优先级" class="headerlink" title="MX优先级"></a>MX优先级</h3><ul><li>首先，如果只有一条 MX 记录，谈优先级是没有意义的，当存在多条 MX 记录时优先级才会有意义。</li><li>MX 优先级是指指定邮件服务器接收邮件的先后顺序（1-50），一般 MX 优先级默认设置为 5、10、15 等（数值越小优先级越高）。</li></ul><h3 id="TTL"><a href="#TTL" class="headerlink" title="TTL"></a>TTL</h3><p>即 Time To Live，缓存的生存时间。指地方dns缓存您域名记录信息的时间，缓存失效后会再次到DNSPod获取记录值。数值越小，修改记录生效时间越快。</p><table><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">600（10分钟）</td><td align="left">建议正常情况下使用 600。</td></tr><tr><td align="left">60（1分钟）</td><td align="left">如果您经常修改IP，修改记录一分钟即可生效。长期使用 60，解析速度会略受影响。</td></tr><tr><td align="left">3600（1小时）</td><td align="left">如果您IP极少变动（一年几次），建议选择 3600，解析速度快。如果要修改IP，提前一天改为 60，即可快速生效。</td></tr></tbody></table><h2 id="URI、URL-与-URN"><a href="#URI、URL-与-URN" class="headerlink" title="URI、URL 与 URN"></a>URI、URL 与 URN</h2><h3 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h3><ul><li>统一资源标识符（Uniform Resource Identifier，URI)是一个用于标识某一互联网资源名称的字符串。</li><li>该种标识允许用户对任何（包括本地和互联网）的资源通过特定的协议进行交互操作。</li><li>URI 通常由三部分组成：<ol><li>问资源的命名机制。</li><li>存放资源的主机名。</li><li>资源自身的名称，由路径表示，着重强调于资源。</li></ol></li></ul><h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h3><ul><li>URL 是 URI 的一个子集，它是 Uniform Resource Locator 的缩写，译为“统一资源定位符”。</li><li>URL 一般由三部组成：<ol><li>协议(或称为服务方式)。</li><li>存有该资源的主机 IP 地址(有时也包括端口号)。</li><li>主机资源的具体地址，如目录和文件名等。</li></ol></li><li>URL 定义了该如何访问资源，URL 是一种具体的 URI，它是 URI 的一个子集，它不仅唯一标识资源，而且还提供了定位该资源的信息。</li><li>URI 是一种语义上的抽象概念，可以是绝对的，也可以是相对的，而 URL 则必须提供足够的信息来定位，是绝对的。</li></ul><h3 id="URN"><a href="#URN" class="headerlink" title="URN"></a>URN</h3><ul><li><p>URN，uniform resource name，统一资源命名，是通过名字来标识资源。</p></li><li><p>书籍的 ISBN 码和产品在系统内的序列号，尽管没有告诉你用什么方式或者到什么地方去找到目标，但是你有足够的信息来检索到它。</p></li><li><p>URL 是 URI 的子集，所有的 URL 都是 URI，但不是每个 URI 都是 URL，还有可能是 URN。</p><img src="30.png" width="40%"></li><li><p>使用 URN，就可以将资源四处迁移，而不用担心迁移后无法访问。</p></li><li><p>P2P 下载中使用的磁力链接是 URN 的一种实现，它可以持久化的标识一个 BT 资源，资源分布式的存储在 P2P 网络中，无需中心服务器用户即可找到并下载它。</p></li></ul><h1 id="服务器基本概念"><a href="#服务器基本概念" class="headerlink" title="服务器基本概念"></a>服务器基本概念</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul><li>服务器究其根本就是电脑，是提供服务（例如安装 Apache/Tomcat 提供 HTTP 服务）的设备。</li><li>一般服务器默认对上传文件存在大小限制，如果要上传大文件需要修改服务器配置。</li></ul><h2 id="服务器类型"><a href="#服务器类型" class="headerlink" title="服务器类型"></a>服务器类型</h2><table><thead><tr><th align="left">服务器类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">Web 服务器</td><td align="left">只能解析静态页面，即 html 页面，它请求的路径是固定的。</td></tr><tr><td align="left">应用服务器</td><td align="left">应用服务器是指通过各种协议把商业逻辑曝露给客户端的程序。</td></tr><tr><td align="left">Web 应用服务器</td><td align="left">可以解析动态的 jsp 页面，即它请求的路径是动态生成的，负责的是请求的逻辑处理。</td></tr></tbody></table><h1 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h1><h2 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h2><p>Apache 是世界使用排名第一的 Web 服务器软件。</p><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><ol><li><p><a href="http://www.apache.org/" target="_blank" rel="noopener">进入 Apache 官网地址</a></p></li><li><p>点击如图链接。<br><img src="1.png" alt></p></li><li><p>找到httpd目录。</p><p><img src="2.png" alt></p></li><li><p>点击下方链接。</p><p><img src="3.png" alt></p></li><li><p>选择Windows。</p><img src="4.png" width="50%"></li><li><p>选择第一种下载方式。</p><img src="5.png" width="40%"></li><li><p>点击图标下载64位，下方为32位。</p><img src="6.png" width="50%"><ul><li><p>Apache VC14代表什么意思？</p><ul><li>这个版本的Apache是基于VC14的控件库编写，所以电脑要安装相应的控件库才能运行。</li></ul></li></ul></li><li><p>配置httpd.conf文件，位置在Apache根目录下的conf目录。</p><img src="7.png" width="50%"></li><li><p>这是Apache的存放目录。我这里保持默认，如果安装目录名称不是Apache24记得修改。</p><img src="8.png" width="50%"></li><li><p>这是Apache占用端口，默认80。</p><img src="9.png" width="50%"></li><li><p>以<strong>管理员身份</strong>打开cmd，进入bin目录，输入<code>&quot;httpd.exe -k install -n apache&quot;</code>命令安装Apache服务。</p><img src="12.png" width="50%"><ul><li><p>出现上图信息证明安装成功。</p></li><li><p>该命令的意思是，安装apache服务，并将该服务名称命名为apache。</p></li><li><p>如果出现下图信息则要以<strong>管理员身份</strong>打开cmd。</p><img src="11.png" width="75%"></li></ul></li></ol><h2 id="启动与关闭"><a href="#启动与关闭" class="headerlink" title="启动与关闭"></a>启动与关闭</h2><h3 id="通过命令行方式启动关闭-Apache"><a href="#通过命令行方式启动关闭-Apache" class="headerlink" title="通过命令行方式启动关闭 Apache"></a>通过命令行方式启动关闭 Apache</h3><table><thead><tr><th align="left">命令</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">httpd.exe -k start</td><td align="left">启动已安装的Apache服务。</td></tr><tr><td align="left">httpd.exe -k restart</td><td align="left">重启已安装的Apache服务。</td></tr><tr><td align="left">httpd.exe -k stop | httpd.exe -k shutdown</td><td align="left">停止已安装的Apache服务。</td></tr></tbody></table><h3 id="利用Apache自带软件启动关闭Apache。"><a href="#利用Apache自带软件启动关闭Apache。" class="headerlink" title="利用Apache自带软件启动关闭Apache。"></a>利用Apache自带软件启动关闭Apache。</h3><p>软件在 bin 目录下，打开软件即可控制 Apache。</p><img src="13.png" width="25%"><h2 id="通过-CMD-命令卸载"><a href="#通过-CMD-命令卸载" class="headerlink" title="通过 CMD 命令卸载"></a>通过 CMD 命令卸载</h2><ol><li><code>httpd.exe -k uninstall -n &quot;apache&quot;</code> 移除特定的 Apache 服务，apache 是 Apache 服务器的服务名。</li><li><code>sc delete apache</code> 从注册表中删除服务子项。</li></ol><h2 id="Apache-根目录下的各个文件的用途"><a href="#Apache-根目录下的各个文件的用途" class="headerlink" title="Apache 根目录下的各个文件的用途"></a>Apache 根目录下的各个文件的用途</h2><img src="14.png" width="40%"><h1 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h1><h2 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍"></a>介绍</h2><ul><li>Nginx 是一款是由俄罗斯的程序设计师 Igor Sysoev 所开发高性能的 Web 和反向代理服务器，也是一个 IMAP/POP3/SMTP 代理服务器。</li><li>在高连接并发的情况下，Nginx 是 Apache 服务器不错的替代品。</li></ul><h2 id="官网地址"><a href="#官网地址" class="headerlink" title="官网地址"></a>官网地址</h2><ol><li><p><a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">Nginx 官网地址</a></p></li><li><p>选择 Windows 稳定版。</p><img src="16.png" width="50%"></li></ol><h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><p>在 nginx 根目录执行如下命令。</p><img src="15.png" width="25%"><ul><li>建议使用命令启动 nginx 服务器。</li><li>也可以双击根目录下 nginx.exe 文件启动服务器（不建议）。</li></ul><h2 id="基础模块"><a href="#基础模块" class="headerlink" title="基础模块"></a>基础模块</h2><h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">...              #全局块</span><br><span class="line"></span><br><span class="line">events &#123;         #events块</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http      #http块</span><br><span class="line">&#123;</span><br><span class="line">    ...   #http全局块</span><br><span class="line">    server        #server块</span><br><span class="line">    &#123; </span><br><span class="line">        ...       #server全局块</span><br><span class="line">        location [PATTERN]   #location块</span><br><span class="line">        &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">        location [PATTERN] </span><br><span class="line">        &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    server</span><br><span class="line">    &#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">    ...     #http全局块</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="基础模块说明"><a href="#基础模块说明" class="headerlink" title="基础模块说明"></a>基础模块说明</h3><table><thead><tr><th align="left">模块名称</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">全局块</td><td align="left">配置影响 nginx 全局的指令。</td></tr><tr><td align="left">events 块</td><td align="left">配置影响 nginx 服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网路连接，开启多个网络连接序列化等。</td></tr><tr><td align="left">http 块</td><td align="left">可以嵌套多个 server，配置代理，缓存，日志定义等绝大多数功能和第三方模块的配置。如文件引入，mime-type 定义，日志自定义，是否使用 sendfile 传输文件，连接超时时间，单连接请求数等。</td></tr><tr><td align="left">server 块</td><td align="left">配置虚拟主机的相关参数，一个 http 中可以有多个 server。</td></tr><tr><td align="left">location 块</td><td align="left">配置请求的路由，以及各种页面的处理情况。</td></tr></tbody></table><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="反向代理和负载均衡"><a href="#反向代理和负载均衡" class="headerlink" title="反向代理和负载均衡"></a>反向代理和负载均衡</h3><h4 id="模块介绍"><a href="#模块介绍" class="headerlink" title="模块介绍"></a>模块介绍</h4><h5 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h5><ul><li>proxy_pass 为反向代理模块。</li><li>代理服务器接受网络上的请求，然后将请求转发给被代理的服务器（可以是内网主机或公网主机），并将从服务器上得到的结果返回给客户端。</li><li>反向代理服务器和目标服务器对外就是一个服务器，暴露的是代理服务器地址，隐藏了真实服务器IP地址。</li><li>可以利用反向代理特性（隐藏真实服务器的域名或 IP 地址）解决浏览器跨域问题。</li></ul><h5 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h5><ul><li>upstream 为负载均衡模块。</li><li>简单而言就是当有 2 台或以上服务器时，根据规则随机的将请求分发到指定的服务器上处理。</li></ul><h4 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h4><ol><li><p>打开 Nginx 根目录下的 conf/nginx.conf 文件。</p></li><li><p>在 http 模块下添加 upstream 模块。</p><img src="25.png" width="50%"><ul><li>upstream 对应的名字为 upstream 模块名，示例中的 localhost 可以改为其他任意名字，例如：abc。</li><li>upstream 模块可以包含一个或多个 server 模块，一个 server 模块对应一个主机地址。</li><li>其中 server 中对应的值可以是域名或 IP 地址，不能包含 http 关键字或磁盘路径。</li><li>这样 upstream 模块名就可以表示一个或多个主机地址，负载均衡配置完毕。</li></ul></li><li><p>在 http 模块下添加如下配置。</p><img src="22.png" width="40%"><ul><li>这段配置表示导入 vhost 目录下的任意名字的 conf 文件。</li></ul></li><li><p>在 conf 目录下添加 vhost 目录。</p><img src="23.png" width="50%"></li><li><p>在 vhost 目录下添加后缀为 conf 的文件，内容如下：</p><img src="24.png" width="50%"><ul><li>listen 为虚拟主机端口号。</li><li>server_name 为域名。</li><li>当 nginx 接受到请求后，会匹配其配置中的 service 模块。</li><li>匹配方法就是靠请求携带的 host 和 port 正好对应其配置中的 server_name 和 listen。</li><li>proxy_pass 配置参数为 URL。<ul><li>URL 中的主机地址必须和 upstream 中的模块名一样，才能读取 upstream 中的 server 模块配置的主机地址。</li><li>例如 upstream 模块名为 abc，server 模块中 proxy_pass 对应的参数为 <code>http://abc/</code>。</li><li>示例为 localhost，proxy_pass 对应配置参数为 <code>http://localhost/</code>。</li><li>proxy_pass 可以直接配置域名，不读取 upstream 模块的配置参数，例如：<code>https://www.baidu.com/</code>，反向代理配置完毕。</li></ul></li><li>proxy_connect_timeout 超时时间。</li></ul></li><li><p>nginx -s reload 重启 Nginx 服务器更新配置（命令提示框没有什么报错信息代表重启成功）。</p></li><li><p>访问 <code>http://localhost</code> 会正常访问欢迎页。</p><ul><li>本机的 8080 端口配置 http 服务，而 8088 端口没有配置 http 服务。</li><li>但是访问 <code>http://localhost</code> 的时候，也不会有问题，会将请求默认转发到 <code>http://localhost:8080</code>。</li><li>说明负载均衡的时候有一台服务器挂掉，请求会转发到正常工作的服务器。</li></ul></li></ol><h3 id="localtion"><a href="#localtion" class="headerlink" title="localtion"></a>localtion</h3><table><thead><tr><th align="left">配置</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">location /</td><td align="left">通用匹配，任何未匹配到其他location的请求都会匹配到。</td></tr><tr><td align="left">location /uri</td><td align="left">不带任何修饰符，表示前缀匹配。</td></tr><tr><td align="left">location = /uri</td><td align="left">= 开头表示精确前缀匹配，只有完全匹配才能生效。</td></tr><tr><td align="left">location ^~ /uri</td><td align="left">^~ 开头表示普通字符串匹配上以后不再进行正则匹配。</td></tr><tr><td align="left">location ~ pattern</td><td align="left">~ 开头表示区分大小写的正则匹配。</td></tr><tr><td align="left">location ~* pattern</td><td align="left">~* 开头表示不区分大小写的正则匹配。</td></tr></tbody></table><h3 id="静态资源"><a href="#静态资源" class="headerlink" title="静态资源"></a>静态资源</h3><img src="27.png" width="40%"><ul><li>root 指定网站默认根目录，root 可以作用在 server 块或 location 块。</li><li>静态资源默认存放在 nginx 根目录下 html 目录。</li><li>index 指定默认加载网页。</li></ul><h3 id="目录浏览"><a href="#目录浏览" class="headerlink" title="目录浏览"></a>目录浏览</h3><h4 id="配置-2"><a href="#配置-2" class="headerlink" title="配置"></a>配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">location /download &#123;</span><br><span class="line">    root /home/map/www/;</span><br><span class="line">    autoindex on;</span><br><span class="line">    autoindex_format html;</span><br><span class="line">    autoindex_exact_size off;</span><br><span class="line">    autoindex_localtime on;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h4><table><thead><tr><th align="left">参数</th><th align="left">示例</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">autoindex</td><td align="left">on | off</td><td align="left">打开关闭目录浏览功能。</td></tr><tr><td align="left">autoindex_format</td><td align="left">html、xml、json、jsonp</td><td align="left">设置展示目录风格。</td></tr><tr><td align="left">autoindex_exact_size</td><td align="left">on | off</td><td align="left">是否显示文件字节数。</td></tr><tr><td align="left">autoindex_localtime</td><td align="left">on | off</td><td align="left">是否以服务器的文件时间作为显示的时间。</td></tr></tbody></table><h3 id="多虚拟机共用端口"><a href="#多虚拟机共用端口" class="headerlink" title="多虚拟机共用端口"></a>多虚拟机共用端口</h3><p>nginx 可以配置多个虚拟机共用 80 端口。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">server &#123;         </span><br><span class="line">    listen 80;</span><br><span class="line">    server_name apitest.aa.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://10.26.31.176:8081; ;</span><br><span class="line">        root html;</span><br><span class="line">        index index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;         </span><br><span class="line">    listen 80;</span><br><span class="line">    server_name api.aa.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://10.26.31.176:8080;</span><br><span class="line">        root html;</span><br><span class="line">        index index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>运用 nginx 虚拟机特性，就算一台服务器也可以本地配置多个网站。</li><li>多个网站分别在不同目录，例如：A 网站的本地路劲为 html/a，B 网站的本地路径为 html/b。</li><li>根据不同的域名区分 A 和 B 网站，而且 A 和 B 网站共用 80 端口。</li><li>示例中由于反向代理远程主机，两个站点目录都在 nginx 根目录下的 html 目录。</li></ul><h3 id="动静分离"><a href="#动静分离" class="headerlink" title="动静分离"></a>动静分离</h3><h4 id="拓扑图"><a href="#拓扑图" class="headerlink" title="拓扑图"></a>拓扑图</h4><p>此拓扑图采用动静分离的思想。</p><img src="28.png" width="50%"><h4 id="配置-3"><a href="#配置-3" class="headerlink" title="配置"></a>配置</h4><p>静态文件都会到本地 /Users/dalaoyang/Downloads/static 目录下去找，直接通过 nginx 返回这些资源。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       10000;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://localhost:8888;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        &#125;</span><br><span class="line">        location ~ .*\.(html|htm|gif|jpg|jpeg|bmp|png|ico|js|css)$ &#123;</span><br><span class="line">            root /Users/dalaoyang/Downloads/static;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>示例中 html、htm、gif、jpg、jpeg、bmp、png、ico、js、css 会由 nginx 直接返回。</li><li>其他资源请求会转发到本地 8888 端口的服务器处理。</li></ul><h3 id="轮询机制"><a href="#轮询机制" class="headerlink" title="轮询机制"></a>轮询机制</h3><h4 id="默认"><a href="#默认" class="headerlink" title="默认"></a>默认</h4><p>当 weight 不指定时，各服务器 weight 相同， 每个请求按时间顺序逐一分配到不同的后端服务器。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">upstream bakend &#123;</span><br><span class="line">    server 192.168.1.10;</span><br><span class="line">    server 192.168.1.11;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>如果后端服务器 down 掉，能自动剔除。</li></ul><h4 id="权重"><a href="#权重" class="headerlink" title="权重"></a>权重</h4><p>指定轮询几率，weight 和访问比率成正比，用于后端服务器性能不均的情况。</p><img src="18.png" width="50%"><ul><li>那么 10 次一般只会有 1 次会访问到 8081，而有 9 次会访问到 8080。</li></ul><h4 id="ip-hash"><a href="#ip-hash" class="headerlink" title="ip_hash"></a>ip_hash</h4><p>上面的 2 种方式都有一个问题，那就是下一个请求来的时候请求可能分发到另外一个服务器，当我们的程序不是无状态的时候（采用了 session 保存数据），这时候就有一个很大的很问题了，比如把登录信息保存到了 session 中，那么跳转到另外一台服务器的时候就需要重新登录了，所以很多时候我们需要一个客户只访问一个服务器，那么就需要用 iphash 了，iphash 的每个请求按访问 ip 的 hash 结果分配，这样每个访客固定访问一个后端服务器，可以解决 session 的问题。</p><img src="19.png" width="50%"><h4 id="fair"><a href="#fair" class="headerlink" title="fair"></a>fair</h4><p>按后端服务器的响应时间来分配请求，响应时间短的优先分配。</p><img src="20.png" width="50%"><ul><li>需要安装第三方模块才能生效。</li></ul><h4 id="url-hash"><a href="#url-hash" class="headerlink" title="url_hash"></a>url_hash</h4><p>按访问 url 的 hash 结果来分配请求，使每个 url 定向到同一个后端服务器，后端服务器为缓存时比较有效。</p><img src="21.png" width="50%"><ul><li>在 upstream 中加入 hash 语句，server 语句中不能写入 weight 等其他的参数，hash_method 是使用的 hash 算法。</li><li>需要安装第三方模块才能生效。</li></ul><h3 id="expires-缓存"><a href="#expires-缓存" class="headerlink" title="expires 缓存"></a>expires 缓存</h3><h4 id="介绍-3"><a href="#介绍-3" class="headerlink" title="介绍"></a>介绍</h4><p>在访问量比较大的网站中，利用客户端来缓存网站上不经常变更的图片，是给服务器减压的一个很方便且实用的做法。</p><h4 id="参数说明-1"><a href="#参数说明-1" class="headerlink" title="参数说明"></a>参数说明</h4><p>格式 | 说明<br>30s | 表示把数据缓存 30 秒。<br>30m | 表示把数据缓存 30 分。<br>10h | 表示把数据缓存 10 小时。<br>1d | 表示把数据缓存 1 天。</p><h4 id="配置-4"><a href="#配置-4" class="headerlink" title="配置"></a>配置</h4><p>静态资源缓存 3 天。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(gif|jpg|jpeg|png) &#123;</span><br><span class="line">    root /var/mywww/html/public/;</span><br><span class="line">    expires 3d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h3><h4 id="介绍-4"><a href="#介绍-4" class="headerlink" title="介绍"></a>介绍</h4><ul><li><p>gzip 是 nginx 服务器的 ngx_http_gzip_module 模块提供的在线实时数据压缩功能。</p></li><li><p>通过开启 gzip 功能，可对服务器响应的数据进行压缩处理，变成体积更小的二进制文件。</p></li><li><p>在高PV的网站应用中，可以节省海量的带宽。</p></li><li><p>客户端浏览器发出的请求头中声明了支持 gzip 类型的压缩文件，若服务器端开启了 gzip 压缩功能，那么响应数据会经过压缩后再返回客户端，由客户端负责解压缩再渲染。</p><img src="29.png" width="50%"></li><li><p>一般情况下，不建议对图片、mp3等二进制文件配置压缩，因为二进制文件的压缩率比较小，但耗费的 cpu 资源却很高。</p></li></ul><h4 id="配置-5"><a href="#配置-5" class="headerlink" title="配置"></a>配置</h4><p>gzip 压缩可以配置 http、server 和 location 模块下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name test.com www.test.com;</span><br><span class="line">        root /webroot/www;</span><br><span class="line">        location ~ .*\.(jpg|gif|png|bmp)$ &#123;</span><br><span class="line">                gzip on;</span><br><span class="line">                gzip_http_version 1.1;</span><br><span class="line">                gzip_comp_level 3;</span><br><span class="line">                gzip_types text/plain application/json application/x-javascript application/css application/xml application/xml+rss text/javascript application/x-httpd-php image/jpeg image/gif image/png image/x-ms-bmp;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="参数说明-2"><a href="#参数说明-2" class="headerlink" title="参数说明"></a>参数说明</h4><table><thead><tr><th align="left">参数</th><th align="left">示例</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">gzip</td><td align="left">on | off</td><td align="left">是否开启 gzip。</td></tr><tr><td align="left">gzip_buffers</td><td align="left">32 4K | 16 8K</td><td align="left">缓冲（压缩数据缓冲在内存中，当达到N块内存，每块MK时，输出缓存）。</td></tr><tr><td align="left">gzip_comp_level</td><td align="left">[1-9]</td><td align="left">压缩级别，级别越高，压缩比越大，越消耗 CPU 资源，推荐 6。</td></tr><tr><td align="left">gzip_disable</td><td align="left"></td><td align="left">指定不进行 gzip 压缩的 uri。</td></tr><tr><td align="left">gzip_min_length</td><td align="left">200</td><td align="left">启用 gzip 压缩的最小文件，小于设置值的文件将不会压缩。</td></tr><tr><td align="left">gzip_http_version</td><td align="left">1.0 | 1.1</td><td align="left">指定进行压缩的最小 http 协议版本。</td></tr><tr><td align="left">gzip_proxied</td><td align="left"></td><td align="left">如果请求者是代理服务器，该如何缓存。</td></tr><tr><td align="left">gzip_types</td><td align="left">text/plain application/xml</td><td align="left">指定要压缩的文件的类型（mime.types），多种类型用空格隔开。</td></tr><tr><td align="left">gzip_vary</td><td align="left">on | off</td><td align="left">是否在 http header 中添加 Vary: Accept-Encoding，建议开启。</td></tr></tbody></table><h3 id="健康检测"><a href="#健康检测" class="headerlink" title="健康检测"></a>健康检测</h3><h4 id="被动检测"><a href="#被动检测" class="headerlink" title="被动检测"></a>被动检测</h4><h5 id="介绍-5"><a href="#介绍-5" class="headerlink" title="介绍"></a>介绍</h5><ul><li>当 Nginx 认为一台应用服务器不能被访问的时候，它会暂时停止向这台应用上面分发请求。</li><li>直到 Nginx 认为该应用服务器可以再次被访问的时候才会再向这台应用服务器上面分发请求。</li></ul><h5 id="参数说明-3"><a href="#参数说明-3" class="headerlink" title="参数说明"></a>参数说明</h5><ul><li><p>max_fails</p><ol><li>设置访问失败的最大次数。</li><li>当 Nginx 向一台服务器分发请求，如果失败的次数达到该参数设置的数量，则 Nginx 认为该应用服务器不能访问。</li><li>在接下来的请求就不会再发给该应用服务器，直到达到 fail_timeout 设置的时间才会再次向这台应用分发请求。</li></ol></li><li><p>fail_timeout</p><ol><li>该参数表示停止分发请求至该应用服务器的时间。</li><li>如果 Nginx 认为一台应用服务器不能被访问了，则Nginx就会停止向这台应用服务器上分发请求。</li><li>那需要多长时间 Nginx 才会认为该服务器可以被访问从而向其分发请求呢？这就需要通过该参数来设置这个时间了。</li></ol></li><li><p>fail_timeout 和 max_fails 的默认值分别为 10s 和 1 次。</p></li></ul><h5 id="配置-6"><a href="#配置-6" class="headerlink" title="配置"></a>配置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    upstream onmpw &#123;</span><br><span class="line">        server 192.168.144.128;</span><br><span class="line">        server 192.168.144.132 max_fails=3 fail_timeout=30s;</span><br><span class="line">        server 192.168.144.131 max_fails=2;</span><br><span class="line">    &#125;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://onmpw;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="主动监测"><a href="#主动监测" class="headerlink" title="主动监测"></a>主动监测</h4><ul><li>由 Nginx 定期的向每台应用服务器发送特殊的请求，来监测应用服务器是否可以正常访问，这种方式称为主动监测。</li><li>需要指出的是，主动检测指令 health_check 目前只有 nginx 商业版本才提供。</li></ul><h3 id="return-指令"><a href="#return-指令" class="headerlink" title="return 指令"></a>return 指令</h3><p>return 指令可以写在 server、location、if 里面。</p><table><thead><tr><th align="left">语法</th><th align="left">示例</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><code>return code [text];</code></td><td align="left"><code>return 200 &quot;ok&quot;;</code></td><td align="left">会直接向响应 ok 回去。</td></tr><tr><td align="left"><code>return code URL;</code></td><td align="left"><code>return 301 http://www.baidu.com;</code></td><td align="left">301 重定向。</td></tr><tr><td align="left"><code>return URL;</code></td><td align="left"><code>return http://www.baidu.com</code></td><td align="left">使用默认返回码 302 重定向。</td></tr></tbody></table><h3 id="防盗链"><a href="#防盗链" class="headerlink" title="防盗链"></a>防盗链</h3><h4 id="盗链定义"><a href="#盗链定义" class="headerlink" title="盗链定义"></a>盗链定义</h4><ul><li>此内容不在自己服务器上，而通过技术手段，绕过别人放广告有利益的最终页，直接在自己的有广告有利益的页面上向最终用户提供此内容。</li><li>常常是一些名不见经传的小网站来盗取一些有实力的大网站的地址（比如一些音乐、图片、软件的下载地址）然后放置在自己的网站中，通过这种方法盗取大网站的空间和流量。</li><li>这些非法访问并不会给网站带来利益或好处，相反，这会浪费网站的带宽，增加服务器的连接压力。</li></ul><h4 id="防盗链原理"><a href="#防盗链原理" class="headerlink" title="防盗链原理"></a>防盗链原理</h4><ul><li>referer 是 http 请求头中的一部分，当浏览器向 Web 服务器发出请求时，一般会带上这个属性用来表明网页的来源。</li><li>防盗链的基本原理就是根据请求头中 referer 属性得到网页来源，从而实现访问控制。</li></ul><h4 id="配置-7"><a href="#配置-7" class="headerlink" title="配置"></a>配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(gif|jpg|png|swf|flv)$ &#123; </span><br><span class="line">    valid_referers none blocked www.jzxue.com jzxue.com ; </span><br><span class="line">    if ($invalid_referer) &#123; </span><br><span class="line">        rewrite ^/ http://www.jzxue.com/retrun.html; </span><br><span class="line">        #return 403; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>nginx 会通过查看 referer 字段和 valid_referers 后面的 referer 列表进行匹配，如果匹配到了就 invalid_referer 字段值为 0 否则设置该值为 1。</li><li>none 代表请求头中没有 referer 信息，这一般是直接在浏览器输入图片网址。</li><li>blocked 代表被防火墙过滤标记过的请求。</li><li>如果匹配不到通过 rewrite 指令直接重定向到 <code>http://www.jzxue.com/retrun.html</code> 或者直接返回 403。</li></ul><h3 id="并发模型"><a href="#并发模型" class="headerlink" title="并发模型"></a>并发模型</h3><h4 id="介绍-6"><a href="#介绍-6" class="headerlink" title="介绍"></a>介绍</h4><h5 id="基础说明"><a href="#基础说明" class="headerlink" title="基础说明"></a>基础说明</h5><ul><li>nginx 中包含 epoll、poll、select、devpoll、kqueue、iocp 等不同的 IO 处理函数。</li><li>你不知道 Nginx 该使用哪种轮询方法的话，它会选择一个最适合你操作系统的。</li></ul><h5 id="select"><a href="#select" class="headerlink" title="select"></a>select</h5><ul><li>它仅仅知道了，有 I/O 事件发生了，却并不知道是哪那几个流（可能有一个，多个，甚至全部），我们只能无差别轮询所有流，找出能读出数据，或者写入数据的流，对他们进行操作。</li><li>所以 select 具有 O(n) 的无差别轮询复杂度，同时处理的流越多，无差别轮询时间就越长。</li></ul><h5 id="poll"><a href="#poll" class="headerlink" title="poll"></a>poll</h5><ul><li>poll 本质上和 select 没有区别，它将用户传入的数组拷贝到内核空间，然后查询每个fd对应的设备状态。</li><li>但是它没有最大连接数的限制，原因是它是基于链表来存储的。</li></ul><h5 id="epoll"><a href="#epoll" class="headerlink" title="epoll"></a>epoll</h5><ul><li>epoll 可以理解为 event poll，不同于忙轮询和无差别轮询，epoll 会把哪个流发生了怎样的 I/O 事件通知我们。</li><li>所以我们说 epoll 实际上是事件驱动（每个事件关联上fd）的，此时我们对这些流的操作都是有意义的（复杂度降低到了O(1)）。</li></ul><h4 id="配置-8"><a href="#配置-8" class="headerlink" title="配置"></a>配置</h4><p>我们也可以使用 use 指令在配置文件中显式地定义某个并发模型。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">events &#123;</span><br><span class="line">    use epoll;</span><br><span class="line">｝</span><br></pre></td></tr></table></figure><h1 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h1><h2 id="介绍-7"><a href="#介绍-7" class="headerlink" title="介绍"></a>介绍</h2><p>由 Apache 组织提供的一种 Web 应用服务器，提供对 jsp 和 Servlet 的支持，它是一种轻量级的 javaWeb 容器（服务器）。</p><h2 id="发布项目"><a href="#发布项目" class="headerlink" title="发布项目"></a>发布项目</h2><p>将 war 包部署到 Tomcat 根目录下的 webapp 目录，重启 Tomcat 即可运行 Web 项目。</p><h1 id="Solr"><a href="#Solr" class="headerlink" title="Solr"></a>Solr</h1><h3 id="介绍-8"><a href="#介绍-8" class="headerlink" title="介绍"></a>介绍</h3><ul><li>Solr 是一个搜索应用服务器，它对外提供类似于 WebService 的 API 接口。</li><li>Solr 是 Apache 的一个开源项目，采用 JAVA 开发，基于 Lucene 工具包实现的应用服务器。</li><li>Solr 运行在 Tomcat 等其他 Servlet 容器中。</li></ul><h3 id="中文分词器"><a href="#中文分词器" class="headerlink" title="中文分词器"></a>中文分词器</h3><ul><li>英文是以单词为单位的，单词与单词之间以空格或者逗号句号隔开。</li><li>而中文则以字为单位，字又组成词，字和词再组成句子。</li><li>所以对于英文，我们可以简单以空格判断某个字符串是否为一个单词，比如 I love China，love 和 China 很容易被程序区分开来。</li><li>但中文“我爱中国”就不一样了，电脑不知道“中国”是一个词语还是“爱中”是一个词语。</li></ul></div><div><div><div style="text-align:center;color:#ccc;font-size:22px;letter-spacing:12px">本文结束<i class="fa fa-paw"></i>感谢您的阅读</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>im乐</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://zero3737.gitee.io/posts/15841/" title="服务器配置">https://zero3737.gitee.io/posts/15841/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-widgets"><div class="social_share"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/65499/" rel="next" title="业务流程"><i class="fa fa-chevron-left"></i> 业务流程</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/posts/6b8f0853/" rel="prev" title="vim编辑器入门">vim编辑器入门 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/static/user_images/头像/avatar.gif" alt="im乐"><p class="site-author-name" itemprop="name">im乐</p><div class="site-description motion-element" itemprop="description">一个专注分享互联网知识的网站，希望你会喜欢它。</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">89</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">17</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/zero3737" title="GitHub &rarr; https://github.com/zero3737" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://gitee.com/zero3737/" title="Gitee &rarr; https://gitee.com/zero3737/" rel="noopener" target="_blank"><i class="fa fa-fw fa-git"></i>Gitee</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li><a href="/posts/12fc1c4b/" title="JSP 教程" target="_blank">JSP 教程</a></li><li><a href="/posts/8dc1959/" title="JavaScript进阶之事件" target="_blank">JavaScript进阶之事件</a></li><li><a href="/posts/514ba138/" title="实例化对象（new）的过程" target="_blank">实例化对象（new）的过程</a></li><li><a href="/posts/77987eec/" title="JavaScript 中的原型链和函数原型" target="_blank">JavaScript 中的原型链和函数原型</a></li><li><a href="/posts/fed4be0c/" title="for…in 遍历对象中的属性" target="_blank">for…in 遍历对象中的属性</a></li></ul></div><script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script><script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script><div class="widget-wrap"><h3 class="widget-title" style="text-align:center;color:#fc6423">Tag Cloud</h3><div id="myCanvasContainer" class="widget tagcloud"><canvas width="250" height="250" id="resCanvas" style="width:100%"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">30</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/">HTML</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVA/">JAVA</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a><span class="tag-list-count">42</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发工具/">开发工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/教程/">教程</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务搭建/">服务搭建</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/未完待续/">未完待续</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/概念/">概念</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/科学上网/">科学上网</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网站推荐/">网站推荐</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件推荐/">软件推荐</a><span class="tag-list-count">2</span></li></ul></canvas></div></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#计算机网络"><span class="nav-number">1.</span> <span class="nav-text">计算机网络</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP-协议"><span class="nav-number">1.1.</span> <span class="nav-text">TCP 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍"><span class="nav-number">1.1.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三次握手"><span class="nav-number">1.1.2.</span> <span class="nav-text">三次握手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四次挥手"><span class="nav-number">1.1.3.</span> <span class="nav-text">四次挥手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-IP"><span class="nav-number">1.1.4.</span> <span class="nav-text">TCP/IP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#域名"><span class="nav-number">1.2.</span> <span class="nav-text">域名</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#域名组成"><span class="nav-number">1.2.1.</span> <span class="nav-text">域名组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#记录类型"><span class="nav-number">1.2.2.</span> <span class="nav-text">记录类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#主机记录"><span class="nav-number">1.2.3.</span> <span class="nav-text">主机记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CNAME"><span class="nav-number">1.2.4.</span> <span class="nav-text">CNAME</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#线路"><span class="nav-number">1.2.5.</span> <span class="nav-text">线路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#记录值"><span class="nav-number">1.2.6.</span> <span class="nav-text">记录值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MX优先级"><span class="nav-number">1.2.7.</span> <span class="nav-text">MX优先级</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TTL"><span class="nav-number">1.2.8.</span> <span class="nav-text">TTL</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#URI、URL-与-URN"><span class="nav-number">1.3.</span> <span class="nav-text">URI、URL 与 URN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#URI"><span class="nav-number">1.3.1.</span> <span class="nav-text">URI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#URL"><span class="nav-number">1.3.2.</span> <span class="nav-text">URL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#URN"><span class="nav-number">1.3.3.</span> <span class="nav-text">URN</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#服务器基本概念"><span class="nav-number">2.</span> <span class="nav-text">服务器基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基本概念"><span class="nav-number">2.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#服务器类型"><span class="nav-number">2.2.</span> <span class="nav-text">服务器类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Apache"><span class="nav-number">3.</span> <span class="nav-text">Apache</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#介绍-1"><span class="nav-number">3.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#环境配置"><span class="nav-number">3.2.</span> <span class="nav-text">环境配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#启动与关闭"><span class="nav-number">3.3.</span> <span class="nav-text">启动与关闭</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#通过命令行方式启动关闭-Apache"><span class="nav-number">3.3.1.</span> <span class="nav-text">通过命令行方式启动关闭 Apache</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#利用Apache自带软件启动关闭Apache。"><span class="nav-number">3.3.2.</span> <span class="nav-text">利用Apache自带软件启动关闭Apache。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通过-CMD-命令卸载"><span class="nav-number">3.4.</span> <span class="nav-text">通过 CMD 命令卸载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Apache-根目录下的各个文件的用途"><span class="nav-number">3.5.</span> <span class="nav-text">Apache 根目录下的各个文件的用途</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Nginx"><span class="nav-number">4.</span> <span class="nav-text">Nginx</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#介绍-2"><span class="nav-number">4.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#官网地址"><span class="nav-number">4.2.</span> <span class="nav-text">官网地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命令"><span class="nav-number">4.3.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基础模块"><span class="nav-number">4.4.</span> <span class="nav-text">基础模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文件结构"><span class="nav-number">4.4.1.</span> <span class="nav-text">文件结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基础模块说明"><span class="nav-number">4.4.2.</span> <span class="nav-text">基础模块说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置"><span class="nav-number">4.5.</span> <span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#反向代理和负载均衡"><span class="nav-number">4.5.1.</span> <span class="nav-text">反向代理和负载均衡</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#模块介绍"><span class="nav-number">4.5.1.1.</span> <span class="nav-text">模块介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#反向代理"><span class="nav-number">4.5.1.1.1.</span> <span class="nav-text">反向代理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#负载均衡"><span class="nav-number">4.5.1.1.2.</span> <span class="nav-text">负载均衡</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-1"><span class="nav-number">4.5.1.2.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#localtion"><span class="nav-number">4.5.2.</span> <span class="nav-text">localtion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#静态资源"><span class="nav-number">4.5.3.</span> <span class="nav-text">静态资源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#目录浏览"><span class="nav-number">4.5.4.</span> <span class="nav-text">目录浏览</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-2"><span class="nav-number">4.5.4.1.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参数说明"><span class="nav-number">4.5.4.2.</span> <span class="nav-text">参数说明</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多虚拟机共用端口"><span class="nav-number">4.5.5.</span> <span class="nav-text">多虚拟机共用端口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动静分离"><span class="nav-number">4.5.6.</span> <span class="nav-text">动静分离</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#拓扑图"><span class="nav-number">4.5.6.1.</span> <span class="nav-text">拓扑图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-3"><span class="nav-number">4.5.6.2.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#轮询机制"><span class="nav-number">4.5.7.</span> <span class="nav-text">轮询机制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#默认"><span class="nav-number">4.5.7.1.</span> <span class="nav-text">默认</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#权重"><span class="nav-number">4.5.7.2.</span> <span class="nav-text">权重</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ip-hash"><span class="nav-number">4.5.7.3.</span> <span class="nav-text">ip_hash</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fair"><span class="nav-number">4.5.7.4.</span> <span class="nav-text">fair</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#url-hash"><span class="nav-number">4.5.7.5.</span> <span class="nav-text">url_hash</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#expires-缓存"><span class="nav-number">4.5.8.</span> <span class="nav-text">expires 缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#介绍-3"><span class="nav-number">4.5.8.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参数说明-1"><span class="nav-number">4.5.8.2.</span> <span class="nav-text">参数说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-4"><span class="nav-number">4.5.8.3.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gzip"><span class="nav-number">4.5.9.</span> <span class="nav-text">gzip</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#介绍-4"><span class="nav-number">4.5.9.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-5"><span class="nav-number">4.5.9.2.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参数说明-2"><span class="nav-number">4.5.9.3.</span> <span class="nav-text">参数说明</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#健康检测"><span class="nav-number">4.5.10.</span> <span class="nav-text">健康检测</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#被动检测"><span class="nav-number">4.5.10.1.</span> <span class="nav-text">被动检测</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#介绍-5"><span class="nav-number">4.5.10.1.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#参数说明-3"><span class="nav-number">4.5.10.1.2.</span> <span class="nav-text">参数说明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#配置-6"><span class="nav-number">4.5.10.1.3.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#主动监测"><span class="nav-number">4.5.10.2.</span> <span class="nav-text">主动监测</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#return-指令"><span class="nav-number">4.5.11.</span> <span class="nav-text">return 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#防盗链"><span class="nav-number">4.5.12.</span> <span class="nav-text">防盗链</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#盗链定义"><span class="nav-number">4.5.12.1.</span> <span class="nav-text">盗链定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#防盗链原理"><span class="nav-number">4.5.12.2.</span> <span class="nav-text">防盗链原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-7"><span class="nav-number">4.5.12.3.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#并发模型"><span class="nav-number">4.5.13.</span> <span class="nav-text">并发模型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#介绍-6"><span class="nav-number">4.5.13.1.</span> <span class="nav-text">介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#基础说明"><span class="nav-number">4.5.13.1.1.</span> <span class="nav-text">基础说明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#select"><span class="nav-number">4.5.13.1.2.</span> <span class="nav-text">select</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#poll"><span class="nav-number">4.5.13.1.3.</span> <span class="nav-text">poll</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#epoll"><span class="nav-number">4.5.13.1.4.</span> <span class="nav-text">epoll</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置-8"><span class="nav-number">4.5.13.2.</span> <span class="nav-text">配置</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tomcat"><span class="nav-number">5.</span> <span class="nav-text">Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#介绍-7"><span class="nav-number">5.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#发布项目"><span class="nav-number">5.2.</span> <span class="nav-text">发布项目</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Solr"><span class="nav-number">6.</span> <span class="nav-text">Solr</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍-8"><span class="nav-number">6.0.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#中文分词器"><span class="nav-number">6.0.2.</span> <span class="nav-text">中文分词器</span></a></li></ol></li></ol></div></div></div><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><div id="landlord"><div class="message" style="opacity:0"></div><canvas id="live2d" width="300" height="380" class="live2d"></canvas></div><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2022</span> <span class="with-love" id="animate"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">im乐</span> <span class="post-meta-divider footer-ages-icon">|</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">292k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">4:25</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span>访问人数</span> <span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span>总访问量</span> <span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div><div><script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278758248'%3E%3C/span%3E%3Cscript src='https://s9.cnzz.com/z_stat.php%3Fid%3D1278758248%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"))</script></div></div></footer></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/npm/fastclick@1/lib/fastclick.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery-lazyload@1/jquery.lazyload.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/reading_progress/reading_progress.js"></script><script src="/js/utils.js?v=7.1.2"></script><script src="/js/motion.js?v=7.1.2"></script><script src="/js/affix.js?v=7.1.2"></script><script src="/js/schemes/pisces.js?v=7.1.2"></script><script src="/js/scrollspy.js?v=7.1.2"></script><script src="/js/post-details.js?v=7.1.2"></script><script src="/js/next-boot.js?v=7.1.2"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var GUEST=["nick","mail","link"],guest="nick,mail";guest=guest.split(",").filter(function(e){return GUEST.indexOf(e)>-1}),new Valine({el:"#comments",verify:!1,notify:!1,appId:"G2263okNhhWmY54fzXVhqqXV-MdYXbMMI",appKey:"c3Mz0H4v2spiQybEgul3ScwD",placeholder:"请输入你的内容",avatar:"mm",meta:guest,pageSize:"10",visitor:!0,lang:"zh-cn"})</script><script>function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var e=$("#local-search-input");e.attr("autocapitalize","none"),e.attr("autocorrect","off"),e.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(e){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(e,t,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:e,dataType:isXml?"xml":"json",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():e,r=document.getElementById(t),s=document.getElementById(o),a=function(){var e=r.value.trim().toLowerCase(),t=e.split(/[\s\-]+/);t.length>1&&t.push(e);var o=[];if(e.length>0&&n.forEach(function(n){function r(t,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===e&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(e,t){var o="",n=t.start;return t.hits.forEach(function(t){o+=e.substring(n,t.position);var r=t.position+t.length;o+='<b class="search-keyword">'+e.substring(t.position,r)+"</b>",n=r}),o+=e.substring(n,t.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url).replace(/\/{2,}/g,"/"),d=[],g=[];if(""!=l&&(t.forEach(function(e){function t(e,t,o){var n=e.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(t=t.toLowerCase(),e=e.toLowerCase());(s=t.indexOf(e,r))>-1;)a.push({position:s,word:e}),r=s+n;return a}d=d.concat(t(e,h,!1)),g=g.concat(t(e,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(e){e.sort(function(e,t){return t.position!==e.position?t.position-e.position:e.word.length-t.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hits.length!==t.hits.length?t.hits.length-e.hits.length:e.start-t.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(e){b+="<a href='"+f+'\'><p class="search-result">'+s(p,e)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===t.length&&""===t[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x"></i></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>';else{o.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id});var a='<ul class="search-result-list">';o.forEach(function(e){a+=e.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(e){e.stopPropagation()}),$(document).on("keyup",function(e){var t=27===e.which&&$(".search-popup").is(":visible");t&&onPopupClose()})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script><script>pbOptions={},pbOptions.iconStyle="default",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Wechat,QQZone,Weibo,Douban,Mailto",new needShareButton("#needsharebutton-postbottom",pbOptions)</script><script>$(".highlight").not(".gist .highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=e,document.body.appendChild(n);const a=document.getSelection(),i=a.rangeCount>0?a.getRangeAt(0):!1;n.select(),n.setSelectionRange(0,e.length),n.readOnly=!1;var l=document.execCommand("copy");l?$(this).text("复制成功"):$(this).text("复制失败"),n.blur(),$(this).blur(),i&&(a.removeAllRanges(),a.addRange(i))})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})</script><canvas class="fireworks" width="2500" height="856" style="width:1250px;height:428px"></canvas><script src="https://cdn.jsdelivr.net/npm/animejs@2.2.0/anime.min.js"></script><script src="/static/js/cursor/fireworks2.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.min.js"></script><script>function timer() {
      var ages = moment.preciseDiff(moment(),moment(20190601,"YYYYMMDD"));
      //去除时分秒信息
      ages = ages.replace(/\s?\d{0,2}\s+hours?/, "");
      ages = ages.replace(/\s?\d{0,2}\s+minutes?/, "");
      ages = ages.replace(/\s?\d{0,2}\s+seconds?/, "");
      //将年月日转换为中文
      ages = ages.replace(/years?/, "年");
      ages = ages.replace(/months?/, "月");
      ages = ages.replace(/days?/, "天");
      ages = ages.replace(/\d+/g, '<span style="color:#1094e8">$&</span>');
      span.innerHTML = `网站已经运行 ${ages}`;
    }
    var span = document.createElement("span");
    //插入到agesicon之后
    var agesicon = document.querySelector(".footer-ages-icon");
    console.log(agesicon);
    document.querySelector(".copyright").insertBefore(span, agesicon.nextSibling);
    timer();</script><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement(o),n=t.getElementsByTagName(o)[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/bf66604c.js","daovoice"),daovoice("init",{app_id:"bf66604c"}),daovoice("update")</script><script type="text/javascript">var message_Path="/live2d/",home_Path="https://zero3737.gitee.io/"</script><script type="text/javascript" defer src="/live2d/js/message.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/z16.model.json"},display:{position:"right",width:300,height:400},mobile:{show:!1},react:{opacity:.7},log:!1})</script></body></html><!-- rebuild by neat -->